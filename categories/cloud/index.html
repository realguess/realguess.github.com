<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Cloud | realguess</title>
  <meta name="author" content="Chao Huang">
  
  <meta name="description" content="Just a blog about every detail encountered.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="realguess"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="realguess" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45698182-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">realguess</a></h1>
  <h2><a href="/">Don&#39;t afraid to try!</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title category">Cloud</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-09-24T12:00:00.000Z"><a href="/2015/09/24/add-a-custom-domain-to-the-specific-module-of-google-app-engine-managed-vms/">Sep 24, 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/09/24/add-a-custom-domain-to-the-specific-module-of-google-app-engine-managed-vms/">Add a Custom Domain to the Specific Module of Google App Engine Managed VMs</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I would like to add a custom domain to a module other than the default one in <a href="https://cloud.google.com/appengine/docs/managed-vms/" target="_blank" rel="external">Google App Engine Managed VMs</a>. For example, I have the following sub-domains:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Custom domain names | SSL support | Record type | Data                 | Alias</div><div class="line">------------------- | ----------- | ----------- | -------------------- | -----</div><div class="line">api.example.com     | none        | CNAME       | ghs.googlehosted.com | api</div><div class="line">admin.example.com   | none        | CNAME       | ghs.googlehosted.com | admin</div></pre></td></tr></table></figure>

<p>listed in the application console:</p>
<p><a href="https://console.developers.google.com/project/[project]/appengine/settings/domains" target="_blank" rel="external">https://console.developers.google.com/project/[project]/appengine/settings/domains</a></p>
<p>The domain <code>api.example.com</code> points to the default module. And I would like the other domain <code>admin.example.com</code> to point to the module <code>admin</code>. However, by merely adding the custom domain in the settings, both <code>api.example.com</code> and <code>admin.example.com</code> are pointed to the same module: the default module. Then how to point the custom domain and route the traffic to the <code>admin</code> module? The answer is on the <em>dispatch file</em>. But first need to understand the concept of modules in Google App Engine.</p>
<p><img src="/2015/09/24/add-a-custom-domain-to-the-specific-module-of-google-app-engine-managed-vms/modules-hierarchy.png" alt="Google App Engine Module Hierarchy" title="Source: Google App Engine Module Hierarchy"><br><em>Source: <a href="https://cloud.google.com/appengine/docs/go/modules/" target="_blank" rel="external">Google App Engine Docs</a></em></p>
<p>The above chart illustrates the architecture of a Google App Engine application:</p>
<ul>
<li>Application: “An App Engine application is made up of one or more modules”. [<a href="https://cloud.google.com/appengine/docs/go/modules/" target="_blank" rel="external">1</a>]</li>
<li>Module: “Each module consists of source code and configuration files. The files used by a module represents a version of the module. When you deploy a module, you always deploy a specific version of the module.” [<a href="https://cloud.google.com/appengine/docs/go/modules/" target="_blank" rel="external">1</a>] “All module-less apps have been converted to contain a single default module.” [<a href="https://cloud.google.com/appengine/docs/go/modules/" target="_blank" rel="external">1</a>] Every application has a single default module.</li>
<li>Version: “A particular module/version will have one or more instances.”</li>
<li>Instance: “Each instance runs its own separate executable.”</li>
</ul>
<p>Another concept is the resource sharing:</p>
<ul>
<li>“App Engine Modules let developers factor large applications into logical components that can share stateful services and communicate in a secure fashion.” [<a href="https://cloud.google.com/appengine/docs/go/modules/" target="_blank" rel="external">1</a>]</li>
<li>“Stateful services (such as Memcache, Datastore, and Task Queues) are shared by all modules in an application.” [<a href="https://cloud.google.com/appengine/docs/go/modules/" target="_blank" rel="external">1</a>]</li>
</ul>
<p>Remember that <a href="https://cloud.google.com/" target="_blank" rel="external">Google Cloud Platform</a> is project based. If there are a web application and a mobile application, and they are both making requests to another application, the API. Then there should be three projects. However, in this case, both <code>api</code> and <code>admin</code> share the same services, such as the same database and file storage. We should put them together in the same application as separate modules.</p>
<p>With that in mind, how to route requests to a specific module? “Every module, version, and instance has its own unique URI (for example, <code>v1.my-module.my-app.appspot.com</code>). Incoming user requests are routed to an instance of a particular module/version according to <a href="https://cloud.google.com/appengine/docs/go/modules/routing" target="_blank" rel="external">URL addressing conventions and an optional customized dispatch file</a>.” [<a href="https://cloud.google.com/appengine/docs/go/modules/" target="_blank" rel="external">1</a>] Since a custom domain is used, we have to use the customized dispatch file. And this is done by creating a dispatch file <code>dispatch.yml</code> to route requests based on URL patterns.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># Dispatch</div><div class="line"><span class="header"># ========</span></div><div class="line">---</div><div class="line">dispatch:</div><div class="line"><span class="code">  - url: '*/favicon.ico'</span></div><div class="line"><span class="code">    module: default</span></div><div class="line"><span class="code">  - url: 'admin.example.com/*'</span></div><div class="line"><span class="code">    module: admin</span></div></pre></td></tr></table></figure>

<p>The <code>application</code> field is not necessary, otherwise, you will get:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">WARNING: The [application] field is specified <span class="keyword">in</span> file [/home/chao/example/dispatch.yml].</div><div class="line">This field is not used by gcloud and should be removed.</div></pre></td></tr></table></figure>

<p>Glob characters (such as asterisk) can be used, and support up to 10 routing rules.</p>
<p>Deploy the dispatch file is simple:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ gcloud preview app deploy dispatch.yml</div></pre></td></tr></table></figure>

<p>And it should require almost no time to wait. Once it is ready, the requests sent to <code>admin.example.com</code> will be routed properly to the <code>admin</code> module.</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/09/24/add-a-custom-domain-to-the-specific-module-of-google-app-engine-managed-vms/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-09-15T12:00:00.000Z"><a href="/2015/09/15/scaffold-an-explicit-document-to-avoid-error-when-creating-indexes-in-google-cloud-datastore/">Sep 15, 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/09/15/scaffold-an-explicit-document-to-avoid-error-when-creating-indexes-in-google-cloud-datastore/">Scaffold an Explicit Document to Avoid Error When Creating Indexes in Google Cloud Datastore</a></h1>
  

    </header>
    <div class="entry">
      
        <p>When working with <a href="https://cloud.google.com/datastore/" target="_blank" rel="external">Google Cloud Datastore</a>, I would like to design each <a href="https://cloud.google.com/datastore/docs/concepts/entities#Datastore_Kinds_and_identifiers" target="_blank" rel="external">kind</a> (collection or table) with its own schema and index files:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ tree</div><div class="line">.</div><div class="line">├── index.yml</div><div class="line">└── schema.yml</div></pre></td></tr></table></figure>

<p>But not every kind has to have something in the <code>index.yml</code> file. So, what to do? Will the index creation command accept an empty <code>index.yml</code> file with zero byte? Let’s give try:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ gcloud preview datastore create-indexes index.yml</div><div class="line"></div><div class="line">ERROR: (gcloud.preview.datastore.create-indexes) An error occurred <span class="keyword">while</span> parsing file: [/home/chao/kind/index.yml]</div><div class="line">The file is empty</div></pre></td></tr></table></figure>

<p>No, it does not like it. Then, what’s the minimum required? The answer is an <a href="http://www.yaml.org/spec/1.2/spec.html#id2801301" target="_blank" rel="external">explicit document</a> with an empty document content:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span></div></pre></td></tr></table></figure>

<p>The three dashes form a <a href="http://www.yaml.org/spec/1.2/spec.html#marker/directives%20end/" target="_blank" rel="external">directives end marker</a> line. <a href="http://www.yaml.org/" target="_blank" rel="external">YAML</a> uses three dashes to separate directives from document content.</p>
<p>When creating indexes with the file, it will proceed without errors or warnings:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ gcloud preview datastore create-indexes index.yml</div><div class="line"></div><div class="line">You are about to update the following configurations:</div><div class="line">- myproj/index  From: [/home/chao/kind/index.yml]</div><div class="line">Do you want to <span class="keyword">continue</span> (Y/n)?</div></pre></td></tr></table></figure>

<p>Therefore, to avoid error, when scaffold an <code>index.yml</code> file for indexing, use an explicit document with an empty document content.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-09-14T12:00:00.000Z"><a href="/2015/09/14/google-cloud-datastore-starter-dataset/">Sep 14, 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/09/14/google-cloud-datastore-starter-dataset/">Google Cloud Datastore Starter: Dataset</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://cloud.google.com/datastore/" target="_blank" rel="external">Google Cloud Datastore</a> dataset starter, part of a starter collection:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Google Cloud Datastore Starter: Dataset</span></div><div class="line"><span class="comment">// =======================================</span></div><div class="line"><span class="pi"></span></div><div class="line">'use strict';</div><div class="line"></div><div class="line"><span class="comment">// Define a dataset.</span></div><div class="line"><span class="keyword">var</span> params = {</div><div class="line">  projectId: <span class="string">'MY_PROJECT'</span>,</div><div class="line">  keyFilename: <span class="string">'/path/to/key/file.json'</span>,</div><div class="line">  namespace: <span class="string">'MY_NAMESPACE'</span></div><div class="line">};</div><div class="line"><span class="keyword">var</span> dataset = <span class="built_in">require</span>(<span class="string">'gcloud'</span>).datastore.dataset(params);</div><div class="line"></div><div class="line"><span class="comment">// Define an entity (including both key and data).</span></div><div class="line"><span class="keyword">var</span> kind = <span class="string">'MY_KIND'</span>;</div><div class="line"><span class="keyword">var</span> key = dataset.key(kind);</div><div class="line"><span class="keyword">var</span> data = [</div><div class="line">  {</div><div class="line">    name: <span class="string">'title'</span>,</div><div class="line">    value: <span class="string">'Google Cloud Datastore Starter'</span>,</div><div class="line">    excludeFromIndexes: <span class="literal">false</span></div><div class="line">  }</div><div class="line">];</div><div class="line"><span class="comment">// var data = { title: 'Google Cloud Datastore Starter' }; // Simple version</span></div><div class="line"><span class="keyword">var</span> entity = {</div><div class="line">  key: key,</div><div class="line">  data: data</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// Save a single entity.</span></div><div class="line">dataset.save(entity, <span class="function"><span class="keyword">function</span> <span class="params">(err)</span> </span>{</div><div class="line">  <span class="keyword">if</span> (err) {</div><div class="line">    <span class="keyword">throw</span> err;</div><div class="line">  }</div><div class="line">});</div></pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-09-14T12:00:00.000Z"><a href="/2015/09/14/understand-the-limitation-of-the-string-property-type-of-google-cloud-datastore/">Sep 14, 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/09/14/understand-the-limitation-of-the-string-property-type-of-google-cloud-datastore/">Understand the Limitation of the String Property Type of Google Cloud Datastore</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://cloud.google.com/datastore/" target="_blank" rel="external">Google Cloud Datastore</a> supports a variety of data types for property values:</p>
<ul>
<li>Integers</li>
<li>Floating-point numbers</li>
<li>Strings</li>
<li>Dates</li>
<li>Binary data</li>
</ul>
<p>Strings are likely the most frequently used. When working with strings, the most important question to ask is how many bytes can be inserted into the property/field. According to the table listed in <a href="https://cloud.google.com/datastore/docs/concepts/entities#Datastore_Properties_and_value_types" target="_blank" rel="external">properties and value types</a>:</p>
<blockquote>
<p>Up to 1500 bytes if property is indexed, up to 1MB otherwise</p>
</blockquote>
<p>Let’s give a try:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">// String Property Type</div><div class="line">// ====================</div><div class="line">//</div><div class="line">// Investigate the string property <span class="built_in">type</span> of Google Cloud Datastore.</div><div class="line">//</div><div class="line">// Dependencies tested:</div><div class="line">//</div><div class="line">// - `gcloud@v0.<span class="number">21.0</span>`</div><div class="line">// - `lorem-ipsum@<span class="number">1.0</span>.<span class="number">3</span>`</div><div class="line"></div><div class="line"><span class="string">'use strict'</span>;</div><div class="line"></div><div class="line">// Define dependencies.</div><div class="line">var params = {</div><div class="line">  projectId: <span class="string">'myproj'</span>,</div><div class="line">  keyFilename: <span class="string">'/path/to/key/file.json'</span>,</div><div class="line">  namespace: <span class="string">'test'</span></div><div class="line">};</div><div class="line">var dataset = require(<span class="string">'gcloud'</span>).datastore.dataset(params);</div><div class="line">var kind = <span class="string">'String'</span>;</div><div class="line">var lorem = require(<span class="string">'lorem-ipsum'</span>);</div><div class="line"></div><div class="line">// Save an entity to the datastore.</div><div class="line">function run(params) {</div><div class="line">  var size = params.size;</div><div class="line">  var index = params.index;</div><div class="line">  var str = lorem({ count: size }).substr(<span class="number">0</span>, size);</div><div class="line">  var key = dataset.key(kind);</div><div class="line">  var data = [</div><div class="line">    {</div><div class="line">      name: <span class="string">'title'</span>,</div><div class="line">      value: str,</div><div class="line">      excludeFromIndexes: !index</div><div class="line">    }</div><div class="line">  ];</div><div class="line">  var entity = {</div><div class="line">    key: key,</div><div class="line">    data: data</div><div class="line">  };</div><div class="line"></div><div class="line">  dataset.save(entity, function (err) {</div><div class="line">    console.log(size, new Buffer(str).length, index,</div><div class="line">      err ? err.code + <span class="string">' '</span> + err.message : <span class="string">'200 OK'</span>);</div><div class="line">  });</div><div class="line">}</div><div class="line"></div><div class="line">// Explanation of fields:</div><div class="line">//</div><div class="line">// - `size`: Total number of bytes to produce</div><div class="line">// - `index`: Whether to index the string field</div><div class="line">//</div><div class="line">// In-line comment indicates the expected result.</div><div class="line">[</div><div class="line">  { size: <span class="number">1500</span>, index: <span class="literal">true</span>  },             // OK</div><div class="line">  { size: <span class="number">1501</span>, index: <span class="literal">false</span> },             // OK</div><div class="line">  { size: <span class="number">1501</span>, index: <span class="literal">true</span>  },             // Error</div><div class="line">  { size: <span class="number">1024</span> * <span class="number">1024</span> - <span class="number">92</span>, index: <span class="literal">false</span> }, // OK</div><div class="line">  { size: <span class="number">1024</span> * <span class="number">1024</span> - <span class="number">91</span>, index: <span class="literal">false</span> }, // Error</div><div class="line">].forEach(run);</div></pre></td></tr></table></figure>

<p>Don’t ask me where <code>91</code> or <code>92</code> is coming from. Apparently, this is somewhere closer to 1 MB, but not exactly. The result of the test script:</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/09/14/understand-the-limitation-of-the-string-property-type-of-google-cloud-datastore/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-06-29T12:00:00.000Z"><a href="/2015/06/29/google-cloud-pub-sub-starters-for-gcloud-version-v0-15-x/">Jun 29, 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/06/29/google-cloud-pub-sub-starters-for-gcloud-version-v0-15-x/">Google Cloud Pub/Sub Starters for gcloud Version v0.15.x</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://cloud.google.com/pubsub/docs" target="_blank" rel="external">Google Cloud Pub/Sub</a> starters/examples/references for <a href="https://nodejs.org/api/" target="_blank" rel="external">Node.js</a> gcloud version v0.15.x.</p>
<p>Usage:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ PROJECT=my-project KEYFILENAME=/path/to/keyfile.json node file.sh</div></pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/06/29/google-cloud-pub-sub-starters-for-gcloud-version-v0-15-x/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-01-07T12:00:00.000Z"><a href="/2015/01/07/use-cli-s3api-to-retrieve-metadata-of-amazon-s3-object/">Jan 7, 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/01/07/use-cli-s3api-to-retrieve-metadata-of-amazon-s3-object/">Use CLI s3api to Retrieve Metadata of Amazon S3 Object</a></h1>
  

    </header>
    <div class="entry">
      
        <p>In <a href="http://docs.aws.amazon.com/cli/latest/reference/s3/index.html#available-commands" target="_blank" rel="external">Amazon S3 CLI</a>, there are only a handful commands:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cp      ls      mb      mv      rb      rm      sync    website</div></pre></td></tr></table></figure>

<p>We can use <code>cp</code> command to retrieve S3 object:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ aws s3 cp s3://mybucket/myfile.json myfile.json</div></pre></td></tr></table></figure>

<p>But if only the metadata of the object, such as <code>ETag</code> or <code>Content-Type</code> is needed, the S3 CLI does not have any command to do that.</p>
<p>Now enter <a href="http://docs.aws.amazon.com/cli/latest/reference/s3api/index.html" target="_blank" rel="external">S3API CLI</a>. Not only the CLI commands can retrieve S3 objects, but also associated <a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMetadata.html#object-metadata" target="_blank" rel="external">metadata</a>. For example, retrieve S3 object similar to <code>aws s3 cp</code>:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ aws s3api get-object --bucket mybucket --key myfile.json</div></pre></td></tr></table></figure>

<p>Just need the metadata of the object, use <code>head-object</code>, which retrieves metadata without the object itself, as HTTP HEAD method:</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/01/07/use-cli-s3api-to-retrieve-metadata-of-amazon-s3-object/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-12-27T12:00:00.000Z"><a href="/2014/12/27/revoke-and-grant-public-ip-addresses-to-amazon-ec2-instances-via-aws-command-line-interface-cli/">Dec 27, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/12/27/revoke-and-grant-public-ip-addresses-to-amazon-ec2-instances-via-aws-command-line-interface-cli/">Revoke and Grant Public IP Addresses to Amazon EC2 Instances Via AWS Command Line Interface (CLI)</a></h1>
  

    </header>
    <div class="entry">
      
        <p>If you work from place to place, such as from one coffee shop to another, and you need access to your Amazon EC2 instances, but you don’t want to allow traffics from all IP addresses. You can use the EC2 <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html" target="_blank" rel="external">Security Groups</a> to allow the IP addresses from those locations. But once you move on to a different location, you want to delete the IP address from the previous location. The process to do these manually and over and over again quickly becomes cumbersome. Here is a command line method that quickly removes all other locations and allows only the traffic from your current location.</p>
<p>The steps are:</p>
<ol>
<li>Revoke all existing sources to a particular port</li>
<li>Grant access to the port only from the current IP address</li>
</ol>
<p>Assume the following:</p>
<ul>
<li>Profile: <code>default</code></li>
<li>Security group: <code>mygroup</code></li>
<li>Protocol: <code>tcp</code></li>
<li>Port: <code>22</code></li>
</ul>
<p>First, revoke access to the port from all IP addresses:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$ aws ec2 describe-security-groups \</div><div class="line">    --profile default \</div><div class="line">    --group-names mygroup \</div><div class="line">    --query <span class="string">'SecurityGroups[0].IpPermissions[?ToPort==`22`].IpRanges[].CidrIp'</span> | \</div><div class="line">  jq .[] | \</div><div class="line">  xargs -n <span class="number">1</span> aws ec2 revoke-security-group-ingress \</div><div class="line">    --profile default \</div><div class="line">    --group-name mygroup \</div><div class="line">    --protocol tcp \</div><div class="line">    --port <span class="number">22</span> \</div><div class="line">    --cidr</div></pre></td></tr></table></figure>

<p>The <code>aws ec2 describe-security-groups</code> command before the first pipe returns JSON formatted data, filtered via <a href="http://jmespath.org/" target="_blank" rel="external">JMESPath</a> query, which is supported by <a href="http://aws.amazon.com/cli/" target="_blank" rel="external">AWS CLI</a>, for example:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  <span class="string">"XXX.XXX.XXX.XXX/32"</span>,</div><div class="line">  <span class="string">"XXX.XXX.XXX.XXX/32"</span></div><div class="line">]</div></pre></td></tr></table></figure>

<p><a href="http://stedolan.github.io/jq/" target="_blank" rel="external">jq</a> command simply converts an array of JSON to line by line strings, which <code>xarg</code> takes in, loops through and deletes one IP address at a time.</p>
<p>After this step, all IP addresses originally allowed are all revoked. Next step is to grant access to the port from a single IP address:</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014/12/27/revoke-and-grant-public-ip-addresses-to-amazon-ec2-instances-via-aws-command-line-interface-cli/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-11-28T12:00:00.000Z"><a href="/2014/11/28/delete-all-messages-in-an-amazon-sqs-queue-via-aws-cli/">Nov 28, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/11/28/delete-all-messages-in-an-amazon-sqs-queue-via-aws-cli/">Delete All Messages in an Amazon SQS Queue via AWS CLI</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="http://aws.amazon.com/sqs/" target="_blank" rel="external">Amazon SQS</a> or Simple Queue Service is a fast, reliable, scalable, fully managed message queuing service. There is also <a href="http://aws.amazon.com/cli/" target="_blank" rel="external">AWS CLI</a> or Command Line Interface available to use with the service.</p>
<p>If you have a lot of messages in a queue, this command will show the approximate number:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ aws sqs get-queue-attributes \</div><div class="line">  --queue-url <span class="variable">$url</span> \</div><div class="line">  --attribute-names ApproximateNumberOfMessages</div></pre></td></tr></table></figure>

<p>Where <code>$url</code> is the URL to the Amazon SQS queue.</p>
<p>There is no command to delete all messages yet, but you can chain a few commands together to make it work:</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014/11/28/delete-all-messages-in-an-amazon-sqs-queue-via-aws-cli/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-10-25T15:37:25.000Z"><a href="/2014/10/25/use-cname-for-resovling-private-and-public-ip-address-in-amazon-ec2/">Oct 25, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/10/25/use-cname-for-resovling-private-and-public-ip-address-in-amazon-ec2/">Use CNAME for Resovling Private and Public IP Address in Amazon EC2</a></h1>
  

    </header>
    <div class="entry">
      
        <p>“A security group acts as a virtual firewall that controlls the traffic for one or more instances.” <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html" target="_blank" rel="external">1</a> The <a href="https://aws.amazon.com/ec2/" target="_blank" rel="external">Amazon EC2</a> <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html" target="_blank" rel="external">Security Groups</a> are not just capable controlling traffic from an IP address, but also from all EC2 instances belong to a specific security group. I want to allow an instance belonging to one security group to access an instance belongs to another security group via a custom domain name (subdomain.example.com).</p>
<p>But when I configured the subdomain via <a href="https://aws.amazon.com/route53/" target="_blank" rel="external">Amazon Route 53</a>, I have misconfigured it by assigning a A record, an IP address or the <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html" target="_blank" rel="external">Elastic IP address</a> of the instance. I should have used CNAME, and assigned the public DNS (the public hostname of the EC2 instance).</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014/10/25/use-cname-for-resovling-private-and-public-ip-address-in-amazon-ec2/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-24T22:17:41.000Z"><a href="/2014/05/24/amazon-s3-delimiter-and-prefix/">May 24, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/24/amazon-s3-delimiter-and-prefix/">Amazon S3 Delimiter and Prefix</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="http://aws.amazon.com/s3/" target="_blank" rel="external">Amazon S3</a> is an inexpensive online file storage service, and there is the <a href="http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/S3.html" target="_blank" rel="external">JavaScript SDK</a> to use. There are things puzzling me when using the SDK were:</p>
<ol>
<li>How to use parameters <code>Delimiter</code> and <code>Prefix</code>?</li>
<li>What is the difference between <code>CommonPrefixes</code> and <code>Contents</code>?</li>
<li>How to create a folder/directory with JavaScript SDK?</li>
</ol>
<p>To retrieve objects in an Amazon S3 bucket, the operation is <code>listObjects</code>. The <code>listObjects</code> does not return the content of the object, but the key and meta data such as size and owner of the object.</p>
<p>To make a call to get a list of objects in a bucket:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">s3.listObjects(params, <span class="function"><span class="keyword">function</span> <span class="params">(err, data)</span> </span>{</div><div class="line">  <span class="comment">// ...</span></div><div class="line">});</div></pre></td></tr></table></figure>

<p>Where the <code>params</code> can be configured with the following parameters:</p>
<ul>
<li>Bucket</li>
<li>Delimiter</li>
<li>EncodingType</li>
<li>Marker</li>
<li>MaxKeys</li>
<li>Prefix</li>
</ul>
<p>But what are <code>Delimiter</code> and <code>Prefix</code>? And how to use them?</p>
<p>Let’s start by creating some objects in an Amazon S3 bucket similar to the following file structure. This can be easily done by using the AWS Console.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">├── <span class="built_in">directory</span></div><div class="line">│   ├── <span class="built_in">directory</span></div><div class="line">│   │   └── <span class="built_in">file</span></div><div class="line">│   └── <span class="built_in">file</span></div><div class="line">└── <span class="built_in">file</span></div><div class="line"></div><div class="line"><span class="number">2</span> <span class="built_in">directories</span>, <span class="number">3</span> <span class="built_in">files</span></div></pre></td></tr></table></figure>

<p>In Amazon S3, the objects are:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>One thing to keep in mind is that Amazon S3 is not a file system. There is not really the concept of file and directory/folder. From the console, it might look like there are 2 directories and 3 files. But they are all objects. And objects are listed alphabetically by their keys. </p>
<p>To make it a little bit more clear, let’s invoke the <code>listObjects</code> method. Since the operation has only <code>Bucket</code> parameter is required:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">params = {</div><div class="line">  Bucket: <span class="string">'example'</span></div><div class="line">};</div></pre></td></tr></table></figure>

<p>The response <code>data</code> contains in the callback function:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/file'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> },</div><div class="line">     { Key: <span class="string">'file'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> } ],</div><div class="line">  CommonPrefixes: [],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  Marker: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  IsTruncated: false }</div></pre></td></tr></table></figure>

<p>If this is a file structure, you might expect:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>But it is not, because a bucket does not work like a folder or a directory, where the immediate files inside the directory is shown.  The objects inside the bucket are laid out flat and alphabetically.</p>
<p>In UNIX, a directory is a file, but in Amazon S3, everything is an object, and can be identified by key.</p>
<p>So, how to make Amazon S3 behave more like a folder or a directory? Or how to just list the content of first level right inside the bucket?</p>
<p>In order to make it work like directory you have to use <code>Delimiter</code> and <code>Prefix</code>. <code>Delimiter</code> is what you use to group keys. It does have to be a <em>single character</em>, it can be a string of characters. And <code>Prefix</code> limits the response to keys that begin with the specified prefix.</p>
<h2 id="Delimiter">Delimiter</h2>
<p>Let’s start by adding the following delimiter:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">params = {</div><div class="line">  Bucket: <span class="string">'example'</span>,</div><div class="line">  Delimiter: <span class="string">'/'</span></div><div class="line">};</div></pre></td></tr></table></figure>

<p>You will get something more like a listing of a directory:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'file'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory/'</span> } ],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  Delimiter: <span class="string">'/'</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>There are a directory <code>directory/</code> and a file <code>file</code>. What happened was that the following objects except <code>file</code> are grouped by the delimiter <code>/</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>So, result in:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>This feels more like a listing of a directory or folder. But if we change <code>Delimiter</code> to <code>i</code>, then, you get no <code>Contents</code> and just the prefixes:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">{ Contents: [],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'di'</span> }, { Prefix: <span class="string">'fi'</span> } ],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  Delimiter: <span class="string">'i'</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>All keys can be grouped into two prefixes: <code>di</code> and <code>fi</code>. Therefore, Amazon S3 is not a file system, but might act like one if using the right parameters.</p>
<p>As I have mentioned that <code>Delimiter</code> does not need to be a single character:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span> },</div><div class="line">     { Key: <span class="string">'file'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory/directory'</span> } ],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  Delimiter: <span class="string">'/directory'</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>If recall the bucket structure:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>Both <code>directory/directory/</code> and <code>directory/directory/file</code> are grouped into a common prefix: <code>directory/directory</code>, due to the common grouping string <code>/directory</code>.</p>
<p>Let’s try another one with <code>Delimiter: &#39;directory&#39;</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'file'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory'</span> } ],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  Delimiter: <span class="string">'directory'</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>Okay, one more. Let’s try <code>ry/fi</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/'</span> },</div><div class="line">     { Key: <span class="string">'file'</span> } ],</div><div class="line">  CommonPrefixes: </div><div class="line">   [ { Prefix: <span class="string">'directory/directory/fi'</span> },</div><div class="line">     { Prefix: <span class="string">'directory/fi'</span> } ],</div><div class="line">  Name: <span class="string">'example,</span></div><div class="line">  Prefix: '<span class="string">',</span></div><div class="line">  MaxKeys: 1000,</div><div class="line">  Delimiter: 'ry/<span class="keyword">fi</span><span class="string">',</span></div><div class="line">  IsTruncated: false }</div></pre></td></tr></table></figure>

<p>So, remember that <code>Delimiter</code> is just providing a grouping functionality for keys. If you want it to behave like a file system, use <code>Delimiter: &#39;/&#39;</code>.</p>
<h2 id="Prefix">Prefix</h2>
<p><code>Prefix</code> is much easier to understand, it is a filter that limits keys to be prefixed by the one specified.</p>
<p>With the same structure:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>Let’s set the <code>Prefix</code> parameter to <code>directory</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/file'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span> } ],</div><div class="line">  CommonPrefixes: [],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">'directory'</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>How about <code>directory/</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/file'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span> } ],</div><div class="line">  CommonPrefixes: [],</div><div class="line">  Prefix: <span class="string">'directory/'</span> }</div></pre></td></tr></table></figure>

<p>Both <code>directory</code> and <code>directory/</code> prefixes are the same.</p>
<p>If we try something slightly different, <code>Prefix: &#39;directory/d&#39;</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/file'</span> } ],</div><div class="line">  CommonPrefixes: [],</div><div class="line">  Prefix: <span class="string">'directory/d'</span> }</div></pre></td></tr></table></figure>

<p>Putting all together with both <code>Delimiter: &#39;directory&#39;</code> and <code>Prefix: &#39;directory&#39;</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory/directory'</span> } ],</div><div class="line">  Prefix: <span class="string">'directory'</span>,</div><div class="line">  Delimiter: <span class="string">'directory'</span> }</div></pre></td></tr></table></figure>

<p>First, list the keys prefixed by <code>directory</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>Group them by the delimiter <code>directory</code> <strong>with prefix <code>directory</code></strong>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span></div></pre></td></tr></table></figure>

<p>The result <code>Contents</code> are:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>and <code>CommonPrefixes</code> are:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span></div></pre></td></tr></table></figure>

<p>Maybe changing <code>Delimiter</code> to <code>i</code> could give a better perspective:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory/di'</span> }, { Prefix: <span class="string">'directory/fi'</span> } ],</div><div class="line">  Prefix: <span class="string">'directory'</span>,</div><div class="line">  Delimiter: <span class="string">'i'</span> }</div></pre></td></tr></table></figure>

<p>as:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/               <span class="comment"># key to show</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/     <span class="comment"># group to 'directory/di'</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span> <span class="comment"># group to 'directory/di'</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span>           <span class="comment"># Group to 'directory/fi'</span></div><div class="line"><span class="built_in">file</span>                     <span class="comment"># ignored due to prefix</span></div></pre></td></tr></table></figure>

<p>One advantage of using Amazon S3 over listing a directory is that you don’t need to concern about nested directories, everything is being flattened. So, you can loop it through just by specifying the <code>Prefix</code> property.</p>
<h2 id="Directory/Folder">Directory/Folder</h2>
<p>If you’re using the Amazon AWS console to “Create Folder”, you can create a directory/folder and upload a file to inside the directory/folder. In effect, you are actually creating two objects with the following keys:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>If you use the following command to upload a file, the directory is not created:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ aws s3 cp <span class="built_in">file</span> s3://example/<span class="built_in">directory</span>/<span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>Because, Amazon S3 is not a file system, but a key/value store. If you use <code>listObjects</code> method, you will just see one object. That is the same reason that you cannot copy a local directory:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ aws s3 cp directory s3://example/directory</div><div class="line">upload failed: aws/ to s3://example/directory [Errno <span class="number">21</span>] Is a directory: <span class="string">u'/home/chao/tmp/directory/'</span></div></pre></td></tr></table></figure>

<p>But we can use the JavaScript SDK to create a directory/folder:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">s3.putObject({ Bucket: <span class="string">'example'</span>, Key: <span class="string">'directory/'</span> }, <span class="function"><span class="keyword">function</span> <span class="params">(err, data)</span> </span>{</div><div class="line">  <span class="keyword">if</span> (err) { <span class="keyword">return</span> <span class="built_in">console</span>.error(err); }</div><div class="line"></div><div class="line">  <span class="built_in">console</span>.log(data);</div><div class="line">});</div></pre></td></tr></table></figure>

<p>Note that you must use <code>directory/</code> with trailing slash instead the one without. Otherwise, it is just a regular file not a directory.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
  
    <a href="/categories/cloud/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:realguess.net">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/cloud/">Cloud</a><small>11</small></li>
  
    <li><a href="/categories/coding/">Coding</a><small>5</small></li>
  
    <li><a href="/categories/communication/">Communication</a><small>1</small></li>
  
    <li><a href="/categories/devops/">DevOps</a><small>9</small></li>
  
    <li><a href="/categories/javascript/">JavaScript</a><small>17</small></li>
  
    <li><a href="/categories/linux/">Linux</a><small>4</small></li>
  
    <li><a href="/categories/node-js-and-io-js/">Node.js and io.js</a><small>0</small></li>
  
    <li><a href="/categories/pathfinder/">Pathfinder</a><small>1</small></li>
  
    <li><a href="/categories/productivity/">Productivity</a><small>1</small></li>
  
    <li><a href="/categories/programming/">Programming</a><small>0</small></li>
  
    <li><a href="/categories/security/">Security</a><small>1</small></li>
  
    <li><a href="/categories/starters/">Starters</a><small>0</small></li>
  
    <li><a href="/categories/statistics/">Statistics</a><small>5</small></li>
  
    <li><a href="/categories/test/">Test</a><small>2</small></li>
  
    <li><a href="/categories/tools/">Tools</a><small>19</small></li>
  
    <li><a href="/categories/travel/">Travel</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/2013/">2013</a><small>1</small></li>
  
    <li><a href="/tags/2014/">2014</a><small>3</small></li>
  
    <li><a href="/tags/2015/">2015</a><small>1</small></li>
  
    <li><a href="/tags/abraham-lincoln/">abraham-lincoln</a><small>1</small></li>
  
    <li><a href="/tags/absolute-path/">absolute-path</a><small>1</small></li>
  
    <li><a href="/tags/accessor-property/">accessor-property</a><small>1</small></li>
  
    <li><a href="/tags/aftereach/">aftereach</a><small>1</small></li>
  
    <li><a href="/tags/agenda/">agenda</a><small>1</small></li>
  
    <li><a href="/tags/alexa/">alexa</a><small>3</small></li>
  
    <li><a href="/tags/alias/">alias</a><small>1</small></li>
  
    <li><a href="/tags/amazon/">amazon</a><small>6</small></li>
  
    <li><a href="/tags/amazon-s3/">amazon-s3</a><small>2</small></li>
  
    <li><a href="/tags/amazon-s3api/">amazon-s3api</a><small>1</small></li>
  
    <li><a href="/tags/amazon-sqs/">amazon-sqs</a><small>1</small></li>
  
    <li><a href="/tags/amtrak/">amtrak</a><small>1</small></li>
  
    <li><a href="/tags/android/">android</a><small>1</small></li>
  
    <li><a href="/tags/android-4-3/">android-4.3</a><small>1</small></li>
  
    <li><a href="/tags/anonymous/">anonymous</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-function/">anonymous-function</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-like/">anonymous-like</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-login/">anonymous-login</a><small>1</small></li>
  
    <li><a href="/tags/ansible/">ansible</a><small>1</small></li>
  
    <li><a href="/tags/app-engine/">app-engine</a><small>2</small></li>
  
    <li><a href="/tags/apple/">apple</a><small>1</small></li>
  
    <li><a href="/tags/apt-get/">apt-get</a><small>2</small></li>
  
    <li><a href="/tags/array/">array</a><small>3</small></li>
  
    <li><a href="/tags/async/">async</a><small>1</small></li>
  
    <li><a href="/tags/asynchronous/">asynchronous</a><small>2</small></li>
  
    <li><a href="/tags/automated-build/">automated-build</a><small>1</small></li>
  
    <li><a href="/tags/automatic-link/">automatic-link</a><small>1</small></li>
  
    <li><a href="/tags/automation/">automation</a><small>2</small></li>
  
    <li><a href="/tags/awk/">awk</a><small>1</small></li>
  
    <li><a href="/tags/aws/">aws</a><small>8</small></li>
  
    <li><a href="/tags/aws-cli/">aws-cli</a><small>4</small></li>
  
    <li><a href="/tags/aws-sdk/">aws-sdk</a><small>1</small></li>
  
    <li><a href="/tags/bash/">bash</a><small>3</small></li>
  
    <li><a href="/tags/beforeeach/">beforeeach</a><small>1</small></li>
  
    <li><a href="/tags/best-practice/">best-practice</a><small>2</small></li>
  
    <li><a href="/tags/big-apple/">big-apple</a><small>1</small></li>
  
    <li><a href="/tags/big-easy/">big-easy</a><small>1</small></li>
  
    <li><a href="/tags/big-number/">big-number</a><small>1</small></li>
  
    <li><a href="/tags/bind/">bind</a><small>1</small></li>
  
    <li><a href="/tags/bind9/">bind9</a><small>1</small></li>
  
    <li><a href="/tags/binding/">binding</a><small>1</small></li>
  
    <li><a href="/tags/bintray/">bintray</a><small>1</small></li>
  
    <li><a href="/tags/bitbucket/">bitbucket</a><small>2</small></li>
  
    <li><a href="/tags/blog/">blog</a><small>4</small></li>
  
    <li><a href="/tags/boss/">boss</a><small>1</small></li>
  
    <li><a href="/tags/brace-expansion/">brace-expansion</a><small>1</small></li>
  
    <li><a href="/tags/bret-victor/">bret-victor</a><small>1</small></li>
  
    <li><a href="/tags/browser/">browser</a><small>1</small></li>
  
    <li><a href="/tags/browser-sync/">browser-sync</a><small>1</small></li>
  
    <li><a href="/tags/buffer/">buffer</a><small>1</small></li>
  
    <li><a href="/tags/busybox/">busybox</a><small>1</small></li>
  
    <li><a href="/tags/byobu/">byobu</a><small>1</small></li>
  
    <li><a href="/tags/caret/">caret</a><small>1</small></li>
  
    <li><a href="/tags/caret-range/">caret-range</a><small>1</small></li>
  
    <li><a href="/tags/cat/">cat</a><small>1</small></li>
  
    <li><a href="/tags/chai/">chai</a><small>1</small></li>
  
    <li><a href="/tags/changelog/">changelog</a><small>1</small></li>
  
    <li><a href="/tags/chat/">chat</a><small>1</small></li>
  
    <li><a href="/tags/chrome/">chrome</a><small>1</small></li>
  
    <li><a href="/tags/chunghwa-telecom/">chunghwa-telecom</a><small>1</small></li>
  
    <li><a href="/tags/cli/">cli</a><small>10</small></li>
  
    <li><a href="/tags/cloud-storage/">cloud-storage</a><small>1</small></li>
  
    <li><a href="/tags/cloud9/">cloud9</a><small>1</small></li>
  
    <li><a href="/tags/cm/">cm</a><small>1</small></li>
  
    <li><a href="/tags/cname/">cname</a><small>1</small></li>
  
    <li><a href="/tags/cocoon/">cocoon</a><small>1</small></li>
  
    <li><a href="/tags/coding-style/">coding-style</a><small>4</small></li>
  
    <li><a href="/tags/coffeelint/">coffeelint</a><small>1</small></li>
  
    <li><a href="/tags/coffeescript/">coffeescript</a><small>7</small></li>
  
    <li><a href="/tags/color/">color</a><small>1</small></li>
  
    <li><a href="/tags/comcast/">comcast</a><small>1</small></li>
  
    <li><a href="/tags/command-history/">command-history</a><small>1</small></li>
  
    <li><a href="/tags/command-line/">command-line</a><small>10</small></li>
  
    <li><a href="/tags/command-line-interface/">command-line-interface</a><small>0</small></li>
  
    <li><a href="/tags/compare/">compare</a><small>1</small></li>
  
    <li><a href="/tags/compose/">compose</a><small>1</small></li>
  
    <li><a href="/tags/configuration/">configuration</a><small>1</small></li>
  
    <li><a href="/tags/configuration-management/">configuration-management</a><small>1</small></li>
  
    <li><a href="/tags/console/">console</a><small>1</small></li>
  
    <li><a href="/tags/container/">container</a><small>1</small></li>
  
    <li><a href="/tags/content-type/">content-type</a><small>1</small></li>
  
    <li><a href="/tags/context/">context</a><small>2</small></li>
  
    <li><a href="/tags/control-character/">control-character</a><small>1</small></li>
  
    <li><a href="/tags/coreutils/">coreutils</a><small>1</small></li>
  
    <li><a href="/tags/cors/">cors</a><small>1</small></li>
  
    <li><a href="/tags/create-indexes/">create-indexes</a><small>1</small></li>
  
    <li><a href="/tags/crescent/">crescent</a><small>1</small></li>
  
    <li><a href="/tags/crlf/">crlf</a><small>1</small></li>
  
    <li><a href="/tags/cron/">cron</a><small>2</small></li>
  
    <li><a href="/tags/crontab/">crontab</a><small>1</small></li>
  
    <li><a href="/tags/crypto/">crypto</a><small>2</small></li>
  
    <li><a href="/tags/cryptography/">cryptography</a><small>1</small></li>
  
    <li><a href="/tags/curl/">curl</a><small>1</small></li>
  
    <li><a href="/tags/custom-domain/">custom-domain</a><small>2</small></li>
  
    <li><a href="/tags/custom-generator/">custom-generator</a><small>1</small></li>
  
    <li><a href="/tags/cut/">cut</a><small>1</small></li>
  
    <li><a href="/tags/cwd/">cwd</a><small>1</small></li>
  
    <li><a href="/tags/data-volume/">data-volume</a><small>1</small></li>
  
    <li><a href="/tags/database/">database</a><small>1</small></li>
  
    <li><a href="/tags/datagram/">datagram</a><small>1</small></li>
  
    <li><a href="/tags/dataset/">dataset</a><small>1</small></li>
  
    <li><a href="/tags/datastore/">datastore</a><small>1</small></li>
  
    <li><a href="/tags/date/">date</a><small>1</small></li>
  
    <li><a href="/tags/db/">db</a><small>1</small></li>
  
    <li><a href="/tags/debian/">debian</a><small>2</small></li>
  
    <li><a href="/tags/debian-jessie/">debian-jessie</a><small>1</small></li>
  
    <li><a href="/tags/december/">december</a><small>1</small></li>
  
    <li><a href="/tags/delimiter/">delimiter</a><small>1</small></li>
  
    <li><a href="/tags/dependency/">dependency</a><small>3</small></li>
  
    <li><a href="/tags/development/">development</a><small>1</small></li>
  
    <li><a href="/tags/development-environment/">development-environment</a><small>1</small></li>
  
    <li><a href="/tags/diff/">diff</a><small>2</small></li>
  
    <li><a href="/tags/digest/">digest</a><small>1</small></li>
  
    <li><a href="/tags/directives-end-marker/">directives-end-marker</a><small>1</small></li>
  
    <li><a href="/tags/directory/">directory</a><small>1</small></li>
  
    <li><a href="/tags/dirname/">dirname</a><small>1</small></li>
  
    <li><a href="/tags/dispatch/">dispatch</a><small>1</small></li>
  
    <li><a href="/tags/distributed/">distributed</a><small>1</small></li>
  
    <li><a href="/tags/distributed-team/">distributed-team</a><small>1</small></li>
  
    <li><a href="/tags/dns/">dns</a><small>3</small></li>
  
    <li><a href="/tags/dns114/">dns114</a><small>1</small></li>
  
    <li><a href="/tags/docco/">docco</a><small>1</small></li>
  
    <li><a href="/tags/docker/">docker</a><small>8</small></li>
  
    <li><a href="/tags/dockerfile/">dockerfile</a><small>1</small></li>
  
    <li><a href="/tags/domain/">domain</a><small>1</small></li>
  
    <li><a href="/tags/dsn-server/">dsn-server</a><small>1</small></li>
  
    <li><a href="/tags/duplicate-keys/">duplicate-keys</a><small>1</small></li>
  
    <li><a href="/tags/duplication/">duplication</a><small>1</small></li>
  
    <li><a href="/tags/ec2/">ec2</a><small>3</small></li>
  
    <li><a href="/tags/echo/">echo</a><small>2</small></li>
  
    <li><a href="/tags/ecmascript-harmony/">ecmascript-harmony</a><small>1</small></li>
  
    <li><a href="/tags/encryption/">encryption</a><small>1</small></li>
  
    <li><a href="/tags/environment/">environment</a><small>3</small></li>
  
    <li><a href="/tags/environment-variable/">environment-variable</a><small>2</small></li>
  
    <li><a href="/tags/eol/">eol</a><small>1</small></li>
  
    <li><a href="/tags/ephemeral/">ephemeral</a><small>1</small></li>
  
    <li><a href="/tags/explicit-document/">explicit-document</a><small>1</small></li>
  
    <li><a href="/tags/express/">express</a><small>3</small></li>
  
    <li><a href="/tags/extended-pattern-matching/">extended-pattern-matching</a><small>1</small></li>
  
    <li><a href="/tags/extglob/">extglob</a><small>1</small></li>
  
    <li><a href="/tags/facebook/">facebook</a><small>1</small></li>
  
    <li><a href="/tags/field/">field</a><small>1</small></li>
  
    <li><a href="/tags/file-system/">file-system</a><small>1</small></li>
  
    <li><a href="/tags/filename/">filename</a><small>1</small></li>
  
    <li><a href="/tags/firewall/">firewall</a><small>1</small></li>
  
    <li><a href="/tags/folder/">folder</a><small>1</small></li>
  
    <li><a href="/tags/fs/">fs</a><small>1</small></li>
  
    <li><a href="/tags/function/">function</a><small>4</small></li>
  
    <li><a href="/tags/function-declaration/">function-declaration</a><small>2</small></li>
  
    <li><a href="/tags/function-expression/">function-expression</a><small>3</small></li>
  
    <li><a href="/tags/function-innovation/">function-innovation</a><small>1</small></li>
  
    <li><a href="/tags/gae/">gae</a><small>1</small></li>
  
    <li><a href="/tags/gce/">gce</a><small>2</small></li>
  
    <li><a href="/tags/gcloud/">gcloud</a><small>4</small></li>
  
    <li><a href="/tags/generator/">generator</a><small>1</small></li>
  
    <li><a href="/tags/get/">get</a><small>1</small></li>
  
    <li><a href="/tags/getter/">getter</a><small>2</small></li>
  
    <li><a href="/tags/ghost/">ghost</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>3</small></li>
  
    <li><a href="/tags/git-branch/">git-branch</a><small>1</small></li>
  
    <li><a href="/tags/github/">github</a><small>4</small></li>
  
    <li><a href="/tags/github-pages/">github-pages</a><small>1</small></li>
  
    <li><a href="/tags/glob/">glob</a><small>1</small></li>
  
    <li><a href="/tags/gnome/">gnome</a><small>1</small></li>
  
    <li><a href="/tags/gnu/">gnu</a><small>1</small></li>
  
    <li><a href="/tags/goal/">goal</a><small>1</small></li>
  
    <li><a href="/tags/google-analytics/">google-analytics</a><small>4</small></li>
  
    <li><a href="/tags/google-cloud-datastore/">google-cloud-datastore</a><small>3</small></li>
  
    <li><a href="/tags/google-cloud-platform/">google-cloud-platform</a><small>2</small></li>
  
    <li><a href="/tags/google-cloud-pubsub/">google-cloud-pubsub</a><small>1</small></li>
  
    <li><a href="/tags/google-compute-engine/">google-compute-engine</a><small>3</small></li>
  
    <li><a href="/tags/google-keep/">google-keep</a><small>1</small></li>
  
    <li><a href="/tags/google-trends/">google-trends</a><small>1</small></li>
  
    <li><a href="/tags/groupthink/">groupthink</a><small>1</small></li>
  
    <li><a href="/tags/grunt/">grunt</a><small>1</small></li>
  
    <li><a href="/tags/grunt-contrib-jshint/">grunt-contrib-jshint</a><small>1</small></li>
  
    <li><a href="/tags/grunt-contrib-watch/">grunt-contrib-watch</a><small>1</small></li>
  
    <li><a href="/tags/guard/">guard</a><small>1</small></li>
  
    <li><a href="/tags/gulp/">gulp</a><small>2</small></li>
  
    <li><a href="/tags/hackathon/">hackathon</a><small>1</small></li>
  
    <li><a href="/tags/head/">head</a><small>2</small></li>
  
    <li><a href="/tags/heartbleed/">heartbleed</a><small>1</small></li>
  
    <li><a href="/tags/hexo/">hexo</a><small>1</small></li>
  
    <li><a href="/tags/hipchat/">hipchat</a><small>1</small></li>
  
    <li><a href="/tags/hong-kong/">hong-kong</a><small>1</small></li>
  
    <li><a href="/tags/host/">host</a><small>1</small></li>
  
    <li><a href="/tags/hosted-zone/">hosted-zone</a><small>1</small></li>
  
    <li><a href="/tags/hosts/">hosts</a><small>1</small></li>
  
    <li><a href="/tags/hotlinking/">hotlinking</a><small>1</small></li>
  
    <li><a href="/tags/http/">http</a><small>4</small></li>
  
    <li><a href="/tags/http-server/">http-server</a><small>1</small></li>
  
    <li><a href="/tags/id/">id</a><small>1</small></li>
  
    <li><a href="/tags/ide/">ide</a><small>1</small></li>
  
    <li><a href="/tags/identifier/">identifier</a><small>1</small></li>
  
    <li><a href="/tags/iife/">iife</a><small>2</small></li>
  
    <li><a href="/tags/imessage/">imessage</a><small>1</small></li>
  
    <li><a href="/tags/immediately-invoked-function-expression/">immediately-invoked-function-expression</a><small>2</small></li>
  
    <li><a href="/tags/index/">index</a><small>1</small></li>
  
    <li><a href="/tags/inheritance/">inheritance</a><small>1</small></li>
  
    <li><a href="/tags/install/">install</a><small>8</small></li>
  
    <li><a href="/tags/instance/">instance</a><small>1</small></li>
  
    <li><a href="/tags/interactive/">interactive</a><small>2</small></li>
  
    <li><a href="/tags/internet-speed/">internet-speed</a><small>1</small></li>
  
    <li><a href="/tags/interpreter/">interpreter</a><small>1</small></li>
  
    <li><a href="/tags/iojs/">iojs</a><small>3</small></li>
  
    <li><a href="/tags/ip-address/">ip-address</a><small>3</small></li>
  
    <li><a href="/tags/january/">january</a><small>1</small></li>
  
    <li><a href="/tags/jasmine/">jasmine</a><small>1</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>12</small></li>
  
    <li><a href="/tags/jelly-bean/">jelly-bean</a><small>1</small></li>
  
    <li><a href="/tags/join/">join</a><small>1</small></li>
  
    <li><a href="/tags/jq/">jq</a><small>4</small></li>
  
    <li><a href="/tags/js-yaml/">js-yaml</a><small>1</small></li>
  
    <li><a href="/tags/jshint/">jshint</a><small>1</small></li>
  
    <li><a href="/tags/json/">json</a><small>4</small></li>
  
    <li><a href="/tags/koa/">koa</a><small>7</small></li>
  
    <li><a href="/tags/koa-compose/">koa-compose</a><small>1</small></li>
  
    <li><a href="/tags/koa-router/">koa-router</a><small>2</small></li>
  
    <li><a href="/tags/lean/">lean</a><small>1</small></li>
  
    <li><a href="/tags/lean-coffee/">lean-coffee</a><small>1</small></li>
  
    <li><a href="/tags/lean-startup/">lean-startup</a><small>1</small></li>
  
    <li><a href="/tags/left-to-right-mark/">left-to-right-mark</a><small>1</small></li>
  
    <li><a href="/tags/lf/">lf</a><small>1</small></li>
  
    <li><a href="/tags/libssl/">libssl</a><small>1</small></li>
  
    <li><a href="/tags/license/">license</a><small>1</small></li>
  
    <li><a href="/tags/like-button/">like-button</a><small>1</small></li>
  
    <li><a href="/tags/line-divider/">line-divider</a><small>1</small></li>
  
    <li><a href="/tags/line-ending/">line-ending</a><small>1</small></li>
  
    <li><a href="/tags/linux/">linux</a><small>3</small></li>
  
    <li><a href="/tags/listobjects/">listobjects</a><small>1</small></li>
  
    <li><a href="/tags/livereload/">livereload</a><small>2</small></li>
  
    <li><a href="/tags/load/">load</a><small>1</small></li>
  
    <li><a href="/tags/lock/">lock</a><small>1</small></li>
  
    <li><a href="/tags/lodash/">lodash</a><small>1</small></li>
  
    <li><a href="/tags/log/">log</a><small>1</small></li>
  
    <li><a href="/tags/lorem-ipsum/">lorem-ipsum</a><small>1</small></li>
  
    <li><a href="/tags/m101/">m101</a><small>1</small></li>
  
    <li><a href="/tags/managed-vms/">managed-vms</a><small>2</small></li>
  
    <li><a href="/tags/markdown/">markdown</a><small>2</small></li>
  
    <li><a href="/tags/md5/">md5</a><small>1</small></li>
  
    <li><a href="/tags/meeting/">meeting</a><small>1</small></li>
  
    <li><a href="/tags/messaging/">messaging</a><small>1</small></li>
  
    <li><a href="/tags/metric/">metric</a><small>4</small></li>
  
    <li><a href="/tags/mi3/">mi3</a><small>1</small></li>
  
    <li><a href="/tags/middleware/">middleware</a><small>2</small></li>
  
    <li><a href="/tags/minimatch/">minimatch</a><small>1</small></li>
  
    <li><a href="/tags/mocha/">mocha</a><small>3</small></li>
  
    <li><a href="/tags/module/">module</a><small>2</small></li>
  
    <li><a href="/tags/module-caching/">module-caching</a><small>1</small></li>
  
    <li><a href="/tags/mongodb/">mongodb</a><small>1</small></li>
  
    <li><a href="/tags/mongoexport/">mongoexport</a><small>1</small></li>
  
    <li><a href="/tags/msiexec/">msiexec</a><small>1</small></li>
  
    <li><a href="/tags/multi-parts/">multi-parts</a><small>1</small></li>
  
    <li><a href="/tags/multiple/">multiple</a><small>2</small></li>
  
    <li><a href="/tags/named-function/">named-function</a><small>1</small></li>
  
    <li><a href="/tags/nb/">nb</a><small>1</small></li>
  
    <li><a href="/tags/network/">network</a><small>1</small></li>
  
    <li><a href="/tags/new-orleans/">new-orleans</a><small>1</small></li>
  
    <li><a href="/tags/new-york/">new-york</a><small>1</small></li>
  
    <li><a href="/tags/nginx/">nginx</a><small>2</small></li>
  
    <li><a href="/tags/node/">node</a><small>25</small></li>
  
    <li><a href="/tags/node-version-manager/">node-version-manager</a><small>1</small></li>
  
    <li><a href="/tags/nodemon/">nodemon</a><small>1</small></li>
  
    <li><a href="/tags/normalization/">normalization</a><small>1</small></li>
  
    <li><a href="/tags/nota-bene/">nota-bene</a><small>1</small></li>
  
    <li><a href="/tags/note-well/">note-well</a><small>1</small></li>
  
    <li><a href="/tags/november/">november</a><small>1</small></li>
  
    <li><a href="/tags/npm/">npm</a><small>4</small></li>
  
    <li><a href="/tags/npm-module/">npm-module</a><small>1</small></li>
  
    <li><a href="/tags/null/">null</a><small>1</small></li>
  
    <li><a href="/tags/nvm/">nvm</a><small>1</small></li>
  
    <li><a href="/tags/object/">object</a><small>3</small></li>
  
    <li><a href="/tags/object-attributes/">object-attributes</a><small>1</small></li>
  
    <li><a href="/tags/one-liner/">one-liner</a><small>1</small></li>
  
    <li><a href="/tags/openssl/">openssl</a><small>2</small></li>
  
    <li><a href="/tags/order/">order</a><small>1</small></li>
  
    <li><a href="/tags/outdated/">outdated</a><small>1</small></li>
  
    <li><a href="/tags/package/">package</a><small>1</small></li>
  
    <li><a href="/tags/package-json/">package.json</a><small>2</small></li>
  
    <li><a href="/tags/pageview/">pageview</a><small>4</small></li>
  
    <li><a href="/tags/parseint/">parseint</a><small>1</small></li>
  
    <li><a href="/tags/part/">part</a><small>1</small></li>
  
    <li><a href="/tags/path/">path</a><small>4</small></li>
  
    <li><a href="/tags/pattern-matching/">pattern-matching</a><small>1</small></li>
  
    <li><a href="/tags/ping/">ping</a><small>1</small></li>
  
    <li><a href="/tags/pipe/">pipe</a><small>1</small></li>
  
    <li><a href="/tags/pm2/">pm2</a><small>1</small></li>
  
    <li><a href="/tags/port/">port</a><small>3</small></li>
  
    <li><a href="/tags/port-forwarding/">port-forwarding</a><small>1</small></li>
  
    <li><a href="/tags/prefix/">prefix</a><small>1</small></li>
  
    <li><a href="/tags/preinstall/">preinstall</a><small>1</small></li>
  
    <li><a href="/tags/principle/">principle</a><small>1</small></li>
  
    <li><a href="/tags/process/">process</a><small>1</small></li>
  
    <li><a href="/tags/profile/">profile</a><small>1</small></li>
  
    <li><a href="/tags/programming-style/">programming-style</a><small>0</small></li>
  
    <li><a href="/tags/protocol/">protocol</a><small>1</small></li>
  
    <li><a href="/tags/provision/">provision</a><small>1</small></li>
  
    <li><a href="/tags/proxy/">proxy</a><small>1</small></li>
  
    <li><a href="/tags/python/">python</a><small>1</small></li>
  
    <li><a href="/tags/query-parameter/">query-parameter</a><small>1</small></li>
  
    <li><a href="/tags/queue/">queue</a><small>1</small></li>
  
    <li><a href="/tags/random/">random</a><small>2</small></li>
  
    <li><a href="/tags/rawgit/">rawgit</a><small>1</small></li>
  
    <li><a href="/tags/read/">read</a><small>1</small></li>
  
    <li><a href="/tags/reboot/">reboot</a><small>2</small></li>
  
    <li><a href="/tags/record-set/">record-set</a><small>1</small></li>
  
    <li><a href="/tags/redis/">redis</a><small>1</small></li>
  
    <li><a href="/tags/relative-path/">relative-path</a><small>1</small></li>
  
    <li><a href="/tags/release/">release</a><small>1</small></li>
  
    <li><a href="/tags/remote-working/">remote-working</a><small>1</small></li>
  
    <li><a href="/tags/repl/">repl</a><small>1</small></li>
  
    <li><a href="/tags/require/">require</a><small>2</small></li>
  
    <li><a href="/tags/responsibility/">responsibility</a><small>1</small></li>
  
    <li><a href="/tags/restart/">restart</a><small>1</small></li>
  
    <li><a href="/tags/rlwrap/">rlwrap</a><small>1</small></li>
  
    <li><a href="/tags/route-53/">route-53</a><small>2</small></li>
  
    <li><a href="/tags/routing/">routing</a><small>2</small></li>
  
    <li><a href="/tags/ruby/">ruby</a><small>1</small></li>
  
    <li><a href="/tags/san-francisco/">san-francisco</a><small>1</small></li>
  
    <li><a href="/tags/save/">save</a><small>1</small></li>
  
    <li><a href="/tags/scaffolding/">scaffolding</a><small>1</small></li>
  
    <li><a href="/tags/script/">script</a><small>1</small></li>
  
    <li><a href="/tags/search/">search</a><small>1</small></li>
  
    <li><a href="/tags/search-term/">search-term</a><small>1</small></li>
  
    <li><a href="/tags/section/">section</a><small>1</small></li>
  
    <li><a href="/tags/security/">security</a><small>1</small></li>
  
    <li><a href="/tags/security-group/">security-group</a><small>2</small></li>
  
    <li><a href="/tags/sed/">sed</a><small>1</small></li>
  
    <li><a href="/tags/semantics/">semantics</a><small>1</small></li>
  
    <li><a href="/tags/semver/">semver</a><small>2</small></li>
  
    <li><a href="/tags/seq/">seq</a><small>1</small></li>
  
    <li><a href="/tags/serialization/">serialization</a><small>1</small></li>
  
    <li><a href="/tags/server/">server</a><small>2</small></li>
  
    <li><a href="/tags/setter/">setter</a><small>2</small></li>
  
    <li><a href="/tags/settings/">settings</a><small>1</small></li>
  
    <li><a href="/tags/setup/">setup</a><small>2</small></li>
  
    <li><a href="/tags/sha256/">sha256</a><small>1</small></li>
  
    <li><a href="/tags/shabang/">shabang</a><small>1</small></li>
  
    <li><a href="/tags/sharing/">sharing</a><small>1</small></li>
  
    <li><a href="/tags/shebang/">shebang</a><small>1</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>3</small></li>
  
    <li><a href="/tags/shell-expansion/">shell-expansion</a><small>1</small></li>
  
    <li><a href="/tags/shell-script/">shell-script</a><small>1</small></li>
  
    <li><a href="/tags/shellshock/">shellshock</a><small>1</small></li>
  
    <li><a href="/tags/shopt/">shopt</a><small>1</small></li>
  
    <li><a href="/tags/socket-io/">socket-io</a><small>1</small></li>
  
    <li><a href="/tags/source-maps/">source-maps</a><small>1</small></li>
  
    <li><a href="/tags/speed-test/">speed-test</a><small>1</small></li>
  
    <li><a href="/tags/split/">split</a><small>2</small></li>
  
    <li><a href="/tags/ssh/">ssh</a><small>4</small></li>
  
    <li><a href="/tags/ssh-copy-id/">ssh-copy-id</a><small>1</small></li>
  
    <li><a href="/tags/sshuttle/">sshuttle</a><small>1</small></li>
  
    <li><a href="/tags/starter/">starter</a><small>5</small></li>
  
    <li><a href="/tags/startup/">startup</a><small>2</small></li>
  
    <li><a href="/tags/state/">state</a><small>1</small></li>
  
    <li><a href="/tags/stats/">stats</a><small>5</small></li>
  
    <li><a href="/tags/stdin/">stdin</a><small>1</small></li>
  
    <li><a href="/tags/stream/">stream</a><small>1</small></li>
  
    <li><a href="/tags/string/">string</a><small>1</small></li>
  
    <li><a href="/tags/stringify/">stringify</a><small>1</small></li>
  
    <li><a href="/tags/structure/">structure</a><small>1</small></li>
  
    <li><a href="/tags/subscription/">subscription</a><small>1</small></li>
  
    <li><a href="/tags/success/">success</a><small>1</small></li>
  
    <li><a href="/tags/sudo/">sudo</a><small>1</small></li>
  
    <li><a href="/tags/supertest/">supertest</a><small>1</small></li>
  
    <li><a href="/tags/symbolic-link/">symbolic-link</a><small>1</small></li>
  
    <li><a href="/tags/symlink/">symlink</a><small>1</small></li>
  
    <li><a href="/tags/sync/">sync</a><small>1</small></li>
  
    <li><a href="/tags/synchronous/">synchronous</a><small>2</small></li>
  
    <li><a href="/tags/systemd/">systemd</a><small>1</small></li>
  
    <li><a href="/tags/taipei/">taipei</a><small>1</small></li>
  
    <li><a href="/tags/taiwan/">taiwan</a><small>1</small></li>
  
    <li><a href="/tags/task/">task</a><small>1</small></li>
  
    <li><a href="/tags/tcdisrupt/">tcdisrupt</a><small>1</small></li>
  
    <li><a href="/tags/teardown/">teardown</a><small>1</small></li>
  
    <li><a href="/tags/techcrunch/">techcrunch</a><small>1</small></li>
  
    <li><a href="/tags/template/">template</a><small>2</small></li>
  
    <li><a href="/tags/terminal/">terminal</a><small>1</small></li>
  
    <li><a href="/tags/test/">test</a><small>1</small></li>
  
    <li><a href="/tags/testing/">testing</a><small>1</small></li>
  
    <li><a href="/tags/texting/">texting</a><small>1</small></li>
  
    <li><a href="/tags/this/">this</a><small>1</small></li>
  
    <li><a href="/tags/time-zone/">time-zone</a><small>1</small></li>
  
    <li><a href="/tags/tmux/">tmux</a><small>1</small></li>
  
    <li><a href="/tags/todo/">todo</a><small>1</small></li>
  
    <li><a href="/tags/topic/">topic</a><small>2</small></li>
  
    <li><a href="/tags/train/">train</a><small>1</small></li>
  
    <li><a href="/tags/travel/">travel</a><small>1</small></li>
  
    <li><a href="/tags/trello/">trello</a><small>1</small></li>
  
    <li><a href="/tags/trigger/">trigger</a><small>1</small></li>
  
    <li><a href="/tags/trusty/">trusty</a><small>1</small></li>
  
    <li><a href="/tags/tumblr/">tumblr</a><small>1</small></li>
  
    <li><a href="/tags/twitter/">twitter</a><small>1</small></li>
  
    <li><a href="/tags/ubuntu/">ubuntu</a><small>5</small></li>
  
    <li><a href="/tags/uglifyjs/">uglifyjs</a><small>1</small></li>
  
    <li><a href="/tags/underscore/">underscore</a><small>1</small></li>
  
    <li><a href="/tags/unicode/">unicode</a><small>1</small></li>
  
    <li><a href="/tags/unique-visitor/">unique-visitor</a><small>4</small></li>
  
    <li><a href="/tags/united-states/">united-states</a><small>1</small></li>
  
    <li><a href="/tags/unix/">unix</a><small>1</small></li>
  
    <li><a href="/tags/unix-philosophy/">unix-philosophy</a><small>1</small></li>
  
    <li><a href="/tags/update/">update</a><small>2</small></li>
  
    <li><a href="/tags/upgrade/">upgrade</a><small>2</small></li>
  
    <li><a href="/tags/upload/">upload</a><small>1</small></li>
  
    <li><a href="/tags/upstart/">upstart</a><small>1</small></li>
  
    <li><a href="/tags/url/">url</a><small>1</small></li>
  
    <li><a href="/tags/username/">username</a><small>1</small></li>
  
    <li><a href="/tags/vagrant/">vagrant</a><small>8</small></li>
  
    <li><a href="/tags/vagrant-box/">vagrant-box</a><small>1</small></li>
  
    <li><a href="/tags/vagrant-google/">vagrant-google</a><small>1</small></li>
  
    <li><a href="/tags/vagrant-plugin/">vagrant-plugin</a><small>1</small></li>
  
    <li><a href="/tags/validation/">validation</a><small>1</small></li>
  
    <li><a href="/tags/version/">version</a><small>4</small></li>
  
    <li><a href="/tags/video/">video</a><small>1</small></li>
  
    <li><a href="/tags/vim/">vim</a><small>3</small></li>
  
    <li><a href="/tags/vimdiff/">vimdiff</a><small>1</small></li>
  
    <li><a href="/tags/vimeo/">vimeo</a><small>1</small></li>
  
    <li><a href="/tags/virtualbox/">virtualbox</a><small>1</small></li>
  
    <li><a href="/tags/visit/">visit</a><small>4</small></li>
  
    <li><a href="/tags/vivid/">vivid</a><small>1</small></li>
  
    <li><a href="/tags/vpn/">vpn</a><small>1</small></li>
  
    <li><a href="/tags/vulnerability/">vulnerability</a><small>1</small></li>
  
    <li><a href="/tags/web-framework/">web-framework</a><small>1</small></li>
  
    <li><a href="/tags/web-server/">web-server</a><small>1</small></li>
  
    <li><a href="/tags/webhook/">webhook</a><small>1</small></li>
  
    <li><a href="/tags/windows/">windows</a><small>2</small></li>
  
    <li><a href="/tags/workflow/">workflow</a><small>1</small></li>
  
    <li><a href="/tags/xiaomi/">xiaomi</a><small>1</small></li>
  
    <li><a href="/tags/yaml/">yaml</a><small>1</small></li>
  
    <li><a href="/tags/yeoman/">yeoman</a><small>1</small></li>
  
    <li><a href="/tags/yield/">yield</a><small>1</small></li>
  
    <li><a href="/tags/zone-apex/">zone-apex</a><small>1</small></li>
  
    <li><a href="/tags/中華電信/">中華電信</a><small>1</small></li>
  
    <li><a href="/tags/小米/">小米</a><small>1</small></li>
  
    <li><a href="/tags/小米手机/">小米手机</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 Chao Huang
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'realguess';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>