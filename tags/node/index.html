<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>node | realguess</title>
  <meta name="author" content="Chao Huang">
  
  <meta name="description" content="Just a blog about every detail encountered.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="realguess"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="realguess" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45698182-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">realguess</a></h1>
  <h2><a href="/">Don&#39;t afraid to try!</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title tag">node</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-07-11T12:00:00.000Z"><a href="/2015/07/11/what-is-the-this-binding-in-async-seq-and-compose-functions/">Jul 11, 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/07/11/what-is-the-this-binding-in-async-seq-and-compose-functions/">What is the &#39;this&#39; Binding in Async &#39;seq&#39; and &#39;compose&#39; Functions?</a></h1>
  

    </header>
    <div class="entry">
      
        <p>TLDR: <code>global</code></p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/07/11/what-is-the-this-binding-in-async-seq-and-compose-functions/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-06-29T12:00:00.000Z"><a href="/2015/06/29/google-cloud-pub-sub-starters-for-gcloud-version-v0-15-x/">Jun 29, 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/06/29/google-cloud-pub-sub-starters-for-gcloud-version-v0-15-x/">Google Cloud Pub/Sub Starters for gcloud Version v0.15.x</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://cloud.google.com/pubsub/docs" target="_blank" rel="external">Google Cloud Pub/Sub</a> starters/examples/references for <a href="https://nodejs.org/api/" target="_blank" rel="external">Node.js</a> gcloud version v0.15.x.</p>
<p>Usage:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ PROJECT=my-project KEYFILENAME=/path/to/keyfile.json node file.sh</div></pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2015/06/29/google-cloud-pub-sub-starters-for-gcloud-version-v0-15-x/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-11-02T12:00:00.000Z"><a href="/2014/11/02/synchronous-console-methods/">Nov 2, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/11/02/synchronous-console-methods/">Synchronous Console Methods</a></h1>
  

    </header>
    <div class="entry">
      
        <p>In Node v0.10.x, <em>the console functions are synchronous when the destination is a terminal or a file (to avoid lost messages in case of premature exit) and asynchronous when it’s a pipe (to avoid blocking for long periods of time).</em> See <a href="http://nodejs.org/api/console.html" target="_blank" rel="external">console</a>. We can test it with the following script:</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2014/11/02/synchronous-console-methods/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-09-20T11:22:33.000Z"><a href="/2014/09/20/dirname-does-not-follow-symlink/">Sep 20, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/09/20/dirname-does-not-follow-symlink/">Dirname Does Not Follow Symlink</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Node’s global object <a href="http://nodejs.org/api/globals.html#globals_dirname" target="_blank" rel="external">__dirname</a> returns the name of the directory that the currently executing script resides in. However, if a directory is symbolic linked or a symlink, it still return the original path.</p>
<p>For example, the following directory structure:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">/tmp/dirname/</span></span></div><div class="line">├── foo</div><div class="line">│   └── app.js</div><div class="line">└── lib</div><div class="line">    ├── bar -&gt; ../foo</div><div class="line">    └── util.js</div><div class="line"></div><div class="line"><span class="number">3</span> directories, <span class="number">2</span> files</div></pre></td></tr></table></figure>

<p>The <code>app.js</code> contains the following line:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">console.<span class="built_in">log</span>(__dirname);</div></pre></td></tr></table></figure>

<p>Run the script:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd /tmp/<span class="keyword">dirname</span>/foo && node app.js</div><div class="line">/tmp/<span class="keyword">dirname</span>/foo</div></pre></td></tr></table></figure>

<p>You get the directory the <code>app.js</code> script is residing it. But if you do the same from the symlinked directory:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd <span class="regexp">/tmp/</span>dirname<span class="regexp">/lib/</span>bar && node app.js</div><div class="line"><span class="regexp">/tmp/</span>dirname<span class="regexp">/foo</span></div></pre></td></tr></table></figure>

<p>Well, you get the same answer, even the current working directory is different:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd <span class="regexp">/tmp/</span>dirname<span class="regexp">/lib/</span>bar && pwd</div><div class="line"><span class="regexp">/tmp/</span>dirname<span class="regexp">/lib/</span>bar</div></pre></td></tr></table></figure>

<p>The return of <code>__dirname</code> does not follow symbolic link.</p>
<p>So, have to be extra careful when requiring files that is symbolic linked. If you think you are in <code>lib/bar</code> directory and try to require the <code>util.js</code> script in <code>app.js</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">var</span> path <span class="subst">=</span> <span class="keyword">require</span>(<span class="string">'path'</span>);</div><div class="line">console<span class="built_in">.</span><span class="keyword">log</span>(<span class="keyword">require</span>(<span class="string">'../util'</span>));</div><div class="line">console<span class="built_in">.</span><span class="keyword">log</span>(<span class="keyword">require</span>(path<span class="built_in">.</span><span class="keyword">join</span>(__dirname, <span class="string">'..'</span>, <span class="string">'util'</span>)));</div></pre></td></tr></table></figure>

<p>Both statements will throw module not found error. Path join does not help either.</p>
<p>The best practice is to avoid symlinks and relative directory requiring. Instead, set up required as modules, and install them in <code>node_modules</code> directory, then they will become top-level modules.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-06-21T21:24:54.000Z"><a href="/2014/06/21/tiny-http-servers/">Jun 21, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/06/21/tiny-http-servers/">Tiny HTTP Servers</a></h1>
  

    </header>
    <div class="entry">
      
        <p>This is a simple way to run a tiny web server via command line:</p>
<pre><code>$ <span class="keyword">python</span> -<span class="keyword">m</span> SimpleHTTPServer <span class="number">8080</span>
</code></pre><p>which will server static files from the current directory.</p>
<p>There is <a href="https://github.com/moserrya/knod" target="_blank" rel="external">Knod</a> for Ruby, and of course there is one for Node: <a href="https://github.com/nodeapps/http-server" target="_blank" rel="external">http-server</a>.</p>
<p>To install:</p>
<pre><code>$ sudo npm <span class="operator"><span class="keyword">install</span> -g http-<span class="keyword">server</span></span>
</code></pre><p>To run:</p>
<pre><code><span class="variable">$ </span>http-server
</code></pre><p>Server will be accessible via <a href="http://localhost:8080/" target="_blank" rel="external">http://localhost:8080/</a>.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-20T13:49:37.000Z"><a href="/2014/05/20/node-version-manager/">May 20, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/20/node-version-manager/">Node Version Manager</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://github.com/creationix/nvm" target="_blank" rel="external">Node Version Manager</a> is a simple bash script to manage multiple active <a href="http://nodejs.org/" target="_blank" rel="external">Node</a> versions. <em>Why do you want to use it?</em> If you like me, you want to try out the latest unstable version of the Node, but you still need to use the older and stable versions to develop and maintain your projects, then you should use <a href="https://github.com/creationix/nvm" target="_blank" rel="external">NVM</a>.</p>
<p>You can find out more information on <a href="https://github.com/creationix/nvm" target="_blank" rel="external">NVM GitHub page</a>, below are just my take on installing and using it.</p>
<h2 id="Install">Install</h2>
<p>You can install NVM via the install script, but always do it the hard way by installing it manually:</p>
<pre><code><span class="variable">$ </span>git clone <span class="symbol">https:</span>/<span class="regexp">/github.com/creationix</span><span class="regexp">/nvm.git ~/</span>.nvm
</code></pre><p>Check out the latest version:</p>
<pre><code>$ <span class="built_in">cd</span> ~/.nvm &amp;&amp; git checkout v0.<span class="number">7.0</span>
</code></pre><p>Enable NVM:</p>
<pre><code>$ <span class="keyword">source</span> ~/.nvm/nvm.<span class="keyword">sh</span>
</code></pre><p>Add this to <code>~/.bashrc</code> to make it available upon login:</p>
<pre><code>$ <span class="built_in">echo</span> <span class="string">"\n# Enable NVM"</span>           &gt;&gt; ~/.bashrc
$ <span class="built_in">echo</span> <span class="string">'source $HOME/.nvm/nvm.sh'</span> &gt;&gt; ~/.bashrc
</code></pre><p>Enable Bash completion:</p>
<pre><code>$ <span class="built_in">echo</span> <span class="string">'source $HOME/.nvm/bash_completion'</span> &gt;&gt; ~/.bashrc
</code></pre><p>Try it by opening a new terminal:</p>
<pre><code><span class="variable">$ </span>nvm
</code></pre><h2 id="Usage">Usage</h2>
<p>Get help:</p>
<pre><code>$ nvm <span class="built_in">help</span>
</code></pre><p>Show current NVM version:</p>
<pre><code>$ nvm --<span class="keyword">version</span>
</code></pre><p>Display the currently active Node version:</p>
<pre><code>$ nvm <span class="literal">current</span>
</code></pre><p>Install Node v0.10.28:</p>
<pre><code><span class="variable">$ </span>nvm install <span class="number">0</span>.<span class="number">10.28</span>
</code></pre><p>The installed Node version will reside in <code>~/.nvm/v0.10.28</code>.</p>
<p>List installed versions:</p>
<pre><code>$ nvm <span class="keyword">ls</span>
    .nvm
v0.<span class="number">10.28</span>
</code></pre><p>Use a specific Node version:</p>
<pre><code><span class="variable">$ </span>which node
/usr/local/bin/node
<span class="variable">$ </span>node -v
v<span class="number">0</span>.<span class="number">11.13</span>
<span class="variable">$ </span>nvm <span class="keyword">use</span> <span class="number">0</span>.<span class="number">10.28</span>
<span class="constant">Now </span>using node v<span class="number">0</span>.<span class="number">10.28</span>
<span class="variable">$ </span>node -v
v<span class="number">0</span>.<span class="number">10.28</span>
<span class="variable">$ </span>which node
/home/chao/.nvm/v<span class="number">0</span>.<span class="number">10.28</span>/bin/node
</code></pre><p>Basically, NVM modified the search path.</p>
<pre><code>$ <span class="built_in">echo</span> <span class="variable">$PATH</span>
/home/chao/.nvm/v0.<span class="number">10.28</span>/bin
</code></pre><p>To roll back:</p>
<pre><code><span class="char">$ </span>nvm deactivate
/home/chao/.nvm/*/bin removed from <span class="char">$P</span>ATH
/home/chao/.nvm/*/share/man removed from <span class="char">$M</span>ANPATH
/home/chao/.nvm/*/lib/node_modules removed from <span class="char">$N</span>ODE_PATH
</code></pre><p>List Node versions available to install:</p>
<pre><code>$ nvm <span class="keyword">ls</span>-remote
</code></pre><p>Use <code>.nvmrc</code> file:</p>
<pre><code><span class="input"><span class="prompt">$ echo '0.10.28' &gt;&gt;</span> .nvmrc</span>
<span class="variable">$ </span>nvm use
<span class="constant">Found</span> <span class="string">'/home/chao/.nvmrc'</span> with version &lt;<span class="number">0</span>.<span class="number">10.28</span>&gt;
<span class="constant">Now</span> using node v<span class="number">0</span>.<span class="number">10.28</span>
<span class="variable">$ </span>node -v
v<span class="number">0</span>.<span class="number">10.28</span>
</code></pre>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-04-02T00:30:00.000Z"><a href="/2014/04/02/difference-between-require-and-fs-in-loading-files/">Apr 2, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/04/02/difference-between-require-and-fs-in-loading-files/">Difference between require and fs in Loading Files</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Node has a simple module loading system by using <code>require</code>.</p>
<blockquote>
<p>A module prefixed with <code>&#39;/&#39;</code> is an absolute path to the file. For example, <code>require(&#39;/home/marco/foo.js&#39;)</code> will load the file at <code>/home/marco/foo.js</code>.</p>
<p>A module prefixed with <code>&#39;./&#39;</code> is relative to the file calling <code>require()</code>. That is, <code>circle.js</code> must be in the same directory as <code>foo.js</code> for <code>require(&#39;./circle&#39;)</code> to find it.</p>
<p>Without a leading <code>&#39;/&#39;</code> or <code>&#39;./&#39;</code> to indicate a file, the module is either a “core module” or is loaded from a <code>node_modules</code> folder.</p>
<p><a href="http://nodejs.org/api/modules.html#modules_file_modules" target="_blank" rel="external">http://nodejs.org/api/modules.html#modules_file_modules</a></p>
</blockquote>
<p>We can also use it to load JSON files by simply specifying the file path. File path can be relative or absolute. Giving the following file structure:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">├── app.js</div><div class="line">├── <span class="typedef"><span class="keyword">data</span></span></div><div class="line">│   └── file.json</div><div class="line">└── lib</div><div class="line">    └── util.js</div></pre></td></tr></table></figure>

<p>Let’s say the root path of the application is <code>/home/marco</code>. Use relative path from the file <code>lib/util.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> json = <span class="built_in">require</span>(<span class="string">'../data/file.json'</span>);</div></pre></td></tr></table></figure>

<p>This will load the JSON content from <code>data/file.json</code>, because the require system knows that the file is relative to the calling file <code>lib/util.js</code>. But when using <a href="http://nodejs.org/api/fs.html" target="_blank" rel="external">file system</a> functions, relative path is not treat the same way:</p>
<blockquote>
<p>Relative path to filename can be used, remember however that this path will be relative to <code>process.cwd()</code>. - <a href="http://nodejs.org/api/fs.html" target="_blank" rel="external">File System</a></p>
</blockquote>
<p><code>process.cwd()</code> returns the current working directory, not the root directory of the application nor the directory of the calling file. For example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = fs.readFileSync(<span class="string">'../data/file.json'</span>);</div></pre></td></tr></table></figure>

<p>If your current working directory is <code>/home/marco/myapp</code>, the application root directory, you will get the following error message:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">fs.js:<span class="number">410</span></div><div class="line">  <span class="keyword">return</span> binding.open(pathModule._makeLong(path), stringToFlags(flags), mode);</div><div class="line">                 ^</div><div class="line"><span class="keyword">Error</span>: ENOENT, no such file <span class="keyword">or</span> directory <span class="comment">'../data/file.json'</span></div><div class="line">    at <span class="built_in">Object</span>.fs.openSync (fs.js:<span class="number">410</span>:<span class="number">18</span>)</div><div class="line">    at <span class="built_in">Object</span>.fs.readFileSync (fs.js:<span class="number">276</span>:<span class="number">15</span>)</div></pre></td></tr></table></figure>

<p>Because <code>process.cwd()</code> is <code>/home/marco/myapp</code>, and reading file relative to this directory with <code>../data/file.json</code>, Node will expect file path to be <code>/home/marco/data/file.json</code>. Therefore, the error is thrown.</p>
<p>The difference between <code>require</code> and <code>fs</code> in loading files is that if the relative path is used in <code>require</code>, it is relative to the file calling the <code>require</code>. If the relative path is used in <code>fs</code>, it is relative to <code>process.cwd()</code>.</p>
<p>To fix the error in file system functions, we should always use absolute path. One thing we can do is:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = fs.readFileSync(__dirname + <span class="string">'/../data/file.json'</span>);</div></pre></td></tr></table></figure>

<p><code>__dirname</code> is “the name of the directory that the currently executing script is resides in” [<a href="http://nodejs.org/api/globals.html#globals_dirname" target="_blank" rel="external">dirname</a>], and it has no trailing slash. The the structure looks odd, even though it works, but it might not work in all systems.</p>
<p>The correct solution here is to use <code>path.join</code> from <a href="http://nodejs.org/api/path.html" target="_blank" rel="external">Path</a>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = fs.readFileSync(path.join(__dirname, <span class="string">'../data/file.json'</span>));</div></pre></td></tr></table></figure>

<p>The <code>path</code> module “contains utilities for handling and transforming file paths”. The <code>path.join</code> function will call <code>path.normalize</code> to “normalize a string path, taking care of <code>..</code> and <code>.</code> paths” [<a href="http://nodejs.org/api/path.html#path_path_normalize_p" target="_blank" rel="external">normalize</a>], also see function <code>normalizeArray</code> in <a href="https://github.com/joyent/node/blob/master/lib/path.js" target="_blank" rel="external">https://github.com/joyent/node/blob/master/lib/path.js</a> on how the paths are normalized.</p>
<p>In conclusion:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Use `require` to load JSON file.</span></div><div class="line"><span class="keyword">var</span> json = <span class="built_in">require</span>(<span class="string">'../data/file.json'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Use `fs` to load JSON file.</span></div><div class="line"><span class="keyword">var</span> data = fs.readFileSync(path.join(__dirname, <span class="string">'../data/file.json'</span>));</div><div class="line"><span class="keyword">var</span> json = <span class="built_in">JSON</span>.parse(data.toString());</div></pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-02-11T22:42:55.000Z"><a href="/2014/02/11/defining-correct-environment-for-coffeescript-in-cron/">Feb 11, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/02/11/defining-correct-environment-for-coffeescript-in-cron/">Defining Correct Environment for CoffeeScript in Cron</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I have written a bunch of CoffeeScript scripts that I would like to run them regularly. <a href="http://en.wikipedia.org/wiki/Cron" target="_blank" rel="external">Cron</a> is certainly the right choice in many situation.</p>
<p>The default executable path recognized by cron is limited:</p>
<pre><code><span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> echo $PATH &gt; /tmp/log/cron.log
</code></pre><p>This cron job will recognize the following path:</p>
<pre><code><span class="regexp">/usr/</span>bin:<span class="regexp">/bin</span>
</code></pre><p>However the default executable path for Node.js is usually at:</p>
<pre><code>$ which node
<span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>node
</code></pre><p>Therefore, if you attempt to run a cron job:</p>
<pre><code><span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> node -v &gt; /tmp/log/cron.log 2&gt; /tmp/log/cron.err.log
</code></pre><p>It will return an error, where the executable is not found:</p>
<pre><code><span class="attribute">bin/sh</span>: <span class="string">1: node: not found</span>
</code></pre><p>The easiest way to solve it is by specifying the fully qualified path:</p>
<pre><code><span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> /usr/local/bin/node -v &gt; /tmp/log/cron.log
</code></pre><p>To ensure the process is installed, we can check the file existence and permission before launching it:</p>
<pre><code><span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> test -x /usr/local/bin/node &amp;&amp; /usr/local/bin/node -v
</code></pre><p>But when working with CoffeeScript, the same method does not working:</p>
<pre><code><span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> <span class="keyword">*</span> /usr/local/bin/coffee -v 2&gt; /tmp/log/cron.err.log
</code></pre><p>Because CoffeeScript binary (<code>coffee</code>) use the following format:</p>
<pre><code><span class="shebang">#!/usr/bin/env node</span>
</code></pre><p>Which does not specify fully qualified path on the shebang line, and will result in:</p>
<pre><code>/usr/bin/env: node: No such <span class="built_in">file</span> <span class="operator">or</span> <span class="built_in">directory</span>
</code></pre><p>We can compile CoffeeScript into JavaScript and use fully qualified <code>node</code> executable. But this is not necessary. Since we are using Debian based system, which uses Vixie cron. It allows environment variables to be defined. We can make Cron aware of the custom path in environment variable:</p>
<pre><code>* * * * * <span class="constant">PATH</span>=<span class="variable">$PATH</span><span class="symbol">:/usr/local/bin</span> coffee -v &gt; <span class="regexp">/tmp/log</span><span class="regexp">/cron.log</span>
</code></pre><p>Now the executable path include the one where both <code>node</code> and <code>coffee</code> commands reside.</p>
<p>We can also move it to its own line. But Cron is not shell, it does not expand the variable, so you have to specify all paths:</p>
<pre><code><span class="comment"># Error: `PATH=$PATH:/usr/local/bin`</span>
<span class="constant">PATH</span>=<span class="regexp">/usr/bin</span><span class="symbol">:/bin</span><span class="symbol">:/usr/local/bin</span>
<span class="input"><span class="prompt">* * * * * coffee -v &gt;</span> /tmp/log/cron.log</span>
</code></pre><p>The good practice is to set environment variables in a script:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/usr/bin/env bash</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># This script is intended to be run as a cron job.</span></div><div class="line"></div><div class="line">PATH=<span class="variable">$PATH</span>:/usr/local/bin</div><div class="line">coffee -v</div></pre></td></tr></table></figure>

<p>and run the script as a cron job:</p>
<pre><code>* * * * * /path/<span class="keyword">to</span>/script &gt; /tmp/<span class="built_in">log</span>/cron.<span class="built_in">log</span> <span class="number">2</span>&gt;&gt; /tmp/<span class="built_in">log</span>/cron.<span class="built_in">err</span>.<span class="built_in">log</span>
</code></pre>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-01-17T14:13:03.000Z"><a href="/2014/01/17/a-new-nodejs-web-framework-koa/">Jan 17, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/17/a-new-nodejs-web-framework-koa/">A New NodeJS Web Framework - Koa</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Taking the first spin on <a href="http://koajs.com/" target="_blank" rel="external">Koa</a>, a new web framework designed by the team behind <a href="http://expressjs.com/" target="_blank" rel="external">Express</a>.</p>
<h2 id="Requirements">Requirements</h2>
<ol>
<li>Node v0.11.9 or higher is required for generator support.</li>
<li><code>--harmony</code> flag must be used when running Node.</li>
</ol>
<p>Without the <code>--harmony</code> flag, genertor function cannot be defined:</p>
<pre><code><span class="function"><span class="keyword">function</span> *<span class="title">fn</span>(</span>) {
           ^
SyntaxError: Unexpected token *
    at exports.runInThisContext (vm.js:<span class="number">69</span>:<span class="number">16</span>)
    at <span class="keyword">Module</span>._compile (<span class="keyword">module</span>.js:<span class="number">432</span>:<span class="number">25</span>)
    at Object.<span class="keyword">Module</span>._extensions..js (<span class="keyword">module</span>.js:<span class="number">467</span>:<span class="number">10</span>)
    at <span class="keyword">Module</span>.load (<span class="keyword">module</span>.js:<span class="number">349</span>:<span class="number">32</span>)
    at <span class="function"><span class="keyword">Function</span>.<span class="title">Module</span>.<span class="title">_load</span> (</span><span class="keyword">module</span>.js:<span class="number">305</span>:<span class="number">12</span>)
    at <span class="function"><span class="keyword">Function</span>.<span class="title">Module</span>.<span class="title">runMain</span> (</span><span class="keyword">module</span>.js:<span class="number">490</span>:<span class="number">10</span>)
    at startup (node.js:<span class="number">123</span>:<span class="number">16</span>)
    at node.js:<span class="number">1031</span>:<span class="number">3</span>
</code></pre><p>So, set the <code>--harmony</code> flag in shell alias:</p>
<pre><code><span class="variable">$ </span><span class="keyword">alias</span> node=<span class="string">'node --harmony'</span>
</code></pre><p>To know more:</p>
<pre><code>$ man node
--harmony (enable all harmony features (except <span class="keyword">typeof</span>))
      type: <span class="keyword">bool</span>  <span class="keyword">default</span>: <span class="keyword">false</span>
</code></pre><p><em>Harmony</em> is the codename of ECMAScript 6, the next version of the standard.</p>
<h2 id="Install">Install</h2>
<pre><code><span class="variable">$ </span>npm install koa
</code></pre><p>The footprint of the framework is small. Therefore, there is no executable binary like Express, and we do not need to install it globally.</p>
<h2 id="Dependencies">Dependencies</h2>
<p>Dependencies on version 0.2.1:</p>
<pre><code><span class="string">"dependencies"</span>: {
  <span class="string">"accepts"</span>: <span class="string">"~1.0.0"</span>,
  <span class="string">"type-is"</span>: <span class="string">"~1.0.0"</span>,
  <span class="string">"on-socket-error"</span>: <span class="string">"~1.0.1"</span>,
  <span class="string">"co"</span>: <span class="string">"~3.0.1"</span>,
  <span class="string">"debug"</span>: <span class="string">"*"</span>,
  <span class="string">"mime"</span>: <span class="string">"~1.2.11"</span>,
  <span class="string">"fresh"</span>: <span class="string">"~0.2.0"</span>,
  <span class="string">"koa-compose"</span>: <span class="string">"~2.1.0"</span>,
  <span class="string">"cookies"</span>: <span class="string">"~0.3.7"</span>,
  <span class="string">"keygrip"</span>: <span class="string">"~1.0.0"</span>
}
</code></pre><h2 id="Middleware">Middleware</h2>
<p>Middleware system is the core of either Express or Koa based application. This needs a separate post. Here just describes the difference in design.</p>
<p>In a simple assembly design, each unit passes control to the next one until the last one terminates and responses to the request:</p>
<pre><code>    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>     <span class="comment">|</span> <span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>     <span class="comment">|</span> <span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>     <span class="comment">|</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">o</span>
    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
</code></pre><p>Express middleware passes control to the next one like an assembly line, but each unit is capable of responding to the request:</p>
<pre><code>       <span class="comment">o</span>           <span class="comment">o</span>           <span class="comment">o</span>
       <span class="comment">|</span>           <span class="comment">|</span>           <span class="comment">|</span>
    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>     <span class="comment">|</span> <span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>     <span class="comment">|</span> <span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>     <span class="comment">|</span>
    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
</code></pre><p>Koa provides a traceback via generator, each unit is capable of working on the request twice instead of once as previous two designs. It is stack alike, where the first generator will also be the last one prior to responding to request:</p>
<pre><code>       <span class="comment">o</span>
       <span class="comment">|</span>
    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
<span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>     <span class="comment">|</span> <span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>     <span class="comment">|</span> <span class="literal">-</span><span class="literal">-</span>&gt; <span class="comment">|</span>     <span class="comment">|</span>
    <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>     <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
       <span class="comment">^</span>          <span class="comment">|</span> <span class="comment">^</span>         <span class="comment">|</span>
       <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span> <span class="literal">+</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">+</span>
</code></pre><p>This is sort of an assembly loop, where the starting station is also be the ending station.</p>
<h2 id="Usage">Usage</h2>
<p>Here is one liner:</p>
<pre><code><span class="built_in">require</span>(<span class="string">'koa'</span>)().use(<span class="function"><span class="keyword">function</span> *<span class="params">()</span> </span>{ <span class="keyword">this</span>.body = <span class="string">'OK'</span>; }).listen(<span class="number">3000</span>);
</code></pre><p><code>app.use</code> requires a generator function or <code>function *()</code>. Koa middleware uses <code>this</code> (context) instead of <code>req</code> and <code>res</code> in Express. It also encapsulates Node’s <code>request</code> and <code>response</code> objects. For example, <code>this</code> or context has the following properties:</p>
<pre><code>[ <span class="string">'request'</span>,     <span class="comment">// Koa request</span>
  <span class="string">'response'</span>,    <span class="comment">// Koa response</span>
  <span class="string">'app'</span>,
  <span class="string">'req'</span>,         <span class="comment">// Node request</span>
  <span class="string">'res'</span>,         <span class="comment">// Node response</span>
  <span class="string">'onerror'</span>,
  <span class="string">'originalUrl'</span>,
  <span class="string">'cookies'</span>,
  <span class="string">'accept'</span> ]
</code></pre><h3 id="Status_and_Body">Status and Body</h3>
<p>Status can be used as a flag indicating whether a request has been processed or not:</p>
<pre><code>app.use(<span class="function"><span class="keyword">function</span> *<span class="params">()</span> </span>{
  <span class="built_in">console</span>.log(<span class="keyword">this</span>.status); <span class="comment">// undefined</span>
  <span class="keyword">this</span>.body = <span class="string">'processed'</span>;
  <span class="built_in">console</span>.log(<span class="keyword">this</span>.status); <span class="comment">// 200</span>
});
</code></pre><p>When the <code>body</code> is populated, <code>status</code> is automatically updated, probably via the <code>nextTick</code> method. So, we can use it as the flag to design a response such as a custom not found response.</p>
<h3 id="Not_Found">Not Found</h3>
<p>Create a custom <code>Not Found</code> in JSON content type:</p>
<pre><code>app.use(<span class="function"><span class="keyword">function</span> *<span class="params">(next)</span> </span>{
  <span class="keyword">yield</span> next; <span class="comment">// The operation is yet to start.</span>
  <span class="keyword">if</span> (<span class="keyword">this</span>.status) { <span class="keyword">return</span>; }

  <span class="keyword">this</span>.status = <span class="number">404</span>;
  <span class="keyword">this</span>.body = { message: <span class="string">'Cannot find what you are looking for :('</span> };
});
app.use(<span class="function"><span class="keyword">function</span> *<span class="params">()</span> </span>{}); <span class="comment">// Do nothing to simulate not found.</span>
</code></pre><h3 id="Error_Handling">Error Handling</h3>
<p>Koa app is capable of catching the error event:</p>
<pre><code>app.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(err, ctx)</span> </span>{
  <span class="comment">// Log errors.</span>
});
</code></pre><p>where <code>ctx</code> is a context instance. But you cannot modify the response body. This is more for server side logging and debugging purpose. The <code>500 Internal Server Error</code> will be returned to the client.</p>
<p>We can use <code>try..catch</code> to define a custom error handling middleware:</p>
<pre><code>app.use(<span class="function"><span class="keyword">function</span> *<span class="params">(next)</span> </span>{
  <span class="keyword">try</span> {
    <span class="keyword">yield</span> next;
  } <span class="keyword">catch</span> (err) {
    <span class="keyword">this</span>.status = err.status || <span class="number">500</span>;
    <span class="keyword">this</span>.body   = { message: err.message || <span class="string">'Bad stuff happened!'</span> };
    <span class="keyword">this</span>.app.emit(<span class="string">'error'</span>, err, <span class="keyword">this</span>); <span class="comment">// Enable error event handling</span>
  }
});
</code></pre><p>Make sure to emit the error event and let the server log the error.</p>
<p>All non-operational middleware (e.g., not found or error) should be defined first, so it can be traced back as the last guards before sending response back.</p>
<h3 id="Routing">Routing</h3>
<p>Out of the box, Koa does not support routing, but it can be achieved via routing middleware, see <a href="https://github.com/koajs/koa/wiki" target="_blank" rel="external">examples</a>.</p>
<h2 id="Examples">Examples</h2>
<p>Define an app with only one middleware generator function:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span><span class="params">(next)</span> </span>{</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'foo'</span>);</div><div class="line">  <span class="keyword">this</span>.status = <span class="number">204</span>;</div><div class="line">}</div><div class="line"><span class="built_in">require</span>(<span class="string">'koa'</span>)().use(foo).listen(<span class="number">3000</span>);</div></pre></td></tr></table></figure>

<p>Instead of using status code <code>200</code>, we use <code>204</code> here, because the response contains no body. If using <code>200</code>, the server does not know the total content length, will result in <code>Transfer-Encoding: chunked</code> header instead of <code>Content-Length</code>. See <a href="http://en.wikipedia.org/wiki/Chunked_transfer_encoding" target="_blank" rel="external">chunked transfer encoding</a>.</p>
<p>This app simply prints out <code>foo</code> on the server side, and respond to a client with status code <code>204</code> and an empty body. We can even omit the <code>next</code> parameter, since we are not using it.</p>
<p>Now let’s use two middleware generator functions:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Response: foo</span></div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span><span class="params">(next)</span> </span>{</div><div class="line">  <span class="keyword">this</span>.body = <span class="string">'foo'</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">bar</span><span class="params">(next)</span> </span>{</div><div class="line">  <span class="keyword">this</span>.body = <span class="string">'bar'</span>;</div><div class="line">}</div><div class="line"><span class="built_in">require</span>(<span class="string">'koa'</span>)().use(foo).use(bar).listen(<span class="number">3000</span>);</div></pre></td></tr></table></figure>

<p>Since generator <code>foo</code> sets the body, generator <code>bar</code> will never be reached. We can change that by adding the <code>yield</code>: </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Response: bar</span></div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span><span class="params">(next)</span> </span>{</div><div class="line">  <span class="keyword">this</span>.body = <span class="string">'foo'</span>;</div><div class="line">  <span class="keyword">yield</span> next;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">bar</span><span class="params">(next)</span> </span>{</div><div class="line">  <span class="keyword">this</span>.body = <span class="string">'bar'</span>;</div><div class="line">  <span class="keyword">yield</span> next;</div><div class="line">}</div><div class="line"><span class="built_in">require</span>(<span class="string">'koa'</span>)().use(foo).use(bar).listen(<span class="number">3000</span>);</div></pre></td></tr></table></figure>

<p>This looks alot like Express, <code>yeild next</code> is similar to <code>next()</code>. Request travels through the middleware system first via <code>foo</code> then <code>bar</code>. But actually by using generator, it also returns back to <code>foo</code> as <code>foo-&gt;bar-&gt;foo</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Response: foo again</span></div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span><span class="params">(next)</span> </span>{</div><div class="line">  <span class="keyword">this</span>.body = <span class="string">'foo'</span>;</div><div class="line">  <span class="keyword">yield</span> next;</div><div class="line">  <span class="keyword">this</span>.body = <span class="string">'foo again'</span>;</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">bar</span><span class="params">(next)</span> </span>{</div><div class="line">  <span class="keyword">this</span>.body = <span class="string">'bar'</span>;</div><div class="line">  <span class="keyword">yield</span> next;</div><div class="line">}</div><div class="line"><span class="built_in">require</span>(<span class="string">'koa'</span>)().use(foo).use(bar).listen(<span class="number">3000</span>);</div></pre></td></tr></table></figure>

<p>This is similar to a stack alike request model, where the first middleware should also be the last middleware to touch the request. There is a no-op middleware in the end to catch the last <code>yield next</code> produced by <code>bar</code> middleware generator and traces back the stack.</p>
<h2 id="Debugging">Debugging</h2>
<p>Set environment variable <code>DEBUG=koa*</code> to enable Koa specific debugging information in development environment:</p>
<pre><code><span class="attribute">$ DEBUG</span>=<span class="string">koa* node app.js</span>
</code></pre><p>You will see a list of middleware. If a middleware is an anonymous function, we can set <code>._name</code> to define a custom name:</p>
<pre><code><span class="function"><span class="keyword">function</span> *<span class="title">foo</span><span class="params">(next)</span> </span>{
  <span class="comment">// Middleware definition starts here.</span>
}
foo._name = <span class="string">'bar'</span>;
app.<span class="keyword">use</span>(foo);
</code></pre><p>The middleware name will be <code>bar</code> instead of <code>foo</code>.</p>
<h2 id="Resources">Resources</h2>
<ol>
<li><a href="http://koajs.com/" target="_blank" rel="external">Koa</a></li>
<li><a href="https://github.com/koajs/koa" target="_blank" rel="external">Koa | GitHub</a></li>
<li><a href="https://github.com/koajs/koa/blob/master/docs/guide.md" target="_blank" rel="external">Koa Quick Guide</a></li>
<li><a href="https://github.com/koajs/koa/wiki" target="_blank" rel="external">Koa Middleware List</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-01-09T09:18:19.000Z"><a href="/2014/01/09/working-with-big-number-in-javascript/">Jan 9, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/01/09/working-with-big-number-in-javascript/">Working with Big Number in JavaScript</a></h1>
  

    </header>
    <div class="entry">
      
        <p>JavaScript is only capable of handling 53-bit numbers, if you are working with a big number such as <a href="https://dev.twitter.com/docs/twitter-ids-json-and-snowflake" target="_blank" rel="external">Twitter ID</a>, which is using 64-bit number, then you need to find an external library to do that, otherwise, there will be precision lost:</p>
<pre><code>&gt; num = <span class="number">420938523475451904</span>
<span class="input"><span class="prompt">420938523475451900
&gt;</span> num = <span class="number">420938523475451904</span> + <span class="number">1</span></span>
<span class="input"><span class="prompt">420938523475451900
&gt;</span> num = <span class="number">420938523475451904</span> - <span class="number">1</span></span>
<span class="number">420938523475451900</span>
</code></pre><p>Here is one library to use in Node environment, install <a href="https://github.com/MikeMcl/big.js/" target="_blank" rel="external">Big.js</a>:</p>
<pre><code><span class="variable">$ </span>npm install big.js
</code></pre><p>Load the module:</p>
<pre><code>&gt; BigNum = <span class="built_in">require</span>(<span class="string">'big.js'</span>)
{ [<span class="built_in">Function</span>: Big] DP: <span class="number">20</span>, RM: <span class="number">1</span> }
</code></pre><p>Use string to create the big number:</p>
<pre><code>&gt; num = <span class="constant">BigNum</span>(<span class="string">'420938523475451904'</span>)
<span class="input"><span class="prompt">{ s: 1,
  e: 17,
  c: [ 4, 2, 0, 9, 3, 8, 5, 2, 3, 4, 7, 5, 4, 5, 1, 9, 0, 4 ] }
&gt;</span> num.toString()</span>
<span class="string">'420938523475451904'</span>
</code></pre><p>Perform addition:</p>
<pre><code>&gt; num.<span class="keyword">plus</span>(<span class="number">1</span>).toString()
<span class="string">'420938523475451905'</span>
</code></pre><p>Perform substraction:</p>
<pre><code>&gt; num.<span class="keyword">minus</span>(<span class="number">1</span>).toString()
<span class="string">'420938523475451903'</span>
</code></pre><p>There are other packages that yet to be tested:</p>
<ul>
<li><a href="https://github.com/MikeMcl/bignumber.js/" target="_blank" rel="external">bignumber.js</a></li>
<li><a href="https://github.com/rauschma/strint" target="_blank" rel="external">strint.js</a></li>
<li><a href="http://jsfromhell.com/classes/bignumber" target="_blank" rel="external">bignumber</a></li>
<li><a href="https://github.com/jtobey/javascript-bignum" target="_blank" rel="external">JavaScript bignumber</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
  
    <a href="/tags/node/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:realguess.net">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/cloud/">Cloud</a><small>2</small></li>
  
    <li><a href="/categories/coding/">Coding</a><small>4</small></li>
  
    <li><a href="/categories/communication/">Communication</a><small>1</small></li>
  
    <li><a href="/categories/devops/">DevOps</a><small>1</small></li>
  
    <li><a href="/categories/linux/">Linux</a><small>1</small></li>
  
    <li><a href="/categories/node-js-and-io-js/">Node.js and io.js</a><small>9</small></li>
  
    <li><a href="/categories/pathfinder/">Pathfinder</a><small>1</small></li>
  
    <li><a href="/categories/productivity/">Productivity</a><small>1</small></li>
  
    <li><a href="/categories/programming/">Programming</a><small>0</small></li>
  
    <li><a href="/categories/security/">Security</a><small>1</small></li>
  
    <li><a href="/categories/starters/">Starters</a><small>1</small></li>
  
    <li><a href="/categories/statistics/">Statistics</a><small>5</small></li>
  
    <li><a href="/categories/test/">Test</a><small>2</small></li>
  
    <li><a href="/categories/tools/">Tools</a><small>24</small></li>
  
    <li><a href="/categories/travel/">Travel</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/2013/">2013</a><small>1</small></li>
  
    <li><a href="/tags/2014/">2014</a><small>3</small></li>
  
    <li><a href="/tags/2015/">2015</a><small>1</small></li>
  
    <li><a href="/tags/abraham-lincoln/">abraham-lincoln</a><small>1</small></li>
  
    <li><a href="/tags/absolute-path/">absolute-path</a><small>1</small></li>
  
    <li><a href="/tags/accessor-property/">accessor-property</a><small>1</small></li>
  
    <li><a href="/tags/aftereach/">aftereach</a><small>1</small></li>
  
    <li><a href="/tags/agenda/">agenda</a><small>1</small></li>
  
    <li><a href="/tags/alexa/">alexa</a><small>3</small></li>
  
    <li><a href="/tags/alias/">alias</a><small>1</small></li>
  
    <li><a href="/tags/amazon/">amazon</a><small>6</small></li>
  
    <li><a href="/tags/amazon-s3/">amazon-s3</a><small>2</small></li>
  
    <li><a href="/tags/amazon-s3api/">amazon-s3api</a><small>1</small></li>
  
    <li><a href="/tags/amazon-sqs/">amazon-sqs</a><small>1</small></li>
  
    <li><a href="/tags/amtrak/">amtrak</a><small>1</small></li>
  
    <li><a href="/tags/android/">android</a><small>1</small></li>
  
    <li><a href="/tags/android-4-3/">android-4.3</a><small>1</small></li>
  
    <li><a href="/tags/anonymous/">anonymous</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-function/">anonymous-function</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-like/">anonymous-like</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-login/">anonymous-login</a><small>1</small></li>
  
    <li><a href="/tags/ansible/">ansible</a><small>1</small></li>
  
    <li><a href="/tags/app-engine/">app-engine</a><small>1</small></li>
  
    <li><a href="/tags/apple/">apple</a><small>1</small></li>
  
    <li><a href="/tags/apt-get/">apt-get</a><small>1</small></li>
  
    <li><a href="/tags/array/">array</a><small>3</small></li>
  
    <li><a href="/tags/async/">async</a><small>1</small></li>
  
    <li><a href="/tags/asynchronous/">asynchronous</a><small>2</small></li>
  
    <li><a href="/tags/automated-build/">automated-build</a><small>1</small></li>
  
    <li><a href="/tags/automatic-link/">automatic-link</a><small>1</small></li>
  
    <li><a href="/tags/automation/">automation</a><small>2</small></li>
  
    <li><a href="/tags/awk/">awk</a><small>1</small></li>
  
    <li><a href="/tags/aws/">aws</a><small>8</small></li>
  
    <li><a href="/tags/aws-cli/">aws-cli</a><small>4</small></li>
  
    <li><a href="/tags/aws-sdk/">aws-sdk</a><small>1</small></li>
  
    <li><a href="/tags/bash/">bash</a><small>3</small></li>
  
    <li><a href="/tags/beforeeach/">beforeeach</a><small>1</small></li>
  
    <li><a href="/tags/best-practice/">best-practice</a><small>2</small></li>
  
    <li><a href="/tags/big-apple/">big-apple</a><small>1</small></li>
  
    <li><a href="/tags/big-easy/">big-easy</a><small>1</small></li>
  
    <li><a href="/tags/big-number/">big-number</a><small>1</small></li>
  
    <li><a href="/tags/binding/">binding</a><small>1</small></li>
  
    <li><a href="/tags/bitbucket/">bitbucket</a><small>2</small></li>
  
    <li><a href="/tags/blog/">blog</a><small>4</small></li>
  
    <li><a href="/tags/boss/">boss</a><small>1</small></li>
  
    <li><a href="/tags/brace-expansion/">brace-expansion</a><small>1</small></li>
  
    <li><a href="/tags/bret-victor/">bret-victor</a><small>1</small></li>
  
    <li><a href="/tags/browser/">browser</a><small>1</small></li>
  
    <li><a href="/tags/browser-sync/">browser-sync</a><small>1</small></li>
  
    <li><a href="/tags/busybox/">busybox</a><small>1</small></li>
  
    <li><a href="/tags/byobu/">byobu</a><small>1</small></li>
  
    <li><a href="/tags/cat/">cat</a><small>1</small></li>
  
    <li><a href="/tags/chai/">chai</a><small>1</small></li>
  
    <li><a href="/tags/changelog/">changelog</a><small>1</small></li>
  
    <li><a href="/tags/chat/">chat</a><small>1</small></li>
  
    <li><a href="/tags/chrome/">chrome</a><small>1</small></li>
  
    <li><a href="/tags/chunghwa-telecom/">chunghwa-telecom</a><small>1</small></li>
  
    <li><a href="/tags/cli/">cli</a><small>7</small></li>
  
    <li><a href="/tags/cloud-storage/">cloud-storage</a><small>1</small></li>
  
    <li><a href="/tags/cloud9/">cloud9</a><small>1</small></li>
  
    <li><a href="/tags/cm/">cm</a><small>1</small></li>
  
    <li><a href="/tags/cname/">cname</a><small>1</small></li>
  
    <li><a href="/tags/cocoon/">cocoon</a><small>1</small></li>
  
    <li><a href="/tags/coding-style/">coding-style</a><small>2</small></li>
  
    <li><a href="/tags/coffeelint/">coffeelint</a><small>1</small></li>
  
    <li><a href="/tags/coffeescript/">coffeescript</a><small>7</small></li>
  
    <li><a href="/tags/color/">color</a><small>1</small></li>
  
    <li><a href="/tags/comcast/">comcast</a><small>1</small></li>
  
    <li><a href="/tags/command-history/">command-history</a><small>1</small></li>
  
    <li><a href="/tags/command-line/">command-line</a><small>2</small></li>
  
    <li><a href="/tags/command-line-interface/">command-line-interface</a><small>1</small></li>
  
    <li><a href="/tags/compare/">compare</a><small>1</small></li>
  
    <li><a href="/tags/compose/">compose</a><small>1</small></li>
  
    <li><a href="/tags/configuration/">configuration</a><small>1</small></li>
  
    <li><a href="/tags/configuration-management/">configuration-management</a><small>1</small></li>
  
    <li><a href="/tags/console/">console</a><small>1</small></li>
  
    <li><a href="/tags/container/">container</a><small>1</small></li>
  
    <li><a href="/tags/content-type/">content-type</a><small>1</small></li>
  
    <li><a href="/tags/context/">context</a><small>1</small></li>
  
    <li><a href="/tags/control-character/">control-character</a><small>1</small></li>
  
    <li><a href="/tags/cors/">cors</a><small>1</small></li>
  
    <li><a href="/tags/crescent/">crescent</a><small>1</small></li>
  
    <li><a href="/tags/crlf/">crlf</a><small>1</small></li>
  
    <li><a href="/tags/cron/">cron</a><small>2</small></li>
  
    <li><a href="/tags/crontab/">crontab</a><small>1</small></li>
  
    <li><a href="/tags/cryptography/">cryptography</a><small>1</small></li>
  
    <li><a href="/tags/custom-domain/">custom-domain</a><small>2</small></li>
  
    <li><a href="/tags/custom-generator/">custom-generator</a><small>1</small></li>
  
    <li><a href="/tags/cwd/">cwd</a><small>1</small></li>
  
    <li><a href="/tags/data-volume/">data-volume</a><small>1</small></li>
  
    <li><a href="/tags/datagram/">datagram</a><small>1</small></li>
  
    <li><a href="/tags/date/">date</a><small>1</small></li>
  
    <li><a href="/tags/debian/">debian</a><small>1</small></li>
  
    <li><a href="/tags/december/">december</a><small>1</small></li>
  
    <li><a href="/tags/delimiter/">delimiter</a><small>1</small></li>
  
    <li><a href="/tags/dependency/">dependency</a><small>2</small></li>
  
    <li><a href="/tags/development/">development</a><small>1</small></li>
  
    <li><a href="/tags/development-environment/">development-environment</a><small>1</small></li>
  
    <li><a href="/tags/diff/">diff</a><small>2</small></li>
  
    <li><a href="/tags/directory/">directory</a><small>1</small></li>
  
    <li><a href="/tags/dirname/">dirname</a><small>1</small></li>
  
    <li><a href="/tags/distributed/">distributed</a><small>1</small></li>
  
    <li><a href="/tags/distributed-team/">distributed-team</a><small>1</small></li>
  
    <li><a href="/tags/dns/">dns</a><small>2</small></li>
  
    <li><a href="/tags/docco/">docco</a><small>1</small></li>
  
    <li><a href="/tags/docker/">docker</a><small>5</small></li>
  
    <li><a href="/tags/domain/">domain</a><small>1</small></li>
  
    <li><a href="/tags/duplication/">duplication</a><small>1</small></li>
  
    <li><a href="/tags/ec2/">ec2</a><small>3</small></li>
  
    <li><a href="/tags/echo/">echo</a><small>2</small></li>
  
    <li><a href="/tags/ecmascript-harmony/">ecmascript-harmony</a><small>1</small></li>
  
    <li><a href="/tags/encryption/">encryption</a><small>1</small></li>
  
    <li><a href="/tags/environment/">environment</a><small>3</small></li>
  
    <li><a href="/tags/environment-variable/">environment-variable</a><small>2</small></li>
  
    <li><a href="/tags/eol/">eol</a><small>1</small></li>
  
    <li><a href="/tags/ephemeral/">ephemeral</a><small>1</small></li>
  
    <li><a href="/tags/express/">express</a><small>3</small></li>
  
    <li><a href="/tags/extended-pattern-matching/">extended-pattern-matching</a><small>1</small></li>
  
    <li><a href="/tags/extglob/">extglob</a><small>1</small></li>
  
    <li><a href="/tags/facebook/">facebook</a><small>1</small></li>
  
    <li><a href="/tags/file-system/">file-system</a><small>1</small></li>
  
    <li><a href="/tags/filename/">filename</a><small>1</small></li>
  
    <li><a href="/tags/firewall/">firewall</a><small>1</small></li>
  
    <li><a href="/tags/folder/">folder</a><small>1</small></li>
  
    <li><a href="/tags/fs/">fs</a><small>1</small></li>
  
    <li><a href="/tags/function/">function</a><small>4</small></li>
  
    <li><a href="/tags/function-declaration/">function-declaration</a><small>2</small></li>
  
    <li><a href="/tags/function-expression/">function-expression</a><small>3</small></li>
  
    <li><a href="/tags/function-innovation/">function-innovation</a><small>1</small></li>
  
    <li><a href="/tags/gcloud/">gcloud</a><small>2</small></li>
  
    <li><a href="/tags/generator/">generator</a><small>1</small></li>
  
    <li><a href="/tags/get/">get</a><small>1</small></li>
  
    <li><a href="/tags/getter/">getter</a><small>2</small></li>
  
    <li><a href="/tags/ghost/">ghost</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>3</small></li>
  
    <li><a href="/tags/git-branch/">git-branch</a><small>1</small></li>
  
    <li><a href="/tags/github/">github</a><small>4</small></li>
  
    <li><a href="/tags/github-pages/">github-pages</a><small>1</small></li>
  
    <li><a href="/tags/glob/">glob</a><small>1</small></li>
  
    <li><a href="/tags/gnome/">gnome</a><small>1</small></li>
  
    <li><a href="/tags/goal/">goal</a><small>1</small></li>
  
    <li><a href="/tags/google-analytics/">google-analytics</a><small>4</small></li>
  
    <li><a href="/tags/google-cloud-pubsub/">google-cloud-pubsub</a><small>1</small></li>
  
    <li><a href="/tags/google-keep/">google-keep</a><small>1</small></li>
  
    <li><a href="/tags/google-trends/">google-trends</a><small>1</small></li>
  
    <li><a href="/tags/groupthink/">groupthink</a><small>1</small></li>
  
    <li><a href="/tags/grunt/">grunt</a><small>1</small></li>
  
    <li><a href="/tags/grunt-contrib-jshint/">grunt-contrib-jshint</a><small>1</small></li>
  
    <li><a href="/tags/grunt-contrib-watch/">grunt-contrib-watch</a><small>1</small></li>
  
    <li><a href="/tags/guard/">guard</a><small>1</small></li>
  
    <li><a href="/tags/gulp/">gulp</a><small>2</small></li>
  
    <li><a href="/tags/hackathon/">hackathon</a><small>1</small></li>
  
    <li><a href="/tags/head/">head</a><small>2</small></li>
  
    <li><a href="/tags/heartbleed/">heartbleed</a><small>1</small></li>
  
    <li><a href="/tags/hexo/">hexo</a><small>1</small></li>
  
    <li><a href="/tags/hipchat/">hipchat</a><small>1</small></li>
  
    <li><a href="/tags/hong-kong/">hong-kong</a><small>1</small></li>
  
    <li><a href="/tags/hosted-zone/">hosted-zone</a><small>1</small></li>
  
    <li><a href="/tags/hotlinking/">hotlinking</a><small>1</small></li>
  
    <li><a href="/tags/http/">http</a><small>3</small></li>
  
    <li><a href="/tags/http-server/">http-server</a><small>1</small></li>
  
    <li><a href="/tags/id/">id</a><small>1</small></li>
  
    <li><a href="/tags/ide/">ide</a><small>1</small></li>
  
    <li><a href="/tags/identifier/">identifier</a><small>1</small></li>
  
    <li><a href="/tags/iife/">iife</a><small>2</small></li>
  
    <li><a href="/tags/imessage/">imessage</a><small>1</small></li>
  
    <li><a href="/tags/immediately-invoked-function-expression/">immediately-invoked-function-expression</a><small>2</small></li>
  
    <li><a href="/tags/inheritance/">inheritance</a><small>1</small></li>
  
    <li><a href="/tags/install/">install</a><small>2</small></li>
  
    <li><a href="/tags/interactive/">interactive</a><small>2</small></li>
  
    <li><a href="/tags/internet-speed/">internet-speed</a><small>1</small></li>
  
    <li><a href="/tags/interpreter/">interpreter</a><small>1</small></li>
  
    <li><a href="/tags/iojs/">iojs</a><small>2</small></li>
  
    <li><a href="/tags/ip-address/">ip-address</a><small>3</small></li>
  
    <li><a href="/tags/january/">january</a><small>1</small></li>
  
    <li><a href="/tags/jasmine/">jasmine</a><small>1</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>12</small></li>
  
    <li><a href="/tags/jelly-bean/">jelly-bean</a><small>1</small></li>
  
    <li><a href="/tags/join/">join</a><small>1</small></li>
  
    <li><a href="/tags/jq/">jq</a><small>4</small></li>
  
    <li><a href="/tags/jshint/">jshint</a><small>1</small></li>
  
    <li><a href="/tags/json/">json</a><small>4</small></li>
  
    <li><a href="/tags/koa/">koa</a><small>4</small></li>
  
    <li><a href="/tags/koa-compose/">koa-compose</a><small>1</small></li>
  
    <li><a href="/tags/koa-router/">koa-router</a><small>1</small></li>
  
    <li><a href="/tags/lean/">lean</a><small>1</small></li>
  
    <li><a href="/tags/lean-coffee/">lean-coffee</a><small>1</small></li>
  
    <li><a href="/tags/lean-startup/">lean-startup</a><small>1</small></li>
  
    <li><a href="/tags/left-to-right-mark/">left-to-right-mark</a><small>1</small></li>
  
    <li><a href="/tags/lf/">lf</a><small>1</small></li>
  
    <li><a href="/tags/libssl/">libssl</a><small>1</small></li>
  
    <li><a href="/tags/license/">license</a><small>1</small></li>
  
    <li><a href="/tags/like-button/">like-button</a><small>1</small></li>
  
    <li><a href="/tags/line-divider/">line-divider</a><small>1</small></li>
  
    <li><a href="/tags/line-ending/">line-ending</a><small>1</small></li>
  
    <li><a href="/tags/linux/">linux</a><small>3</small></li>
  
    <li><a href="/tags/listobjects/">listobjects</a><small>1</small></li>
  
    <li><a href="/tags/livereload/">livereload</a><small>2</small></li>
  
    <li><a href="/tags/load/">load</a><small>1</small></li>
  
    <li><a href="/tags/lodash/">lodash</a><small>1</small></li>
  
    <li><a href="/tags/log/">log</a><small>1</small></li>
  
    <li><a href="/tags/m101/">m101</a><small>1</small></li>
  
    <li><a href="/tags/managed-vms/">managed-vms</a><small>1</small></li>
  
    <li><a href="/tags/markdown/">markdown</a><small>2</small></li>
  
    <li><a href="/tags/meeting/">meeting</a><small>1</small></li>
  
    <li><a href="/tags/messaging/">messaging</a><small>1</small></li>
  
    <li><a href="/tags/metric/">metric</a><small>4</small></li>
  
    <li><a href="/tags/mi3/">mi3</a><small>1</small></li>
  
    <li><a href="/tags/middleware/">middleware</a><small>1</small></li>
  
    <li><a href="/tags/minimatch/">minimatch</a><small>1</small></li>
  
    <li><a href="/tags/mocha/">mocha</a><small>3</small></li>
  
    <li><a href="/tags/module/">module</a><small>1</small></li>
  
    <li><a href="/tags/module-caching/">module-caching</a><small>1</small></li>
  
    <li><a href="/tags/mongodb/">mongodb</a><small>1</small></li>
  
    <li><a href="/tags/mongoexport/">mongoexport</a><small>1</small></li>
  
    <li><a href="/tags/multi-parts/">multi-parts</a><small>1</small></li>
  
    <li><a href="/tags/multiple/">multiple</a><small>2</small></li>
  
    <li><a href="/tags/named-function/">named-function</a><small>1</small></li>
  
    <li><a href="/tags/nb/">nb</a><small>1</small></li>
  
    <li><a href="/tags/network/">network</a><small>1</small></li>
  
    <li><a href="/tags/new-orleans/">new-orleans</a><small>1</small></li>
  
    <li><a href="/tags/new-york/">new-york</a><small>1</small></li>
  
    <li><a href="/tags/nginx/">nginx</a><small>2</small></li>
  
    <li><a href="/tags/node/">node</a><small>14</small></li>
  
    <li><a href="/tags/node-version-manager/">node-version-manager</a><small>1</small></li>
  
    <li><a href="/tags/nodemon/">nodemon</a><small>1</small></li>
  
    <li><a href="/tags/normalization/">normalization</a><small>1</small></li>
  
    <li><a href="/tags/nota-bene/">nota-bene</a><small>1</small></li>
  
    <li><a href="/tags/note-well/">note-well</a><small>1</small></li>
  
    <li><a href="/tags/november/">november</a><small>1</small></li>
  
    <li><a href="/tags/npm/">npm</a><small>3</small></li>
  
    <li><a href="/tags/npm-module/">npm-module</a><small>1</small></li>
  
    <li><a href="/tags/null/">null</a><small>1</small></li>
  
    <li><a href="/tags/nvm/">nvm</a><small>1</small></li>
  
    <li><a href="/tags/object/">object</a><small>3</small></li>
  
    <li><a href="/tags/object-attributes/">object-attributes</a><small>1</small></li>
  
    <li><a href="/tags/openssl/">openssl</a><small>1</small></li>
  
    <li><a href="/tags/order/">order</a><small>1</small></li>
  
    <li><a href="/tags/outdated/">outdated</a><small>1</small></li>
  
    <li><a href="/tags/package/">package</a><small>1</small></li>
  
    <li><a href="/tags/package-json/">package.json</a><small>1</small></li>
  
    <li><a href="/tags/pageview/">pageview</a><small>4</small></li>
  
    <li><a href="/tags/parseint/">parseint</a><small>1</small></li>
  
    <li><a href="/tags/path/">path</a><small>4</small></li>
  
    <li><a href="/tags/pattern-matching/">pattern-matching</a><small>1</small></li>
  
    <li><a href="/tags/ping/">ping</a><small>1</small></li>
  
    <li><a href="/tags/pm2/">pm2</a><small>1</small></li>
  
    <li><a href="/tags/port/">port</a><small>2</small></li>
  
    <li><a href="/tags/prefix/">prefix</a><small>1</small></li>
  
    <li><a href="/tags/preinstall/">preinstall</a><small>1</small></li>
  
    <li><a href="/tags/principle/">principle</a><small>1</small></li>
  
    <li><a href="/tags/process/">process</a><small>1</small></li>
  
    <li><a href="/tags/profile/">profile</a><small>1</small></li>
  
    <li><a href="/tags/programming-style/">programming-style</a><small>1</small></li>
  
    <li><a href="/tags/provision/">provision</a><small>1</small></li>
  
    <li><a href="/tags/proxy/">proxy</a><small>1</small></li>
  
    <li><a href="/tags/python/">python</a><small>1</small></li>
  
    <li><a href="/tags/query-parameter/">query-parameter</a><small>1</small></li>
  
    <li><a href="/tags/queue/">queue</a><small>1</small></li>
  
    <li><a href="/tags/random/">random</a><small>2</small></li>
  
    <li><a href="/tags/rawgit/">rawgit</a><small>1</small></li>
  
    <li><a href="/tags/read/">read</a><small>1</small></li>
  
    <li><a href="/tags/reboot/">reboot</a><small>2</small></li>
  
    <li><a href="/tags/record-set/">record-set</a><small>1</small></li>
  
    <li><a href="/tags/redis/">redis</a><small>1</small></li>
  
    <li><a href="/tags/relative-path/">relative-path</a><small>1</small></li>
  
    <li><a href="/tags/remote-working/">remote-working</a><small>1</small></li>
  
    <li><a href="/tags/repl/">repl</a><small>1</small></li>
  
    <li><a href="/tags/require/">require</a><small>2</small></li>
  
    <li><a href="/tags/responsibility/">responsibility</a><small>1</small></li>
  
    <li><a href="/tags/restart/">restart</a><small>1</small></li>
  
    <li><a href="/tags/rlwrap/">rlwrap</a><small>1</small></li>
  
    <li><a href="/tags/route-53/">route-53</a><small>2</small></li>
  
    <li><a href="/tags/ruby/">ruby</a><small>1</small></li>
  
    <li><a href="/tags/san-francisco/">san-francisco</a><small>1</small></li>
  
    <li><a href="/tags/save/">save</a><small>1</small></li>
  
    <li><a href="/tags/scaffolding/">scaffolding</a><small>1</small></li>
  
    <li><a href="/tags/script/">script</a><small>1</small></li>
  
    <li><a href="/tags/search/">search</a><small>1</small></li>
  
    <li><a href="/tags/search-term/">search-term</a><small>1</small></li>
  
    <li><a href="/tags/security/">security</a><small>1</small></li>
  
    <li><a href="/tags/security-group/">security-group</a><small>2</small></li>
  
    <li><a href="/tags/sed/">sed</a><small>1</small></li>
  
    <li><a href="/tags/semantics/">semantics</a><small>1</small></li>
  
    <li><a href="/tags/semver/">semver</a><small>1</small></li>
  
    <li><a href="/tags/seq/">seq</a><small>1</small></li>
  
    <li><a href="/tags/serialization/">serialization</a><small>1</small></li>
  
    <li><a href="/tags/server/">server</a><small>1</small></li>
  
    <li><a href="/tags/setter/">setter</a><small>2</small></li>
  
    <li><a href="/tags/settings/">settings</a><small>1</small></li>
  
    <li><a href="/tags/setup/">setup</a><small>1</small></li>
  
    <li><a href="/tags/shabang/">shabang</a><small>1</small></li>
  
    <li><a href="/tags/sharing/">sharing</a><small>1</small></li>
  
    <li><a href="/tags/shebang/">shebang</a><small>1</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>3</small></li>
  
    <li><a href="/tags/shell-expansion/">shell-expansion</a><small>1</small></li>
  
    <li><a href="/tags/shell-script/">shell-script</a><small>1</small></li>
  
    <li><a href="/tags/shellshock/">shellshock</a><small>1</small></li>
  
    <li><a href="/tags/shopt/">shopt</a><small>1</small></li>
  
    <li><a href="/tags/socket-io/">socket-io</a><small>1</small></li>
  
    <li><a href="/tags/source-maps/">source-maps</a><small>1</small></li>
  
    <li><a href="/tags/speed-test/">speed-test</a><small>1</small></li>
  
    <li><a href="/tags/split/">split</a><small>2</small></li>
  
    <li><a href="/tags/ssh/">ssh</a><small>3</small></li>
  
    <li><a href="/tags/ssh-copy-id/">ssh-copy-id</a><small>1</small></li>
  
    <li><a href="/tags/sshuttle/">sshuttle</a><small>1</small></li>
  
    <li><a href="/tags/starter/">starter</a><small>1</small></li>
  
    <li><a href="/tags/startup/">startup</a><small>2</small></li>
  
    <li><a href="/tags/stats/">stats</a><small>5</small></li>
  
    <li><a href="/tags/stream/">stream</a><small>1</small></li>
  
    <li><a href="/tags/stringify/">stringify</a><small>1</small></li>
  
    <li><a href="/tags/structure/">structure</a><small>1</small></li>
  
    <li><a href="/tags/subscription/">subscription</a><small>1</small></li>
  
    <li><a href="/tags/success/">success</a><small>1</small></li>
  
    <li><a href="/tags/sudo/">sudo</a><small>1</small></li>
  
    <li><a href="/tags/supertest/">supertest</a><small>1</small></li>
  
    <li><a href="/tags/symbolic-link/">symbolic-link</a><small>1</small></li>
  
    <li><a href="/tags/symlink/">symlink</a><small>1</small></li>
  
    <li><a href="/tags/sync/">sync</a><small>1</small></li>
  
    <li><a href="/tags/synchronous/">synchronous</a><small>2</small></li>
  
    <li><a href="/tags/taipei/">taipei</a><small>1</small></li>
  
    <li><a href="/tags/taiwan/">taiwan</a><small>1</small></li>
  
    <li><a href="/tags/task/">task</a><small>1</small></li>
  
    <li><a href="/tags/tcdisrupt/">tcdisrupt</a><small>1</small></li>
  
    <li><a href="/tags/teardown/">teardown</a><small>1</small></li>
  
    <li><a href="/tags/techcrunch/">techcrunch</a><small>1</small></li>
  
    <li><a href="/tags/template/">template</a><small>1</small></li>
  
    <li><a href="/tags/terminal/">terminal</a><small>1</small></li>
  
    <li><a href="/tags/test/">test</a><small>1</small></li>
  
    <li><a href="/tags/testing/">testing</a><small>1</small></li>
  
    <li><a href="/tags/texting/">texting</a><small>1</small></li>
  
    <li><a href="/tags/this/">this</a><small>1</small></li>
  
    <li><a href="/tags/time-zone/">time-zone</a><small>1</small></li>
  
    <li><a href="/tags/tmux/">tmux</a><small>1</small></li>
  
    <li><a href="/tags/todo/">todo</a><small>1</small></li>
  
    <li><a href="/tags/topic/">topic</a><small>2</small></li>
  
    <li><a href="/tags/train/">train</a><small>1</small></li>
  
    <li><a href="/tags/travel/">travel</a><small>1</small></li>
  
    <li><a href="/tags/trello/">trello</a><small>1</small></li>
  
    <li><a href="/tags/trigger/">trigger</a><small>1</small></li>
  
    <li><a href="/tags/tumblr/">tumblr</a><small>1</small></li>
  
    <li><a href="/tags/twitter/">twitter</a><small>1</small></li>
  
    <li><a href="/tags/ubuntu/">ubuntu</a><small>3</small></li>
  
    <li><a href="/tags/uglifyjs/">uglifyjs</a><small>1</small></li>
  
    <li><a href="/tags/underscore/">underscore</a><small>1</small></li>
  
    <li><a href="/tags/unicode/">unicode</a><small>1</small></li>
  
    <li><a href="/tags/unique-visitor/">unique-visitor</a><small>4</small></li>
  
    <li><a href="/tags/united-states/">united-states</a><small>1</small></li>
  
    <li><a href="/tags/unix/">unix</a><small>1</small></li>
  
    <li><a href="/tags/unix-philosophy/">unix-philosophy</a><small>1</small></li>
  
    <li><a href="/tags/update/">update</a><small>1</small></li>
  
    <li><a href="/tags/upgrade/">upgrade</a><small>1</small></li>
  
    <li><a href="/tags/upload/">upload</a><small>1</small></li>
  
    <li><a href="/tags/upstart/">upstart</a><small>1</small></li>
  
    <li><a href="/tags/username/">username</a><small>1</small></li>
  
    <li><a href="/tags/vagrant/">vagrant</a><small>4</small></li>
  
    <li><a href="/tags/version/">version</a><small>1</small></li>
  
    <li><a href="/tags/video/">video</a><small>1</small></li>
  
    <li><a href="/tags/vim/">vim</a><small>3</small></li>
  
    <li><a href="/tags/vimdiff/">vimdiff</a><small>1</small></li>
  
    <li><a href="/tags/vimeo/">vimeo</a><small>1</small></li>
  
    <li><a href="/tags/visit/">visit</a><small>4</small></li>
  
    <li><a href="/tags/vpn/">vpn</a><small>1</small></li>
  
    <li><a href="/tags/vulnerability/">vulnerability</a><small>1</small></li>
  
    <li><a href="/tags/web-framework/">web-framework</a><small>1</small></li>
  
    <li><a href="/tags/web-server/">web-server</a><small>1</small></li>
  
    <li><a href="/tags/webhook/">webhook</a><small>1</small></li>
  
    <li><a href="/tags/windows/">windows</a><small>1</small></li>
  
    <li><a href="/tags/workflow/">workflow</a><small>1</small></li>
  
    <li><a href="/tags/xiaomi/">xiaomi</a><small>1</small></li>
  
    <li><a href="/tags/yeoman/">yeoman</a><small>1</small></li>
  
    <li><a href="/tags/yield/">yield</a><small>1</small></li>
  
    <li><a href="/tags/zone-apex/">zone-apex</a><small>1</small></li>
  
    <li><a href="/tags/中華電信/">中華電信</a><small>1</small></li>
  
    <li><a href="/tags/小米/">小米</a><small>1</small></li>
  
    <li><a href="/tags/小米手机/">小米手机</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Chao Huang
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'realguess';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>