<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>realguess</title>
  <meta name="author" content="Chao Huang">
  
  <meta name="description" content="Just a blog about every detail encountered.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="realguess"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="realguess" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45698182-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">realguess</a></h1>
  <h2><a href="/">Don&#39;t afraid to try!</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2018-12-10T12:00:00.000Z"><a href="/2018/12/10/amazon-api-gateway-no-integration-defined-for-method/">Dec 10, 2018</a></time>
      
      
  
    <h1 class="title"><a href="/2018/12/10/amazon-api-gateway-no-integration-defined-for-method/">Amazon API Gateway No Integration Defined for Method</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Encountered the following problem when deploying with the <a href="https://serverless.com" target="_blank" rel="external">Serverless Framework</a> (<code>v1.27.3</code>) to <a href="https://aws.amazon.com/api-gateway/" target="_blank" rel="external">Amazon API Gateway</a>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="type">CloudFormation</span> - <span class="type">CREATE_IN_PROGRESS</span> - <span class="type">AWS</span>::<span class="type">ApiGateway</span>::<span class="type">Deployment</span> - <span class="type">ApiGatewayDeployment</span></div><div class="line"><span class="type">CloudFormation</span> - <span class="type">CREATE_FAILED</span> - <span class="type">AWS</span>::<span class="type">ApiGateway</span>::<span class="type">Deployment</span> - <span class="type">ApiGatewayDeployment</span></div><div class="line"></div><div class="line"><span class="type">An</span> error occurred: <span class="type">ApiGatewayDeployment</span> - <span class="type">No</span> integration defined <span class="keyword">for</span> <span class="keyword">method</span></div></pre></td></tr></table></figure>

<p>The problem was not the bug from the Serverless side, but was originated with manually created resource without integration defined for the <code>POST</code> method:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ aws apigateway get-integration --rest-api-id xxxxxxxxxx --resource-id <span class="number">0</span>xxxxx --http-<span class="function"><span class="keyword">method</span> <span class="title">post</span></span></div><div class="line"></div><div class="line"><span class="title">An</span> <span class="title">error</span> <span class="title">occurred</span> <span class="params">(NotFoundException)</span> <span class="title">when</span> <span class="title">calling</span> <span class="title">the</span> <span class="title">GetIntegration</span> <span class="title">operation</span>: No integration defined <span class="keyword">for</span> <span class="function"><span class="keyword">method</span></span></div></pre></td></tr></table></figure>

<p>After removing the resource. The deployment works again.</p>
<p>In conclusion, if there is a resource and one of its method has no integration, the REST API cannot be deployed. Either removing the resource or creating an integration will resolve the problem.</p>
<p>The following script will look for a REST API for no integration error:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/bin/sh</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Search Amazon API Gateway for resources that have no integration defined for</span></div><div class="line"><span class="comment"># method.</span></div><div class="line"></div><div class="line">API_NAME=example.com</div><div class="line"></div><div class="line">REST_API_ID=$(aws apigateway get-rest-apis --query=<span class="string">'items[?name==`'</span><span class="variable">$API_NAME</span><span class="string">'`].id | [0]'</span> --output=text)</div><div class="line">RESOURCES=$(aws apigateway get-resources --rest-api-id=<span class="variable">$REST_API_ID</span> --query=<span class="string">'items[*].id'</span> --output=text)</div><div class="line"></div><div class="line"><span class="keyword">for</span> resource <span class="keyword">in</span> $(<span class="built_in">echo</span> <span class="string">"<span class="variable">$RESOURCES</span>"</span>)</div><div class="line"><span class="keyword">do</span></div><div class="line">    <span class="keyword">for</span> method <span class="keyword">in</span> $(aws apigateway get-resource \</div><div class="line">        --query=<span class="string">'resourceMethods && keys(resourceMethods)'</span>  \</div><div class="line">        --output=text                                       \</div><div class="line">        --rest-api-id=<span class="variable">$REST_API_ID</span>                          \</div><div class="line">        --resource-id=<span class="variable">$resource</span>)</div><div class="line">    <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> [ <span class="string">"<span class="variable">$method</span>"</span> != <span class="string">"None"</span> ]</div><div class="line">        <span class="keyword">then</span></div><div class="line">            aws apigateway get-integration \</div><div class="line">                --rest-api-id=<span class="variable">$REST_API_ID</span>  \</div><div class="line">                --resource-id=<span class="variable">$resource</span>     \</div><div class="line">                --http-method=<span class="variable">$method</span> &gt; /dev/null</div><div class="line">            <span class="keyword">if</span> [ $? <span class="operator">-ne</span> <span class="number">0</span> ]</div><div class="line">            <span class="keyword">then</span></div><div class="line">                aws apigateway get-resource \</div><div class="line">                    --rest-api-id=<span class="variable">$REST_API_ID</span>  \</div><div class="line">                    --resource-id=<span class="variable">$resource</span></div><div class="line">            <span class="keyword">fi</span></div><div class="line">        <span class="keyword">fi</span></div><div class="line">    <span class="keyword">done</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure>

<p>References:</p>
<ul>
<li><a href="https://github.com/serverless/serverless/issues/5100" target="_blank" rel="external">https://github.com/serverless/serverless/issues/5100</a></li>
<li><a href="https://stackoverflow.com/questions/46087890/no-integration-defined-for-method-choose-a-stage-where-your-api-will-be-deploy" target="_blank" rel="external">https://stackoverflow.com/questions/46087890/no-integration-defined-for-method-choose-a-stage-where-your-api-will-be-deploy</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2018-12-05T12:00:00.000Z"><a href="/2018/12/05/jq-filter-json-array-by-value/">Dec 5, 2018</a></time>
      
      
  
    <h1 class="title"><a href="/2018/12/05/jq-filter-json-array-by-value/">jq: Filter JSON Array by Value</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Print the JSON object in an array where the object key is equal to the specified value with <a href="https://stedolan.github.io/jq/" target="_blank" rel="external">jq</a>:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">echo</span> <span class="string">'[{"key":"foo"},{"key":"bar"}]'</span> | jq <span class="string">'.[] | select(.key == "foo")'</span></div><div class="line">{</div><div class="line">  <span class="string">"key"</span>: <span class="string">"foo"</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>Reference:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ jq --version</div><div class="line">jq-<span class="number">1.5</span></div></pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-06-01T12:00:00.000Z"><a href="/2017/06/01/avoiding-dependencies-reinstall-when-building-nodejs-docker-image/">Jun 1, 2017</a></time>
      
      
  
    <h1 class="title"><a href="/2017/06/01/avoiding-dependencies-reinstall-when-building-nodejs-docker-image/">Avoiding Dependencies Reinstall When Building NodeJS Docker Image</a></h1>
  

    </header>
    <div class="entry">
      
        <p>When I first started writing <a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="external">Dockerfile</a> for building a <a href="https://nodejs.org/" target="_blank" rel="external">NodeJS</a> app, I will do:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">WORKDIR /app</div><div class="line">COPY . /app</div><div class="line">RUN npm install</div></pre></td></tr></table></figure>

<p>Sure, this is very simple, but every time a change in the source file, the entire dependency tree needs to be re-installed. The only time you need to rebuild is when <code>package.json</code> changes.</p>
<p>One trick is to move <code>package.json</code> elsewhere, and build the dependencies, then move back:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">WORKDIR /app</div><div class="line">ADD package.json /tmp</div><div class="line">RUN <span class="built_in">cd</span> /tmp && npm install</div><div class="line">COPY . /app</div><div class="line">RUN mv /tmp/node_modules /app/node_modules</div></pre></td></tr></table></figure>

<p>However, if there are a lot of depending packages with lots of files, the last step will take a long time.</p>
<p>How about using symbolic link to shorten the time?</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">WORKDIR /app</div><div class="line">ADD package.json /tmp</div><div class="line">RUN <span class="built_in">cd</span> /tmp && npm install</div><div class="line">COPY . /app</div><div class="line">RUN ln <span class="operator">-s</span> /tmp/node_modules /app/node_modules</div></pre></td></tr></table></figure>

<p>Well, it works, but not every NPM package is happy about it. Some will complain about the softlink, result in errors.</p>
<p>So, how can we reuse caches as much as possible, and:</p>
<ol>
<li>Do not need to reinstall dependencies</li>
<li>Do not use symbolic link</li>
</ol>
<p>Here is a solution, just move down the <code>COPY</code> statement:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Set the working directory, which creates the directory.</span></div><div class="line">WORKDIR /app</div><div class="line"></div><div class="line"><span class="comment"># Install dependencies.</span></div><div class="line">ADD package.json /tmp</div><div class="line">RUN <span class="built_in">cd</span> /tmp && npm install</div><div class="line"></div><div class="line"><span class="comment"># Move the dependency directory back to the app.</span></div><div class="line">RUN mv /tmp/node_modules /app</div><div class="line"></div><div class="line"><span class="comment"># Copy the content into the app directory. The previously added "node_modules"</span></div><div class="line"><span class="comment"># directory will not be overridden.</span></div><div class="line">COPY . /app</div></pre></td></tr></table></figure>

<p>With this configuration, if <code>package.json</code> stays the same, only the last cache layer will be rebuilt when source codes change.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-04-29T12:00:00.000Z"><a href="/2017/04/29/wrapping-line-by-line-json-to-an-array/">Apr 29, 2017</a></time>
      
      
  
    <h1 class="title"><a href="/2017/04/29/wrapping-line-by-line-json-to-an-array/">Wrapping Line by Line JSON to an Array</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Some utilities print out JSON data (object) line by line. Line by line JSON is not really a valid JSON format, need to wrap it in bracket as an array.</p>
<p>For example, here are a few lines of JSON objects:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ <span class="keyword">for</span> i <span class="keyword">in</span> $(seq <span class="number">3</span>); <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">'{"id":'</span><span class="variable">$i</span><span class="string">'}'</span>; <span class="keyword">done</span></div><div class="line">{<span class="string">"id"</span>:<span class="number">1</span>}</div><div class="line">{<span class="string">"id"</span>:<span class="number">2</span>}</div><div class="line">{<span class="string">"id"</span>:<span class="number">3</span>}</div></pre></td></tr></table></figure>

<p>To combine them into a single array, we can use <a href="https://stedolan.github.io/jq/" target="_blank" rel="external">jq</a>‘s <strong>-s, —slurp</strong> option:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ <span class="keyword">for</span> i <span class="keyword">in</span> $(seq <span class="number">3</span>); <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">'{"id":'</span><span class="variable">$i</span><span class="string">'}'</span>; <span class="keyword">done</span> | jq -cM <span class="operator">-s</span></div><div class="line">[{<span class="string">"id"</span>:<span class="number">1</span>},{<span class="string">"id"</span>:<span class="number">2</span>},{<span class="string">"id"</span>:<span class="number">3</span>}]</div></pre></td></tr></table></figure>

<p>The option reads the entire input stream into a large array. This is good until the input stream is too large to process, because jq is not producing output while <em>slurping</em> up the input. If the input is line by line JSON, and all you want to do is wrapping it into an array (with or even without the trailing newline), we can simply do the following:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ <span class="keyword">for</span> i <span class="keyword">in</span> $(seq <span class="number">3</span>); <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">'{"id":'</span><span class="variable">$i</span><span class="string">'}'</span>; <span class="keyword">done</span> |\</div><div class="line">  awk <span class="string">'BEGIN { printf "["; getline; printf "%s", $0 } { printf ",%s", $0 } END { print "]" }'</span></div><div class="line">[{<span class="string">"id"</span>:<span class="number">1</span>},{<span class="string">"id"</span>:<span class="number">2</span>},{<span class="string">"id"</span>:<span class="number">3</span>}]</div></pre></td></tr></table></figure>

<p>This is with the newline printed. And it will solve the problem of a very large input. Data will simply stream out as it comes it. Try it with a forever <code>while</code> loop.</p>
<p>There is another option in jq named <strong>—stream</strong>, and it seems to be doing the same. But option <strong>—slurp</strong> overrides <strong>—stream</strong>, and the option itself is already so complicated.</p>
<p>In conclusion, you can use <code>jq -s</code> to wrap line by line JSON into an array. If you want to be safe, just use the awk example above.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-01-14T12:00:00.000Z"><a href="/2017/01/14/gitignore-excluding-everything-except-a-specific-directory/">Jan 14, 2017</a></time>
      
      
  
    <h1 class="title"><a href="/2017/01/14/gitignore-excluding-everything-except-a-specific-directory/">Gitignore: Excluding Everything Except a Specific Directory</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I have the following directory structure:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$ tree -aF src/</div><div class="line">src/</div><div class="line">├── github.<span class="keyword">com</span>/</div><div class="line">│   ├── git/</div><div class="line">│   │   └── git/</div><div class="line">│   │       └── <span class="keyword">file</span></div><div class="line">│   └── realguess/</div><div class="line">│       ├── git/</div><div class="line">│       │   └── <span class="keyword">file</span></div><div class="line">│       └── hello/</div><div class="line">│           └── hello.<span class="keyword">go</span></div><div class="line">└── .gitignore</div><div class="line"></div><div class="line"><span class="number">6</span> directories, <span class="number">4</span> <span class="keyword">files</span></div></pre></td></tr></table></figure>

<p>My intention is to keep the projects in <code>src/github.com/realguess/</code> only. So, I have added the following gitignore file:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ <span class="keyword">cat</span> src/.gitignore</div><div class="line">/github.<span class="keyword">com</span>/</div><div class="line">!/github.<span class="keyword">com</span>/realguess/</div></pre></td></tr></table></figure>

<p>But the directory is ignored:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>git check-ignore -v github.com/realguess/</div><div class="line">src/.<span class="symbol">gitignore:</span><span class="number">1</span><span class="symbol">:/github</span>.com/      github.com/realguess/</div></pre></td></tr></table></figure>

<blockquote>
<p><strong>It is not possible to re-include a file if a parent directory of that file is excluded.</strong> Git doesn’t list excluded directories for performance reasons, so any patterns on contained files have no effect, no matter where they are defined.[^1]</p>
</blockquote>
<p>Uh-oh! The directory <code>github.com/</code> is excluded. Therefore, it is <em>not possible to re-include a file</em> <code>github.com/realguess</code> (directory is a file). To fix it, just need to add the wildcard to the end of the parent directory:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ <span class="keyword">cat</span> src/.gitignore</div><div class="line">/github.<span class="keyword">com</span>/*</div><div class="line">!/github.<span class="keyword">com</span>/realguess/</div></pre></td></tr></table></figure>

<p>By adding the wildcard character, it matches every file (including hidden ones) or directory under <code>github.com/</code> directory, the directory itself as the parent of <code>github.com/realguess/</code> is not excluded. Then, we use the negation pattern to re-include <code>github.com/realguess/</code>.</p>
<p>Double check it:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git <span class="operator"><span class="keyword">check</span>-<span class="keyword">ignore</span> -v github.com/realguess/</span></div><div class="line"><span class="number">1</span></div></pre></td></tr></table></figure>

<p>The debugging command returns non-zero status code, which indicates that the directory is not ignored.</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2017/01/14/gitignore-excluding-everything-except-a-specific-directory/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-12-30T12:00:00.000Z"><a href="/2016/12/30/registering-a-domain-with-amazon-route-53-via-cli/">Dec 30, 2016</a></time>
      
      
  
    <h1 class="title"><a href="/2016/12/30/registering-a-domain-with-amazon-route-53-via-cli/">Registering a Domain with Amazon Route 53 via CLI</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Register a domain with <a href="https://aws.amazon.com/route53/" target="_blank" rel="external">Amazon Route 53</a> via CLI is very straightforward, the only complicate thing is to generate the acceptable JSON structure, then somehow enter the JSON string in the command line without meddling from the shell.</p>
<p>The command is:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>aws route53domains register-domain</div></pre></td></tr></table></figure>

<p>The documentation can be found from the <a href="https://docs.aws.amazon.com/cli/latest/reference/route53domains/register-domain.html" target="_blank" rel="external">AWS CLI Command Reference</a> or issuing:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ aws route53domains register-domain <span class="built_in">help</span></div></pre></td></tr></table></figure>

<p>Most the command line options require simple string values, but some options like <code>--admin-contact</code> requires a structure data, which is complex to enter in the command line. The easiest way is to forget all other options and use <code>--cli-input-json</code> to get everything in JSON.</p>
<p>First let’s generate the skeleton or template to use:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ aws route53domains register-domain --generate-cli-skeleton</div></pre></td></tr></table></figure>

<p>That should output something like:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line">    "<span class="attribute">DomainName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">    "<span class="attribute">IdnLangCode</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">    "<span class="attribute">DurationInYears</span>": <span class="value"><span class="number">0</span></span>,</div><div class="line">    "<span class="attribute">AutoRenew</span>": <span class="value"><span class="literal">true</span></span>,</div><div class="line">    "<span class="attribute">AdminContact</span>": <span class="value">{</span></div><div class="line">        "<span class="attribute">FirstName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">LastName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">ContactType</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">OrganizationName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">AddressLine1</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">AddressLine2</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">City</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">State</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">CountryCode</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">ZipCode</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">PhoneNumber</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">Email</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">Fax</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">ExtraParams</span>": <span class="value">[</span></div><div class="line">            {</div><div class="line">                "<span class="attribute">Name</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">                "<span class="attribute">Value</span>": <span class="value"><span class="string">""</span></span></div><div class="line">            }</div><div class="line">        ]</div><div class="line">    },</div><div class="line">    "<span class="attribute">RegistrantContact</span>": <span class="value">{</span></div><div class="line">        "<span class="attribute">FirstName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">LastName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">ContactType</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">OrganizationName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">AddressLine1</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">AddressLine2</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">City</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">State</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">CountryCode</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">ZipCode</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">PhoneNumber</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">Email</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">Fax</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">ExtraParams</span>": <span class="value">[</span></div><div class="line">            {</div><div class="line">                "<span class="attribute">Name</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">                "<span class="attribute">Value</span>": <span class="value"><span class="string">""</span></span></div><div class="line">            }</div><div class="line">        ]</div><div class="line">    },</div><div class="line">    "<span class="attribute">TechContact</span>": <span class="value">{</span></div><div class="line">        "<span class="attribute">FirstName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">LastName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">ContactType</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">OrganizationName</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">AddressLine1</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">AddressLine2</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">City</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">State</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">CountryCode</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">ZipCode</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">PhoneNumber</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">Email</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">Fax</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">        "<span class="attribute">ExtraParams</span>": <span class="value">[</span></div><div class="line">            {</div><div class="line">                "<span class="attribute">Name</span>": <span class="value"><span class="string">""</span></span>,</div><div class="line">                "<span class="attribute">Value</span>": <span class="value"><span class="string">""</span></span></div><div class="line">            }</div><div class="line">        ]</div><div class="line">    },</div><div class="line">    "<span class="attribute">PrivacyProtectAdminContact</span>": <span class="value"><span class="literal">true</span></span>,</div><div class="line">    "<span class="attribute">PrivacyProtectRegistrantContact</span>": <span class="value"><span class="literal">true</span></span>,</div><div class="line">    "<span class="attribute">PrivacyProtectTechContact</span>": <span class="value"><span class="literal">true</span></span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>Fill in the fields, leave out the ones not needed:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">{</div><div class="line">    "<span class="attribute">DomainName</span>": <span class="value"><span class="string">"example.com"</span></span>,</div><div class="line">    "<span class="attribute">DurationInYears</span>": <span class="value"><span class="number">1</span></span>,</div><div class="line">    "<span class="attribute">AutoRenew</span>": <span class="value"><span class="literal">true</span></span>,</div><div class="line">    "<span class="attribute">AdminContact</span>": <span class="value">{</span></div><div class="line">        "<span class="attribute">FirstName</span>": <span class="value"><span class="string">"Joe"</span></span>,</div><div class="line">        "<span class="attribute">LastName</span>": <span class="value"><span class="string">"Doe"</span></span>,</div><div class="line">        "<span class="attribute">ContactType</span>": <span class="value"><span class="string">"PERSON"</span></span>,</div><div class="line">        "<span class="attribute">AddressLine1</span>": <span class="value"><span class="string">"101 Main St"</span></span>,</div><div class="line">        "<span class="attribute">City</span>": <span class="value"><span class="string">"New York"</span></span>,</div><div class="line">        "<span class="attribute">State</span>": <span class="value"><span class="string">"NY"</span></span>,</div><div class="line">        "<span class="attribute">CountryCode</span>": <span class="value"><span class="string">"US"</span></span>,</div><div class="line">        "<span class="attribute">ZipCode</span>": <span class="value"><span class="string">"10001"</span></span>,</div><div class="line">        "<span class="attribute">PhoneNumber</span>": <span class="value"><span class="string">"+1.8888888888"</span></span>,</div><div class="line">        "<span class="attribute">Email</span>": <span class="value"><span class="string">"joe.doe@example.com"</span></span></div><div class="line">    },</div><div class="line">    "<span class="attribute">RegistrantContact</span>": <span class="value">{</span></div><div class="line">        "<span class="attribute">FirstName</span>": <span class="value"><span class="string">"Joe"</span></span>,</div><div class="line">        "<span class="attribute">LastName</span>": <span class="value"><span class="string">"Doe"</span></span>,</div><div class="line">        "<span class="attribute">ContactType</span>": <span class="value"><span class="string">"PERSON"</span></span>,</div><div class="line">        "<span class="attribute">AddressLine1</span>": <span class="value"><span class="string">"101 Main St"</span></span>,</div><div class="line">        "<span class="attribute">City</span>": <span class="value"><span class="string">"New York"</span></span>,</div><div class="line">        "<span class="attribute">State</span>": <span class="value"><span class="string">"NY"</span></span>,</div><div class="line">        "<span class="attribute">CountryCode</span>": <span class="value"><span class="string">"US"</span></span>,</div><div class="line">        "<span class="attribute">ZipCode</span>": <span class="value"><span class="string">"10001"</span></span>,</div><div class="line">        "<span class="attribute">PhoneNumber</span>": <span class="value"><span class="string">"+1.8888888888"</span></span>,</div><div class="line">        "<span class="attribute">Email</span>": <span class="value"><span class="string">"joe.doe@example.com"</span></span></div><div class="line">    },</div><div class="line">    "<span class="attribute">TechContact</span>": <span class="value">{</span></div><div class="line">        "<span class="attribute">FirstName</span>": <span class="value"><span class="string">"Joe"</span></span>,</div><div class="line">        "<span class="attribute">LastName</span>": <span class="value"><span class="string">"Doe"</span></span>,</div><div class="line">        "<span class="attribute">ContactType</span>": <span class="value"><span class="string">"PERSON"</span></span>,</div><div class="line">        "<span class="attribute">AddressLine1</span>": <span class="value"><span class="string">"101 Main St"</span></span>,</div><div class="line">        "<span class="attribute">City</span>": <span class="value"><span class="string">"New York"</span></span>,</div><div class="line">        "<span class="attribute">State</span>": <span class="value"><span class="string">"NY"</span></span>,</div><div class="line">        "<span class="attribute">CountryCode</span>": <span class="value"><span class="string">"US"</span></span>,</div><div class="line">        "<span class="attribute">ZipCode</span>": <span class="value"><span class="string">"10001"</span></span>,</div><div class="line">        "<span class="attribute">PhoneNumber</span>": <span class="value"><span class="string">"+1.8888888888"</span></span>,</div><div class="line">        "<span class="attribute">Email</span>": <span class="value"><span class="string">"joe.doe@example.com"</span></span></div><div class="line">    },</div><div class="line">    "<span class="attribute">PrivacyProtectAdminContact</span>": <span class="value"><span class="literal">true</span></span>,</div><div class="line">    "<span class="attribute">PrivacyProtectRegistrantContact</span>": <span class="value"><span class="literal">true</span></span>,</div><div class="line">    "<span class="attribute">PrivacyProtectTechContact</span>": <span class="value"><span class="literal">true</span></span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>Now let’s register by running through <a href="https://stedolan.github.io/jq/" target="_blank" rel="external">jq</a> to clean up extra blanks and end of line characters, and then pipe to <code>xargs</code> command by using new line character as the delimiter instead of a blank by default:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ cat input.json | jq -cM . | \</div><div class="line">  xargs <span class="operator">-d</span> <span class="string">'\n'</span> aws route53domains register-domain --cli-input-json</div><div class="line">{</div><div class="line">    <span class="string">"OperationId"</span>: <span class="string">"00000000-0000-0000-0000-00000000000"</span></div><div class="line">}</div></pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2016/12/30/registering-a-domain-with-amazon-route-53-via-cli/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-12-07T12:00:00.000Z"><a href="/2016/12/07/dockerizing-redmine/">Dec 7, 2016</a></time>
      
      
  
    <h1 class="title"><a href="/2016/12/07/dockerizing-redmine/">Dockerizing Redmine</a></h1>
  

    </header>
    <div class="entry">
      
        <p>Migrate an existing <a href="https://redmine.org/" target="_blank" rel="external">Redmine</a> application into a <a href="https://www.docker.com/" target="_blank" rel="external">Docker</a> based container. There are two main steps:</p>
<ol>
<li>Migrate MySQL database</li>
<li>Migrate Redmine application</li>
</ol>
<h1 id="MySQL">MySQL</h1>
<p>Create an archive from the source data directory, where data to be migrated:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">sudo</span> tar -C /var/lib/mysql -czf ~/mysql.tar.gz .</div></pre></td></tr></table></figure>

<p>The directory <code>/var/lib/mysql</code> is the default location where all database related data are stored.</p>
<p>Download the archive:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ scp example.com:~/mysql.tar.gz .</div></pre></td></tr></table></figure>

<p>Extract to the directory where we will map the host volume to the guest:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">sudo</span> mkdir -p /srv/mysql && <span class="built_in">sudo</span> tar -C <span class="variable">$_</span> -xzf mysql.tar.gz</div></pre></td></tr></table></figure>

<p>Download the latest (<code>5.7.16</code> <strong>make sure it is the latest, because <code>8.x</code> branch might not work</strong>) <a href="https://hub.docker.com/_/mysql/" target="_blank" rel="external">MySQL Docker image</a>:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker pull mysql && docker pull mysql:<span class="number">5.7</span>.<span class="number">16</span></div></pre></td></tr></table></figure>

<p>Run a MySQL container with the data directory mounted from the host:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ docker run                         \</div><div class="line">  --detach                           \</div><div class="line">  --name mysql                       \</div><div class="line">  --restart always                   \</div><div class="line">  --volume /srv/mysql:/var/lib/mysql \</div><div class="line">  mysql</div></pre></td></tr></table></figure>

<p>Environment variables (<code>MYSQL_ROOT_PASSWORD</code>, <code>MYSQL_DATABASE</code>, <code>MYSQL_USER</code>, or <code>MYSQL_PASSWORD</code>) become unnecessary:</p>
<blockquote>
<p>Do note that none of the variables below will have any effect if you start the container with a data directory that already contains a database: any pre-existing database will always be left untouched on container startup.[^1]</p>
</blockquote>
<p>Now I should be able to access my existing database:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">$ docker exec -it mysql sh -c 'mysql -uredmine -p redmine'</div><div class="line">Enter password:</div><div class="line">Reading table information for completion of table and column names</div><div class="line">You can turn off this feature to get a quicker startup with -A</div><div class="line"></div><div class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 5</div><div class="line">Server version: 5.7.16 MySQL Community Server (GPL)</div><div class="line"></div><div class="line">Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.</div><div class="line"></div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line"></div><div class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</div><div class="line"></div><div class="line">mysql></div></pre></td></tr></table></figure>

<p>But when accessing MySQL database from another host, we have to update the permissions. Let’s log into MySQL with <code>root</code> user:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker <span class="keyword">exec</span> -it mysql sh -c <span class="string">'mysql -uroot -p mysql'</span></div></pre></td></tr></table></figure>

<p>Issue SQL commands:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT Host, User FROM db WHERE Db='redmine';</div><div class="line">+-----------+---------+</div><div class="line">| Host      | User    |</div><div class="line">+-----------+---------+</div><div class="line">| localhost | redmine |</div><div class="line">+-----------+---------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; SELECT Host, User FROM user WHERE User='redmine';</div><div class="line">+-----------+---------+</div><div class="line">| host      | user    |</div><div class="line">+-----------+---------+</div><div class="line">| localhost | redmine |</div><div class="line">+-----------+---------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure>

<p>Only <code>localhost</code> is allowed for both the database and the user. This is problematic. How does one know the host of the container yet to be created? The easiest way is to allow access from all hosts:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; UPDATE db SET Host='%' WHERE Db='redmine';</div><div class="line">Query OK, 1 row affected (0.01 sec)</div><div class="line">Rows matched: 1  Changed: 1  Warnings: 0</div><div class="line"></div><div class="line">mysql&gt; UPDATE user SET Host='%' WHERE User='redmine';</div><div class="line">Query OK, 1 row affected (0.00 sec)</div><div class="line">Rows matched: 1  Changed: 1  Warnings: 0</div></pre></td></tr></table></figure>

<p>We can restrict to a set of IP addresses such as <code>172.17.0.%</code> or sub domains <code>%.example.com</code>. Docker networking uses <code>172.17.0.x</code> range.</p>
<p>The better way is that when linking containers, should be able to update <code>mysql</code> container <code>/etc/hosts</code> file to include a <code>redmine</code> container field. Then, a wild card is not necessary.</p>
<p>But having to allow all hosts to connect is fine, because all hosts do not mean <em>all hosts</em>. The port is not bind or map to any open port in the host machine. Only the host (<code>172.17.0.1</code>) and other Docker containers inside the host can discover the service provided. Other machines or containers outside the host is not able to access at all.</p>
<p>Restart the container to have the update taking effect:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker restart mysql</div></pre></td></tr></table></figure>

<h1 id="Redmine">Redmine</h1>
<p>For a basic Redmine setup, there aren’t much to migrate, mainly just three directories, <code>config</code>, <code>files</code>, and <code>log</code>, others are application data. Configuration could be done via environment variables, and if logs weren’t important to migrate, we just need to move the <code>files</code> directory, which is used for file upload.</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2016/12/07/dockerizing-redmine/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-10-11T12:00:00.000Z"><a href="/2016/10/11/a-cli-method-to-check-ssl-certificate-expiration-date/">Oct 11, 2016</a></time>
      
      
  
    <h1 class="title"><a href="/2016/10/11/a-cli-method-to-check-ssl-certificate-expiration-date/">A CLI Method to Check SSL Certificate Expiration Date</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I know that browser does this automatically, but it might come in handy if you need to check the expiration date of a SSL certificate through CLI. The key is <code>openssl</code>, OpenSSL command line tool.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ echo | openssl s_client -connect example.com:443 2> /dev/null | \</div><div class="line">  openssl x509 -noout -enddate</div><div class="line">notAfter=Nov 28 12:00:00 2018 GMT</div></pre></td></tr></table></figure>

<p>The command is consisted of two parts:</p>
<ul>
<li>Retrieve SSL certificate from the server</li>
<li>Extract the expiration date data</li>
</ul>
<blockquote>
<p>The openssl program is a command line tool for using the various cryptography functions of OpenSSL’s crypto library from the shell. It can be used for[^1]</p>
<ul>
<li>Creation and management of private keys, public keys and parameters</li>
<li>Public key cryptographic operations</li>
<li>Creation of X.509 certificates, CSRs and CRLs</li>
<li>Calculation of Message Digests</li>
<li>Encryption and Decryption with Ciphers</li>
<li>SSL/TLS Client and Server Tests</li>
<li>Handling of S/MIME signed or encrypted mail</li>
<li>Time Stamp requests, generation and verification</li>
</ul>
</blockquote>
<p>What we need here is to perform <em>SSL/TLS Client and Server Tests</em>.</p>
<p><code>s_client</code> is one of the standard commands of <code>openssl</code> command line tool:</p>
<blockquote>
<p>This implements a generic SSL/TLS client which can establish a transparent connection to a remote server speaking SSL/TLS. It’s intended for testing purposes only and provides only rudimentary interface functionality but internally uses mostly all functionality of the OpenSSL ssl library.[^1]</p>
</blockquote>
<p>Dig deeper into <code>s_client</code> command:</p>
<blockquote>
<p>The s_client command implements a generic SSL/TLS client which connects to a remote host using SSL/TLS. It is a very useful diagnostic tool for SSL servers.[^2]</p>
</blockquote>
<p>Option <code>-connect host:port</code>:</p>
<blockquote>
<p>This specifies the host and optional port to connect to. If not specified then an attempt is made to connect to the local host on port 4433.[^2]</p>
</blockquote>
<p>And the format is:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ openssl s_client -connect servername:<span class="number">443</span> &gt; data</div></pre></td></tr></table></figure>

<p>If a connection is established, <code>openssl</code> enters interactive mode:</p>
<blockquote>
<p>If a connection is established with an SSL server then any data received from the server is displayed and any key presses will be sent to the server. When used interactively (which means neither <code>-quiet</code> nor <code>-ign_eof</code> have been given), the session will be renegotiated if the line begins with an R, and if the line begins with a Q or if end of file is reached, the connection will be closed down.[^2]</p>
</blockquote>
<p>To quit, type <code>Q</code> or <code>&lt;ctr&gt;+d</code> (EOF).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ openssl s_client -connect example.com:443 > /tmp/example.com</div><div class="line">depth=1 C = US, O = DigiCert Inc, OU = www.digicert.com, CN = DigiCert SHA2 High Assurance</div><div class="line"> Server CA</div><div class="line">verify error:num=20:unable to get local issuer certificate</div><div class="line">verify return:0</div><div class="line">Q</div><div class="line">DONE</div></pre></td></tr></table></figure>

<p>Dump the session data:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line">$ cat /tmp/example.com</div><div class="line">CONNECTED(00000003)</div><div class="line">---</div><div class="line">Certificate chain</div><div class="line"> 0 s:/C=US/ST=California/L=Los Angeles/O=Internet Corporation for Assigned Names and Numbers/OU=Technology/CN=www.example.org</div><div class="line">   i:/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=DigiCert SHA2 High Assurance Server CA</div><div class="line"> 1 s:/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=DigiCert SHA2 High Assurance Server CA</div><div class="line">   i:/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=DigiCert High Assurance EV Root CA</div><div class="line">---</div><div class="line">Server certificate</div><div class="line">-----BEGIN CERTIFICATE-----</div><div class="line">MIIF8jCCBNqgAwIBAgIQDmTF+8I2reFLFyrrQceMsDANBgkqhkiG9w0BAQsFADBw</div><div class="line">MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3</div><div class="line">d3cuZGlnaWNlcnQuY29tMS8wLQYDVQQDEyZEaWdpQ2VydCBTSEEyIEhpZ2ggQXNz</div><div class="line">dXJhbmNlIFNlcnZlciBDQTAeFw0xNTExMDMwMDAwMDBaFw0xODExMjgxMjAwMDBa</div><div class="line">MIGlMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEUMBIGA1UEBxML</div><div class="line">TG9zIEFuZ2VsZXMxPDA6BgNVBAoTM0ludGVybmV0IENvcnBvcmF0aW9uIGZvciBB</div><div class="line">c3NpZ25lZCBOYW1lcyBhbmQgTnVtYmVyczETMBEGA1UECxMKVGVjaG5vbG9neTEY</div><div class="line">MBYGA1UEAxMPd3d3LmV4YW1wbGUub3JnMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A</div><div class="line">MIIBCgKCAQEAs0CWL2FjPiXBl61lRfvvE0KzLJmG9LWAC3bcBjgsH6NiVVo2dt6u</div><div class="line">Xfzi5bTm7F3K7srfUBYkLO78mraM9qizrHoIeyofrV/n+pZZJauQsPjCPxMEJnRo</div><div class="line">D8Z4KpWKX0LyDu1SputoI4nlQ/htEhtiQnuoBfNZxF7WxcxGwEsZuS1KcXIkHl5V</div><div class="line">RJOreKFHTaXcB1qcZ/QRaBIv0yhxvK1yBTwWddT4cli6GfHcCe3xGMaSL328Fgs3</div><div class="line">jYrvG29PueB6VJi/tbbPu6qTfwp/H1brqdjh29U52Bhb0fJkM9DWxCP/Cattcc7a</div><div class="line">z8EXnCO+LK8vkhw/kAiJWPKx4RBvgy73nwIDAQABo4ICUDCCAkwwHwYDVR0jBBgw</div><div class="line">FoAUUWj/kK8CB3U8zNllZGKiErhZcjswHQYDVR0OBBYEFKZPYB4fLdHn8SOgKpUW</div><div class="line">5Oia6m5IMIGBBgNVHREEejB4gg93d3cuZXhhbXBsZS5vcmeCC2V4YW1wbGUuY29t</div><div class="line">ggtleGFtcGxlLmVkdYILZXhhbXBsZS5uZXSCC2V4YW1wbGUub3Jngg93d3cuZXhh</div><div class="line">bXBsZS5jb22CD3d3dy5leGFtcGxlLmVkdYIPd3d3LmV4YW1wbGUubmV0MA4GA1Ud</div><div class="line">DwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwdQYDVR0f</div><div class="line">BG4wbDA0oDKgMIYuaHR0cDovL2NybDMuZGlnaWNlcnQuY29tL3NoYTItaGEtc2Vy</div><div class="line">dmVyLWc0LmNybDA0oDKgMIYuaHR0cDovL2NybDQuZGlnaWNlcnQuY29tL3NoYTIt</div><div class="line">aGEtc2VydmVyLWc0LmNybDBMBgNVHSAERTBDMDcGCWCGSAGG/WwBATAqMCgGCCsG</div><div class="line">AQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20vQ1BTMAgGBmeBDAECAjCB</div><div class="line">gwYIKwYBBQUHAQEEdzB1MCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5kaWdpY2Vy</div><div class="line">dC5jb20wTQYIKwYBBQUHMAKGQWh0dHA6Ly9jYWNlcnRzLmRpZ2ljZXJ0LmNvbS9E</div><div class="line">aWdpQ2VydFNIQTJIaWdoQXNzdXJhbmNlU2VydmVyQ0EuY3J0MAwGA1UdEwEB/wQC</div><div class="line">MAAwDQYJKoZIhvcNAQELBQADggEBAISomhGn2L0LJn5SJHuyVZ3qMIlRCIdvqe0Q</div><div class="line">6ls+C8ctRwRO3UU3x8q8OH+2ahxlQmpzdC5al4XQzJLiLjiJ2Q1p+hub8MFiMmVP</div><div class="line">PZjb2tZm2ipWVuMRM+zgpRVM6nVJ9F3vFfUSHOb4/JsEIUvPY+d8/Krc+kPQwLvy</div><div class="line">ieqRbcuFjmqfyPmUv1U9QoI4TQikpw7TZU0zYZANP4C/gj4Ry48/znmUaRvy2kvI</div><div class="line">l7gRQ21qJTK5suoiYoYNo3J9T+pXPGU7Lydz/HwW+w0DpArtAaukI8aNX4ohFUKS</div><div class="line">wDSiIIWIWJiJGbEeIO0TIFwEVWTOnbNl/faPXpk5IRXicapqiII=</div><div class="line">-----END CERTIFICATE-----</div><div class="line">subject=/C=US/ST=California/L=Los Angeles/O=Internet Corporation for Assigned Names and Numbers/OU=Technology/CN=www.example.org</div><div class="line">issuer=/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=DigiCert SHA2 High Assurance Server CA ---</div><div class="line">No client certificate CA names sent</div><div class="line">---</div><div class="line">SSL handshake has read 3393 bytes and written 421 bytes</div><div class="line">---</div><div class="line">New, TLSv1/SSLv3, Cipher is ECDHE-RSA-AES128-GCM-SHA256</div><div class="line">Server public key is 2048 bit</div><div class="line">Secure Renegotiation IS supported</div><div class="line">Compression: NONE</div><div class="line">Expansion: NONE</div><div class="line">SSL-Session:</div><div class="line">    Protocol  : TLSv1.2</div><div class="line">    Cipher    : ECDHE-RSA-AES128-GCM-SHA256</div><div class="line">    Session-ID: C828441A824CE7B0F6A74BBE890AB23727445EAE8521E19F438E679C39E969B1</div><div class="line">    Session-ID-ctx:</div><div class="line">    Master-Key: 38BE4F754FBCB5F41650AD91AA5588ACD88B75D7939487052D9FD2790476E7C6D2512A6451A3FC102958488BF173CB54</div><div class="line">    Key-Arg   : None</div><div class="line">    PSK identity: None</div><div class="line">    PSK identity hint: None</div><div class="line">    SRP username: None</div><div class="line">    TLS session ticket lifetime hint: 300 (seconds)</div><div class="line">    TLS session ticket:</div><div class="line">    0000 - 83 70 c4 28 23 ee 9c 9e-87 1b 96 bf 44 76 ee d3   .p.(#.......Dv..</div><div class="line">    0010 - 45 c9 be ee a5 c5 42 49-c9 08 35 10 ba 79 03 b4   E.....BI..5..y..</div><div class="line">    0020 - 46 99 9a f2 d3 7b b5 f2-ad 9e 10 5c 7a 61 c3 0e   F....{.....\za..</div><div class="line">    0030 - e0 09 aa 7a 5e 2a 2e bb-42 6a 08 18 16 ae 56 66   ...z^*..Bj....Vf</div><div class="line">    0040 - 11 0c 96 1a 4a 20 9f 50-6d f7 e2 53 00 75 6f 07   ....J .Pm..S.uo.</div><div class="line">    0050 - 7f 94 bf 4a 5f e1 f6 3b-d5 b7 6c 11 bc 33 7b 10   ...J_..;..l..3{.</div><div class="line">    0060 - 78 e3 81 a0 0b 83 25 d6-e6 a5 64 90 59 24 a6 e9   x.....%...d.Y$..</div><div class="line">    0070 - 9b b6 4b be 9e 42 1b 03-e0 d7 76 e9 32 87 3e 0d   ..K..B....v.2.>.</div><div class="line">    0080 - 3d 09 09 32 18 fd 04 63-93 fe 33 9f 47 50 d4 c1   =..2...c..3.GP..</div><div class="line">    0090 - e1 a9 21 cc 67 30 ea 03-7f c1 ee 2a 54 02 c8 11   ..!.g0.....*T...</div><div class="line"></div><div class="line">    Start Time: 1475971200</div><div class="line">    Timeout   : 300 (sec)</div><div class="line">    Verify return code: 20 (unable to get local issuer certificate)</div><div class="line">---</div></pre></td></tr></table></figure>

<p>To avoid the interactive mode, we can pipe an empty string into the command:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ echo | openssl s_client -connect example.com:443 > /tmp/example.com 2> /dev/null</div></pre></td></tr></table></figure>

<p>Now we have retrieved the SSL certificate from the server. Next, extract the expiration date. This is done by using the standard command <code>x509</code>:</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2016/10/11/a-cli-method-to-check-ssl-certificate-expiration-date/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-10-09T12:00:00.000Z"><a href="/2016/10/09/renewing-let-s-encrypt-ssl-certificate-with-docker/">Oct 9, 2016</a></time>
      
      
  
    <h1 class="title"><a href="/2016/10/09/renewing-let-s-encrypt-ssl-certificate-with-docker/">Renewing Let&#39;s Encrypt SSL Certificate with Docker</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://letsencrypt.org/" target="_blank" rel="external">Let’s Encrypt CA</a> issues short-lived certificates (90 days). Automated renewal process is preferred, recommended, and encouraged. But in a few situations, automated process is not available, here is how to do it manually when <a href="https://realguess.net/2016/10/09/getting-let-s-encrypt-ssl-certificate-with-docker/" target="_blank" rel="external">SSL certificate was installed with Docker</a>:</p>
<p>First, update the container to the latest version. The latest version can be found from the <a href="https://github.com/certbot/certbot/releases" target="_blank" rel="external">release page</a> in GitHub.</p>
<p>The latest is <code>v0.9.1</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker pull quay.io/letsencrypt/letsencrypt:v0.9.1</div></pre></td></tr></table></figure>

<p>Turn off application (if running as a Docker container) to free up the HTTPS port 443:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker stop app</div></pre></td></tr></table></figure>

<p>Renew the certificate by issuing <code>renew</code> command:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">$ docker run -it --rm -p 443:443 --name certbot \</div><div class="line">  -v /etc/letsencrypt:/etc/letsencrypt          \</div><div class="line">  -v /var/log/letsencrypt:/var/log/letsencrypt  \</div><div class="line">  quay.io/letsencrypt/letsencrypt:v0.9.1 renew</div><div class="line">Saving debug log to /var/log/letsencrypt/letsencrypt.log</div><div class="line"></div><div class="line">-------------------------------------------------------------------------------</div><div class="line">Processing /etc/letsencrypt/renewal/example.com.conf</div><div class="line">-------------------------------------------------------------------------------</div><div class="line">Cert is due for renewal, auto-renewing...</div><div class="line">Starting new HTTPS connection (1): acme-v01.api.letsencrypt.org</div><div class="line">Renewing an existing certificate</div><div class="line">Performing the following challenges:</div><div class="line">tls-sni-01 challenge for example.com</div><div class="line">Waiting for verification...</div><div class="line">Cleaning up challenges</div><div class="line">Generating key (2048 bits): /etc/letsencrypt/keys/0001_key-certbot.pem</div><div class="line">Creating CSR: /etc/letsencrypt/csr/0001_csr-certbot.pem</div><div class="line"></div><div class="line">-------------------------------------------------------------------------------</div><div class="line">new certificate deployed without reload, fullchain is</div><div class="line">/etc/letsencrypt/live/example.com/fullchain.pem</div><div class="line">-------------------------------------------------------------------------------</div><div class="line"></div><div class="line">Congratulations, all renewals succeeded. The following certs have been renewed:</div><div class="line">  /etc/letsencrypt/live/example.com/fullchain.pem (success)</div></pre></td></tr></table></figure>

<p>Restart app (it’s <code>start</code> not <code>restart</code>):</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker start app</div></pre></td></tr></table></figure>

<p>Check the expiration date:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ echo | openssl s_client -connect example.com:443 2> /dev/null | \</div><div class="line">  openssl x509 -noout -dates</div><div class="line">notBefore=Oct  9 12:00:00 2016 GMT</div><div class="line">notAfter=Jan  7 12:00:00 2017 GMT</div></pre></td></tr></table></figure>

<p>For more information on renewing, see the <a href="https://certbot.eff.org/docs/using.html#renewing-certificates" target="_blank" rel="external">Renewing Certificates</a> section from the Certbot documentation.</p>
<p>Settings:</p>
<ul>
<li>Certbot v0.9.1</li>
<li>Docker v1.12.1</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-10-09T12:00:00.000Z"><a href="/2016/10/09/getting-let-s-encrypt-ssl-certificate-with-docker/">Oct 9, 2016</a></time>
      
      
  
    <h1 class="title"><a href="/2016/10/09/getting-let-s-encrypt-ssl-certificate-with-docker/">Getting Let&#39;s Encrypt SSL Certificate with Docker</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://letsencrypt.org/" target="_blank" rel="external">Let’s Encrypt</a> is a free, open, and automated certificate authority (CA). And its <a href="https://certbot.eff.org/" target="_blank" rel="external">Certbot</a> is a fully-featured, extensible client for Let’s Encrypt CA that can automate the tasks of getting, renewing and even installing SSL certificates.</p>
<p>First, you need to get Certbot. There are a few ways to <a href="https://certbot.eff.org/docs/using.html" target="_blank" rel="external">install Certbot</a>. But with <a href="https://docker.com/" target="_blank" rel="external">Docker</a>, you don’t need to install, you just need to download the <a href="https://quay.io/repository/letsencrypt/letsencrypt" target="_blank" rel="external">Docker image</a> and run the container. However, the caveat is that this method does not <em>install</em> the certificate automatically respecting to your web server. But if you’re like me, running your server in another Docker container, this might be the way to go.</p>
<p>Let’s start.</p>
<p>First, download the image. You can download the <code>latest</code> version (tag):</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker pull quay.io/letsencrypt/letsencrypt:latest</div></pre></td></tr></table></figure>

<p>But the latest usually is not a stable release:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ docker run -it --rm quay.io/letsencrypt/letsencrypt:latest --version</div><div class="line">certbot 0.10.0.dev0</div></pre></td></tr></table></figure>

<p>Therefore, it’s better to use a specific release, which can be found in Certbot’s GitHub page: <a href="https://github.com/certbot/certbot/releases" target="_blank" rel="external">https://github.com/certbot/certbot/releases</a>.</p>
<p>The latest one now is <code>v0.9.1</code>. We can pull that from Quay.io:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker pull quay.io/letsencrypt/letsencrypt:v0.<span class="number">9.1</span></div></pre></td></tr></table></figure>

<p>Confirm the release version:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ docker run -it --rm quay.io/letsencrypt/letsencrypt:v0.9.1 --version</div><div class="line">certbot 0.9.1</div></pre></td></tr></table></figure>

<p>Let’s take a look at the Docker image:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ docker inspect quay.io/letsencrypt/letsencrypt:v0.<span class="number">9.1</span></div></pre></td></tr></table></figure>

<p>Dropping things don’t care, the output is:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">    {</div><div class="line">        "<span class="attribute">RepoTags</span>": <span class="value">[</span></div><div class="line">            <span class="string">"quay.io/letsencrypt/letsencrypt:v0.9.1"</span></div><div class="line">        ],</div><div class="line">        "<span class="attribute">ContainerConfig</span>": <span class="value">{</span></div><div class="line">            "<span class="attribute">ExposedPorts</span>": <span class="value">{</span></div><div class="line">                "<span class="attribute">443/tcp</span>": <span class="value">{}</span></div><div class="line">            },</div><div class="line">            "<span class="attribute">Cmd</span>": <span class="value">[</span></div><div class="line">                <span class="string">"/bin/sh"</span>,</div><div class="line">                <span class="string">"-c"</span>,</div><div class="line">                <span class="string">"#(nop) ENTRYPOINT \u0026{[\"certbot\"]}"</span></div><div class="line">            ],</div><div class="line">            "<span class="attribute">Volumes</span>": <span class="value">{</span></div><div class="line">                "<span class="attribute">/etc/letsencrypt</span>": <span class="value">{}</span>,</div><div class="line">                "<span class="attribute">/var/lib/letsencrypt</span>": <span class="value">{}</span></div><div class="line">            },</div><div class="line">            "<span class="attribute">Entrypoint</span>": <span class="value">[</span></div><div class="line">                <span class="string">"certbot"</span></div><div class="line">            ]</div><div class="line">        }</div><div class="line">    }</div><div class="line">]</div></pre></td></tr></table></figure>

<p>The <code>ENTRYPOINT</code> is <code>certbot</code> binary:</p>
<blockquote>
<p>An <code>ENTRYPOINT</code> allows you to configure a container that will run as an executable.[^1]</p>
</blockquote>
<p>And the command line arguments to <code>docker run</code> becomes the arguments to <code>certbot</code> command. As we saw earlier to obtain the release version by using <code>--version</code>.</p>
<blockquote>
<p>You can override the <code>ENTRYPOINT</code> instruction using the <code>docker run --entrypoint</code> flag.[^1]</p>
</blockquote>
<p>For example, to override and run the container without executing the <code>certbot</code> command:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ docker run -it --rm --name certbot --entrypoint /bin/bash \</div><div class="line">  quay.io/letsencrypt/letsencrypt:v0.<span class="number">9.1</span></div></pre></td></tr></table></figure>

<p>But we are more concerning about others, such as exposed port and mapped volumes. The exposed port is 443, HTTPS port. The most important volume (directory) is <code>/etc/letsencrypt</code>. All generated keys and issued certificates can be found in there. Directory <code>/var/lib/letsencrypt</code> is the default working directory, some backup stuff are stored. I have yet to find it useful. However, the logs directory <code>/var/log/letsencrypt</code> is not being used. This could be useful if things went haywire.</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2016/10/09/getting-let-s-encrypt-ssl-certificate-with-docker/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:realguess.net">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/cloud/">Cloud</a><small>11</small></li>
  
    <li><a href="/categories/coding/">Coding</a><small>12</small></li>
  
    <li><a href="/categories/communication/">Communication</a><small>1</small></li>
  
    <li><a href="/categories/computing/">Computing</a><small>5</small></li>
  
    <li><a href="/categories/data-processing/">Data Processing</a><small>0</small></li>
  
    <li><a href="/categories/data-science/">Data Science</a><small>2</small></li>
  
    <li><a href="/categories/devops/">DevOps</a><small>23</small></li>
  
    <li><a href="/categories/javascript/">JavaScript</a><small>17</small></li>
  
    <li><a href="/categories/linux/">Linux</a><small>4</small></li>
  
    <li><a href="/categories/node-js-and-io-js/">Node.js and io.js</a><small>0</small></li>
  
    <li><a href="/categories/pathfinder/">Pathfinder</a><small>1</small></li>
  
    <li><a href="/categories/philosophy/">Philosophy</a><small>1</small></li>
  
    <li><a href="/categories/productivity/">Productivity</a><small>1</small></li>
  
    <li><a href="/categories/programming/">Programming</a><small>0</small></li>
  
    <li><a href="/categories/security/">Security</a><small>1</small></li>
  
    <li><a href="/categories/starters/">Starters</a><small>0</small></li>
  
    <li><a href="/categories/statistics/">Statistics</a><small>5</small></li>
  
    <li><a href="/categories/test/">Test</a><small>2</small></li>
  
    <li><a href="/categories/tools/">Tools</a><small>18</small></li>
  
    <li><a href="/categories/travel/">Travel</a><small>3</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/2013/">2013</a><small>1</small></li>
  
    <li><a href="/tags/2014/">2014</a><small>3</small></li>
  
    <li><a href="/tags/2015/">2015</a><small>1</small></li>
  
    <li><a href="/tags/abraham-lincoln/">abraham-lincoln</a><small>1</small></li>
  
    <li><a href="/tags/absolute-path/">absolute-path</a><small>1</small></li>
  
    <li><a href="/tags/accept-ranges/">accept-ranges</a><small>1</small></li>
  
    <li><a href="/tags/accessor-property/">accessor-property</a><small>1</small></li>
  
    <li><a href="/tags/aftereach/">aftereach</a><small>1</small></li>
  
    <li><a href="/tags/agenda/">agenda</a><small>1</small></li>
  
    <li><a href="/tags/alexa/">alexa</a><small>3</small></li>
  
    <li><a href="/tags/alias/">alias</a><small>1</small></li>
  
    <li><a href="/tags/amazon/">amazon</a><small>6</small></li>
  
    <li><a href="/tags/amazon-s3/">amazon-s3</a><small>2</small></li>
  
    <li><a href="/tags/amazon-s3api/">amazon-s3api</a><small>1</small></li>
  
    <li><a href="/tags/amazon-sqs/">amazon-sqs</a><small>1</small></li>
  
    <li><a href="/tags/amtrak/">amtrak</a><small>2</small></li>
  
    <li><a href="/tags/android/">android</a><small>1</small></li>
  
    <li><a href="/tags/android-4-3/">android-4.3</a><small>1</small></li>
  
    <li><a href="/tags/anonymous/">anonymous</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-function/">anonymous-function</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-like/">anonymous-like</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-login/">anonymous-login</a><small>1</small></li>
  
    <li><a href="/tags/ansible/">ansible</a><small>1</small></li>
  
    <li><a href="/tags/apigateway/">apigateway</a><small>1</small></li>
  
    <li><a href="/tags/app-engine/">app-engine</a><small>2</small></li>
  
    <li><a href="/tags/apple/">apple</a><small>1</small></li>
  
    <li><a href="/tags/apt-get/">apt-get</a><small>2</small></li>
  
    <li><a href="/tags/array/">array</a><small>6</small></li>
  
    <li><a href="/tags/async/">async</a><small>1</small></li>
  
    <li><a href="/tags/asynchronous/">asynchronous</a><small>2</small></li>
  
    <li><a href="/tags/automated-build/">automated-build</a><small>1</small></li>
  
    <li><a href="/tags/automatic-link/">automatic-link</a><small>1</small></li>
  
    <li><a href="/tags/automation/">automation</a><small>2</small></li>
  
    <li><a href="/tags/awk/">awk</a><small>1</small></li>
  
    <li><a href="/tags/aws/">aws</a><small>11</small></li>
  
    <li><a href="/tags/aws-cli/">aws-cli</a><small>5</small></li>
  
    <li><a href="/tags/aws-sdk/">aws-sdk</a><small>1</small></li>
  
    <li><a href="/tags/awscli/">awscli</a><small>1</small></li>
  
    <li><a href="/tags/backports/">backports</a><small>1</small></li>
  
    <li><a href="/tags/backslash/">backslash</a><small>1</small></li>
  
    <li><a href="/tags/bash/">bash</a><small>3</small></li>
  
    <li><a href="/tags/batch/">batch</a><small>1</small></li>
  
    <li><a href="/tags/beforeeach/">beforeeach</a><small>1</small></li>
  
    <li><a href="/tags/best-practice/">best-practice</a><small>2</small></li>
  
    <li><a href="/tags/big-apple/">big-apple</a><small>1</small></li>
  
    <li><a href="/tags/big-easy/">big-easy</a><small>2</small></li>
  
    <li><a href="/tags/big-number/">big-number</a><small>1</small></li>
  
    <li><a href="/tags/bind/">bind</a><small>1</small></li>
  
    <li><a href="/tags/bind9/">bind9</a><small>1</small></li>
  
    <li><a href="/tags/binding/">binding</a><small>1</small></li>
  
    <li><a href="/tags/bintray/">bintray</a><small>1</small></li>
  
    <li><a href="/tags/bitbucket/">bitbucket</a><small>2</small></li>
  
    <li><a href="/tags/blog/">blog</a><small>4</small></li>
  
    <li><a href="/tags/boss/">boss</a><small>1</small></li>
  
    <li><a href="/tags/brace-expansion/">brace-expansion</a><small>1</small></li>
  
    <li><a href="/tags/bret-victor/">bret-victor</a><small>1</small></li>
  
    <li><a href="/tags/browser/">browser</a><small>1</small></li>
  
    <li><a href="/tags/browser-sync/">browser-sync</a><small>1</small></li>
  
    <li><a href="/tags/buffer/">buffer</a><small>1</small></li>
  
    <li><a href="/tags/busybox/">busybox</a><small>1</small></li>
  
    <li><a href="/tags/byobu/">byobu</a><small>1</small></li>
  
    <li><a href="/tags/ca/">ca</a><small>1</small></li>
  
    <li><a href="/tags/caddy/">caddy</a><small>1</small></li>
  
    <li><a href="/tags/caret/">caret</a><small>1</small></li>
  
    <li><a href="/tags/caret-range/">caret-range</a><small>1</small></li>
  
    <li><a href="/tags/cat/">cat</a><small>1</small></li>
  
    <li><a href="/tags/certbot/">certbot</a><small>4</small></li>
  
    <li><a href="/tags/certificate-authority/">certificate-authority</a><small>1</small></li>
  
    <li><a href="/tags/chai/">chai</a><small>1</small></li>
  
    <li><a href="/tags/changelog/">changelog</a><small>1</small></li>
  
    <li><a href="/tags/chat/">chat</a><small>1</small></li>
  
    <li><a href="/tags/chrome/">chrome</a><small>1</small></li>
  
    <li><a href="/tags/chunghwa-telecom/">chunghwa-telecom</a><small>1</small></li>
  
    <li><a href="/tags/chunked/">chunked</a><small>1</small></li>
  
    <li><a href="/tags/cli/">cli</a><small>14</small></li>
  
    <li><a href="/tags/cloud-storage/">cloud-storage</a><small>1</small></li>
  
    <li><a href="/tags/cloud9/">cloud9</a><small>1</small></li>
  
    <li><a href="/tags/cm/">cm</a><small>1</small></li>
  
    <li><a href="/tags/cname/">cname</a><small>1</small></li>
  
    <li><a href="/tags/cocoon/">cocoon</a><small>1</small></li>
  
    <li><a href="/tags/coding-style/">coding-style</a><small>4</small></li>
  
    <li><a href="/tags/coffeelint/">coffeelint</a><small>1</small></li>
  
    <li><a href="/tags/coffeescript/">coffeescript</a><small>7</small></li>
  
    <li><a href="/tags/color/">color</a><small>1</small></li>
  
    <li><a href="/tags/comcast/">comcast</a><small>1</small></li>
  
    <li><a href="/tags/command-history/">command-history</a><small>1</small></li>
  
    <li><a href="/tags/command-line/">command-line</a><small>11</small></li>
  
    <li><a href="/tags/command-line-interface/">command-line-interface</a><small>0</small></li>
  
    <li><a href="/tags/compare/">compare</a><small>1</small></li>
  
    <li><a href="/tags/compose/">compose</a><small>1</small></li>
  
    <li><a href="/tags/configuration/">configuration</a><small>1</small></li>
  
    <li><a href="/tags/configuration-management/">configuration-management</a><small>1</small></li>
  
    <li><a href="/tags/console/">console</a><small>1</small></li>
  
    <li><a href="/tags/container/">container</a><small>1</small></li>
  
    <li><a href="/tags/content-length/">content-length</a><small>1</small></li>
  
    <li><a href="/tags/content-type/">content-type</a><small>1</small></li>
  
    <li><a href="/tags/context/">context</a><small>2</small></li>
  
    <li><a href="/tags/control-character/">control-character</a><small>1</small></li>
  
    <li><a href="/tags/coreutils/">coreutils</a><small>1</small></li>
  
    <li><a href="/tags/cors/">cors</a><small>1</small></li>
  
    <li><a href="/tags/create-indexes/">create-indexes</a><small>1</small></li>
  
    <li><a href="/tags/crescent/">crescent</a><small>1</small></li>
  
    <li><a href="/tags/crlf/">crlf</a><small>1</small></li>
  
    <li><a href="/tags/cron/">cron</a><small>2</small></li>
  
    <li><a href="/tags/crontab/">crontab</a><small>1</small></li>
  
    <li><a href="/tags/crypto/">crypto</a><small>2</small></li>
  
    <li><a href="/tags/cryptography/">cryptography</a><small>1</small></li>
  
    <li><a href="/tags/curl/">curl</a><small>2</small></li>
  
    <li><a href="/tags/custom-domain/">custom-domain</a><small>2</small></li>
  
    <li><a href="/tags/custom-generator/">custom-generator</a><small>1</small></li>
  
    <li><a href="/tags/cut/">cut</a><small>2</small></li>
  
    <li><a href="/tags/cwd/">cwd</a><small>1</small></li>
  
    <li><a href="/tags/data-retrieval/">data-retrieval</a><small>1</small></li>
  
    <li><a href="/tags/data-volume/">data-volume</a><small>2</small></li>
  
    <li><a href="/tags/database/">database</a><small>1</small></li>
  
    <li><a href="/tags/datagram/">datagram</a><small>1</small></li>
  
    <li><a href="/tags/dataset/">dataset</a><small>1</small></li>
  
    <li><a href="/tags/datastore/">datastore</a><small>1</small></li>
  
    <li><a href="/tags/date/">date</a><small>2</small></li>
  
    <li><a href="/tags/db/">db</a><small>1</small></li>
  
    <li><a href="/tags/debian/">debian</a><small>3</small></li>
  
    <li><a href="/tags/debian-jessie/">debian-jessie</a><small>2</small></li>
  
    <li><a href="/tags/december/">december</a><small>1</small></li>
  
    <li><a href="/tags/delete/">delete</a><small>1</small></li>
  
    <li><a href="/tags/delimiter/">delimiter</a><small>1</small></li>
  
    <li><a href="/tags/dependency/">dependency</a><small>4</small></li>
  
    <li><a href="/tags/development/">development</a><small>1</small></li>
  
    <li><a href="/tags/development-environment/">development-environment</a><small>1</small></li>
  
    <li><a href="/tags/diff/">diff</a><small>2</small></li>
  
    <li><a href="/tags/digest/">digest</a><small>1</small></li>
  
    <li><a href="/tags/directives-end-marker/">directives-end-marker</a><small>1</small></li>
  
    <li><a href="/tags/directory/">directory</a><small>2</small></li>
  
    <li><a href="/tags/dirname/">dirname</a><small>1</small></li>
  
    <li><a href="/tags/dispatch/">dispatch</a><small>1</small></li>
  
    <li><a href="/tags/distributed/">distributed</a><small>1</small></li>
  
    <li><a href="/tags/distributed-team/">distributed-team</a><small>1</small></li>
  
    <li><a href="/tags/dns/">dns</a><small>3</small></li>
  
    <li><a href="/tags/dns114/">dns114</a><small>1</small></li>
  
    <li><a href="/tags/docco/">docco</a><small>1</small></li>
  
    <li><a href="/tags/docker/">docker</a><small>16</small></li>
  
    <li><a href="/tags/docker-compose/">docker-compose</a><small>1</small></li>
  
    <li><a href="/tags/dockerfile/">dockerfile</a><small>4</small></li>
  
    <li><a href="/tags/domain/">domain</a><small>2</small></li>
  
    <li><a href="/tags/dsn-server/">dsn-server</a><small>1</small></li>
  
    <li><a href="/tags/duplicate-keys/">duplicate-keys</a><small>1</small></li>
  
    <li><a href="/tags/duplication/">duplication</a><small>1</small></li>
  
    <li><a href="/tags/ec2/">ec2</a><small>3</small></li>
  
    <li><a href="/tags/echo/">echo</a><small>2</small></li>
  
    <li><a href="/tags/ecmascript-harmony/">ecmascript-harmony</a><small>1</small></li>
  
    <li><a href="/tags/encryption/">encryption</a><small>1</small></li>
  
    <li><a href="/tags/environment/">environment</a><small>3</small></li>
  
    <li><a href="/tags/environment-variable/">environment-variable</a><small>2</small></li>
  
    <li><a href="/tags/eol/">eol</a><small>1</small></li>
  
    <li><a href="/tags/ephemeral/">ephemeral</a><small>1</small></li>
  
    <li><a href="/tags/escape-character/">escape-character</a><small>1</small></li>
  
    <li><a href="/tags/exclude/">exclude</a><small>1</small></li>
  
    <li><a href="/tags/expiration/">expiration</a><small>1</small></li>
  
    <li><a href="/tags/explicit-document/">explicit-document</a><small>1</small></li>
  
    <li><a href="/tags/express/">express</a><small>3</small></li>
  
    <li><a href="/tags/extended-pattern-matching/">extended-pattern-matching</a><small>1</small></li>
  
    <li><a href="/tags/extglob/">extglob</a><small>1</small></li>
  
    <li><a href="/tags/facebook/">facebook</a><small>1</small></li>
  
    <li><a href="/tags/field/">field</a><small>1</small></li>
  
    <li><a href="/tags/file-system/">file-system</a><small>1</small></li>
  
    <li><a href="/tags/filename/">filename</a><small>1</small></li>
  
    <li><a href="/tags/filter/">filter</a><small>1</small></li>
  
    <li><a href="/tags/firewall/">firewall</a><small>1</small></li>
  
    <li><a href="/tags/folder/">folder</a><small>1</small></li>
  
    <li><a href="/tags/fs/">fs</a><small>1</small></li>
  
    <li><a href="/tags/function/">function</a><small>4</small></li>
  
    <li><a href="/tags/function-declaration/">function-declaration</a><small>2</small></li>
  
    <li><a href="/tags/function-expression/">function-expression</a><small>3</small></li>
  
    <li><a href="/tags/function-innovation/">function-innovation</a><small>1</small></li>
  
    <li><a href="/tags/gae/">gae</a><small>2</small></li>
  
    <li><a href="/tags/gce/">gce</a><small>2</small></li>
  
    <li><a href="/tags/gcloud/">gcloud</a><small>4</small></li>
  
    <li><a href="/tags/generator/">generator</a><small>1</small></li>
  
    <li><a href="/tags/get/">get</a><small>2</small></li>
  
    <li><a href="/tags/getter/">getter</a><small>2</small></li>
  
    <li><a href="/tags/ghost/">ghost</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>5</small></li>
  
    <li><a href="/tags/git-branch/">git-branch</a><small>1</small></li>
  
    <li><a href="/tags/git-tag/">git-tag</a><small>1</small></li>
  
    <li><a href="/tags/gitlab/">gitLab</a><small>0</small></li>
  
    <li><a href="/tags/github/">github</a><small>4</small></li>
  
    <li><a href="/tags/github-pages/">github-pages</a><small>1</small></li>
  
    <li><a href="/tags/gitignore/">gitignore</a><small>1</small></li>
  
    <li><a href="/tags/gitlab/">gitlab</a><small>1</small></li>
  
    <li><a href="/tags/glob/">glob</a><small>1</small></li>
  
    <li><a href="/tags/gnome/">gnome</a><small>1</small></li>
  
    <li><a href="/tags/gnu/">gnu</a><small>1</small></li>
  
    <li><a href="/tags/goal/">goal</a><small>1</small></li>
  
    <li><a href="/tags/google-analytics/">google-analytics</a><small>4</small></li>
  
    <li><a href="/tags/google-app-engine/">google-app-engine</a><small>1</small></li>
  
    <li><a href="/tags/google-cloud-datastore/">google-cloud-datastore</a><small>3</small></li>
  
    <li><a href="/tags/google-cloud-platform/">google-cloud-platform</a><small>2</small></li>
  
    <li><a href="/tags/google-cloud-pubsub/">google-cloud-pubsub</a><small>1</small></li>
  
    <li><a href="/tags/google-compute-engine/">google-compute-engine</a><small>3</small></li>
  
    <li><a href="/tags/google-keep/">google-keep</a><small>1</small></li>
  
    <li><a href="/tags/google-trends/">google-trends</a><small>1</small></li>
  
    <li><a href="/tags/grep/">grep</a><small>1</small></li>
  
    <li><a href="/tags/groupthink/">groupthink</a><small>1</small></li>
  
    <li><a href="/tags/grunt/">grunt</a><small>1</small></li>
  
    <li><a href="/tags/grunt-contrib-jshint/">grunt-contrib-jshint</a><small>1</small></li>
  
    <li><a href="/tags/grunt-contrib-watch/">grunt-contrib-watch</a><small>1</small></li>
  
    <li><a href="/tags/guard/">guard</a><small>1</small></li>
  
    <li><a href="/tags/gulp/">gulp</a><small>2</small></li>
  
    <li><a href="/tags/hackathon/">hackathon</a><small>1</small></li>
  
    <li><a href="/tags/head/">head</a><small>2</small></li>
  
    <li><a href="/tags/heartbleed/">heartbleed</a><small>1</small></li>
  
    <li><a href="/tags/hexo/">hexo</a><small>1</small></li>
  
    <li><a href="/tags/hipchat/">hipchat</a><small>1</small></li>
  
    <li><a href="/tags/hollywood/">hollywood</a><small>1</small></li>
  
    <li><a href="/tags/hong-kong/">hong-kong</a><small>1</small></li>
  
    <li><a href="/tags/host/">host</a><small>1</small></li>
  
    <li><a href="/tags/hosted-zone/">hosted-zone</a><small>1</small></li>
  
    <li><a href="/tags/hosts/">hosts</a><small>1</small></li>
  
    <li><a href="/tags/hotlinking/">hotlinking</a><small>1</small></li>
  
    <li><a href="/tags/http/">http</a><small>7</small></li>
  
    <li><a href="/tags/http-method/">http-method</a><small>1</small></li>
  
    <li><a href="/tags/http-server/">http-server</a><small>1</small></li>
  
    <li><a href="/tags/id/">id</a><small>1</small></li>
  
    <li><a href="/tags/ide/">ide</a><small>1</small></li>
  
    <li><a href="/tags/identifier/">identifier</a><small>1</small></li>
  
    <li><a href="/tags/iife/">iife</a><small>2</small></li>
  
    <li><a href="/tags/imessage/">imessage</a><small>1</small></li>
  
    <li><a href="/tags/immediately-invoked-function-expression/">immediately-invoked-function-expression</a><small>2</small></li>
  
    <li><a href="/tags/index/">index</a><small>1</small></li>
  
    <li><a href="/tags/inheritance/">inheritance</a><small>1</small></li>
  
    <li><a href="/tags/install/">install</a><small>14</small></li>
  
    <li><a href="/tags/instance/">instance</a><small>1</small></li>
  
    <li><a href="/tags/interactive/">interactive</a><small>2</small></li>
  
    <li><a href="/tags/internet-speed/">internet-speed</a><small>1</small></li>
  
    <li><a href="/tags/interpreter/">interpreter</a><small>1</small></li>
  
    <li><a href="/tags/iojs/">iojs</a><small>3</small></li>
  
    <li><a href="/tags/ip-address/">ip-address</a><small>3</small></li>
  
    <li><a href="/tags/january/">january</a><small>1</small></li>
  
    <li><a href="/tags/jasmine/">jasmine</a><small>1</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>13</small></li>
  
    <li><a href="/tags/jelly-bean/">jelly-bean</a><small>1</small></li>
  
    <li><a href="/tags/join/">join</a><small>1</small></li>
  
    <li><a href="/tags/jq/">jq</a><small>8</small></li>
  
    <li><a href="/tags/jq-1-5/">jq-1.5</a><small>1</small></li>
  
    <li><a href="/tags/js-yaml/">js-yaml</a><small>1</small></li>
  
    <li><a href="/tags/jshint/">jshint</a><small>1</small></li>
  
    <li><a href="/tags/json/">json</a><small>7</small></li>
  
    <li><a href="/tags/kiss/">kiss</a><small>1</small></li>
  
    <li><a href="/tags/koa/">koa</a><small>7</small></li>
  
    <li><a href="/tags/koa-compose/">koa-compose</a><small>1</small></li>
  
    <li><a href="/tags/koa-router/">koa-router</a><small>2</small></li>
  
    <li><a href="/tags/lean/">lean</a><small>1</small></li>
  
    <li><a href="/tags/lean-coffee/">lean-coffee</a><small>1</small></li>
  
    <li><a href="/tags/lean-startup/">lean-startup</a><small>1</small></li>
  
    <li><a href="/tags/left-to-right-mark/">left-to-right-mark</a><small>1</small></li>
  
    <li><a href="/tags/lets-encrypt/">lets-encrypt</a><small>4</small></li>
  
    <li><a href="/tags/lf/">lf</a><small>1</small></li>
  
    <li><a href="/tags/libssl/">libssl</a><small>1</small></li>
  
    <li><a href="/tags/license/">license</a><small>1</small></li>
  
    <li><a href="/tags/like-button/">like-button</a><small>1</small></li>
  
    <li><a href="/tags/line/">line</a><small>1</small></li>
  
    <li><a href="/tags/line-divider/">line-divider</a><small>1</small></li>
  
    <li><a href="/tags/line-ending/">line-ending</a><small>1</small></li>
  
    <li><a href="/tags/linux/">linux</a><small>3</small></li>
  
    <li><a href="/tags/listobjects/">listobjects</a><small>1</small></li>
  
    <li><a href="/tags/livereload/">livereload</a><small>2</small></li>
  
    <li><a href="/tags/load/">load</a><small>1</small></li>
  
    <li><a href="/tags/lock/">lock</a><small>1</small></li>
  
    <li><a href="/tags/lodash/">lodash</a><small>1</small></li>
  
    <li><a href="/tags/log/">log</a><small>1</small></li>
  
    <li><a href="/tags/lorem-ipsum/">lorem-ipsum</a><small>1</small></li>
  
    <li><a href="/tags/los-angeles/">los-angeles</a><small>1</small></li>
  
    <li><a href="/tags/m101/">m101</a><small>1</small></li>
  
    <li><a href="/tags/managed-vms/">managed-vms</a><small>2</small></li>
  
    <li><a href="/tags/markdown/">markdown</a><small>2</small></li>
  
    <li><a href="/tags/md5/">md5</a><small>1</small></li>
  
    <li><a href="/tags/meeting/">meeting</a><small>1</small></li>
  
    <li><a href="/tags/messaging/">messaging</a><small>1</small></li>
  
    <li><a href="/tags/metric/">metric</a><small>4</small></li>
  
    <li><a href="/tags/mi3/">mi3</a><small>1</small></li>
  
    <li><a href="/tags/middleware/">middleware</a><small>2</small></li>
  
    <li><a href="/tags/minimatch/">minimatch</a><small>1</small></li>
  
    <li><a href="/tags/mocha/">mocha</a><small>3</small></li>
  
    <li><a href="/tags/module/">module</a><small>2</small></li>
  
    <li><a href="/tags/module-caching/">module-caching</a><small>1</small></li>
  
    <li><a href="/tags/mongodb/">mongodb</a><small>1</small></li>
  
    <li><a href="/tags/mongoexport/">mongoexport</a><small>1</small></li>
  
    <li><a href="/tags/msiexec/">msiexec</a><small>1</small></li>
  
    <li><a href="/tags/multi-parts/">multi-parts</a><small>1</small></li>
  
    <li><a href="/tags/multiple/">multiple</a><small>2</small></li>
  
    <li><a href="/tags/mysql/">mysql</a><small>1</small></li>
  
    <li><a href="/tags/named-function/">named-function</a><small>1</small></li>
  
    <li><a href="/tags/natural-sort/">natural-sort</a><small>1</small></li>
  
    <li><a href="/tags/nb/">nb</a><small>1</small></li>
  
    <li><a href="/tags/network/">network</a><small>1</small></li>
  
    <li><a href="/tags/new-orleans/">new-orleans</a><small>2</small></li>
  
    <li><a href="/tags/new-york/">new-york</a><small>1</small></li>
  
    <li><a href="/tags/nginx/">nginx</a><small>3</small></li>
  
    <li><a href="/tags/node/">node</a><small>29</small></li>
  
    <li><a href="/tags/node-version-manager/">node-version-manager</a><small>1</small></li>
  
    <li><a href="/tags/nodemon/">nodemon</a><small>1</small></li>
  
    <li><a href="/tags/nodesource/">nodesource</a><small>1</small></li>
  
    <li><a href="/tags/normalization/">normalization</a><small>1</small></li>
  
    <li><a href="/tags/nota-bene/">nota-bene</a><small>1</small></li>
  
    <li><a href="/tags/note-well/">note-well</a><small>1</small></li>
  
    <li><a href="/tags/november/">november</a><small>1</small></li>
  
    <li><a href="/tags/npm/">npm</a><small>4</small></li>
  
    <li><a href="/tags/npm-module/">npm-module</a><small>1</small></li>
  
    <li><a href="/tags/ntp/">ntp</a><small>1</small></li>
  
    <li><a href="/tags/ntpdate/">ntpdate</a><small>1</small></li>
  
    <li><a href="/tags/null/">null</a><small>1</small></li>
  
    <li><a href="/tags/nvm/">nvm</a><small>1</small></li>
  
    <li><a href="/tags/object/">object</a><small>3</small></li>
  
    <li><a href="/tags/object-attributes/">object-attributes</a><small>1</small></li>
  
    <li><a href="/tags/one-liner/">one-liner</a><small>2</small></li>
  
    <li><a href="/tags/openssl/">openssl</a><small>3</small></li>
  
    <li><a href="/tags/order/">order</a><small>1</small></li>
  
    <li><a href="/tags/outdated/">outdated</a><small>1</small></li>
  
    <li><a href="/tags/package/">package</a><small>1</small></li>
  
    <li><a href="/tags/package-json/">package.json</a><small>3</small></li>
  
    <li><a href="/tags/pageview/">pageview</a><small>4</small></li>
  
    <li><a href="/tags/parseint/">parseint</a><small>1</small></li>
  
    <li><a href="/tags/part/">part</a><small>1</small></li>
  
    <li><a href="/tags/password/">password</a><small>1</small></li>
  
    <li><a href="/tags/patch/">patch</a><small>1</small></li>
  
    <li><a href="/tags/path/">path</a><small>4</small></li>
  
    <li><a href="/tags/pattern-matching/">pattern-matching</a><small>1</small></li>
  
    <li><a href="/tags/pinboard/">pinboard</a><small>1</small></li>
  
    <li><a href="/tags/ping/">ping</a><small>1</small></li>
  
    <li><a href="/tags/pipe/">pipe</a><small>1</small></li>
  
    <li><a href="/tags/pm2/">pm2</a><small>1</small></li>
  
    <li><a href="/tags/port/">port</a><small>3</small></li>
  
    <li><a href="/tags/port-forwarding/">port-forwarding</a><small>1</small></li>
  
    <li><a href="/tags/post/">post</a><small>1</small></li>
  
    <li><a href="/tags/prefix/">prefix</a><small>1</small></li>
  
    <li><a href="/tags/preinstall/">preinstall</a><small>1</small></li>
  
    <li><a href="/tags/principle/">principle</a><small>1</small></li>
  
    <li><a href="/tags/process/">process</a><small>1</small></li>
  
    <li><a href="/tags/profile/">profile</a><small>1</small></li>
  
    <li><a href="/tags/programming-style/">programming-style</a><small>0</small></li>
  
    <li><a href="/tags/protocol/">protocol</a><small>1</small></li>
  
    <li><a href="/tags/provision/">provision</a><small>1</small></li>
  
    <li><a href="/tags/proxy/">proxy</a><small>1</small></li>
  
    <li><a href="/tags/put/">put</a><small>1</small></li>
  
    <li><a href="/tags/python/">python</a><small>1</small></li>
  
    <li><a href="/tags/query-parameter/">query-parameter</a><small>1</small></li>
  
    <li><a href="/tags/queue/">queue</a><small>1</small></li>
  
    <li><a href="/tags/random/">random</a><small>3</small></li>
  
    <li><a href="/tags/range/">range</a><small>1</small></li>
  
    <li><a href="/tags/rawgit/">rawgit</a><small>1</small></li>
  
    <li><a href="/tags/read/">read</a><small>1</small></li>
  
    <li><a href="/tags/reboot/">reboot</a><small>2</small></li>
  
    <li><a href="/tags/record-set/">record-set</a><small>1</small></li>
  
    <li><a href="/tags/redis/">redis</a><small>1</small></li>
  
    <li><a href="/tags/redmine/">redmine</a><small>1</small></li>
  
    <li><a href="/tags/relative-path/">relative-path</a><small>1</small></li>
  
    <li><a href="/tags/release/">release</a><small>1</small></li>
  
    <li><a href="/tags/remote-working/">remote-working</a><small>1</small></li>
  
    <li><a href="/tags/renew/">renew</a><small>1</small></li>
  
    <li><a href="/tags/repl/">repl</a><small>1</small></li>
  
    <li><a href="/tags/require/">require</a><small>2</small></li>
  
    <li><a href="/tags/resource/">resource</a><small>1</small></li>
  
    <li><a href="/tags/responsibility/">responsibility</a><small>1</small></li>
  
    <li><a href="/tags/restart/">restart</a><small>2</small></li>
  
    <li><a href="/tags/rlwrap/">rlwrap</a><small>1</small></li>
  
    <li><a href="/tags/route-53/">route-53</a><small>3</small></li>
  
    <li><a href="/tags/routing/">routing</a><small>2</small></li>
  
    <li><a href="/tags/ruby/">ruby</a><small>1</small></li>
  
    <li><a href="/tags/rule-of-diversity/">rule-of-diversity</a><small>1</small></li>
  
    <li><a href="/tags/san-francisco/">san-francisco</a><small>1</small></li>
  
    <li><a href="/tags/save/">save</a><small>1</small></li>
  
    <li><a href="/tags/scaffolding/">scaffolding</a><small>1</small></li>
  
    <li><a href="/tags/script/">script</a><small>1</small></li>
  
    <li><a href="/tags/search/">search</a><small>1</small></li>
  
    <li><a href="/tags/search-term/">search-term</a><small>1</small></li>
  
    <li><a href="/tags/section/">section</a><small>1</small></li>
  
    <li><a href="/tags/security/">security</a><small>1</small></li>
  
    <li><a href="/tags/security-group/">security-group</a><small>2</small></li>
  
    <li><a href="/tags/sed/">sed</a><small>1</small></li>
  
    <li><a href="/tags/semantics/">semantics</a><small>1</small></li>
  
    <li><a href="/tags/semver/">semver</a><small>2</small></li>
  
    <li><a href="/tags/seq/">seq</a><small>1</small></li>
  
    <li><a href="/tags/serialization/">serialization</a><small>1</small></li>
  
    <li><a href="/tags/server/">server</a><small>3</small></li>
  
    <li><a href="/tags/serverless/">serverless</a><small>1</small></li>
  
    <li><a href="/tags/setter/">setter</a><small>2</small></li>
  
    <li><a href="/tags/settings/">settings</a><small>1</small></li>
  
    <li><a href="/tags/setup/">setup</a><small>2</small></li>
  
    <li><a href="/tags/sha256/">sha256</a><small>1</small></li>
  
    <li><a href="/tags/shabang/">shabang</a><small>1</small></li>
  
    <li><a href="/tags/sharing/">sharing</a><small>1</small></li>
  
    <li><a href="/tags/shebang/">shebang</a><small>1</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>3</small></li>
  
    <li><a href="/tags/shell-expansion/">shell-expansion</a><small>1</small></li>
  
    <li><a href="/tags/shell-script/">shell-script</a><small>1</small></li>
  
    <li><a href="/tags/shellshock/">shellshock</a><small>1</small></li>
  
    <li><a href="/tags/shopt/">shopt</a><small>1</small></li>
  
    <li><a href="/tags/simple/">simple</a><small>1</small></li>
  
    <li><a href="/tags/sls/">sls</a><small>1</small></li>
  
    <li><a href="/tags/slurp/">slurp</a><small>1</small></li>
  
    <li><a href="/tags/small/">small</a><small>1</small></li>
  
    <li><a href="/tags/socket-io/">socket-io</a><small>1</small></li>
  
    <li><a href="/tags/sort/">sort</a><small>2</small></li>
  
    <li><a href="/tags/source-maps/">source-maps</a><small>1</small></li>
  
    <li><a href="/tags/speed-test/">speed-test</a><small>1</small></li>
  
    <li><a href="/tags/split/">split</a><small>2</small></li>
  
    <li><a href="/tags/ssh/">ssh</a><small>4</small></li>
  
    <li><a href="/tags/ssh-copy-id/">ssh-copy-id</a><small>1</small></li>
  
    <li><a href="/tags/sshuttle/">sshuttle</a><small>1</small></li>
  
    <li><a href="/tags/ssl/">ssl</a><small>4</small></li>
  
    <li><a href="/tags/starter/">starter</a><small>6</small></li>
  
    <li><a href="/tags/startup/">startup</a><small>2</small></li>
  
    <li><a href="/tags/state/">state</a><small>1</small></li>
  
    <li><a href="/tags/stats/">stats</a><small>5</small></li>
  
    <li><a href="/tags/stdin/">stdin</a><small>1</small></li>
  
    <li><a href="/tags/stream/">stream</a><small>3</small></li>
  
    <li><a href="/tags/streaming/">streaming</a><small>1</small></li>
  
    <li><a href="/tags/string/">string</a><small>1</small></li>
  
    <li><a href="/tags/stringify/">stringify</a><small>1</small></li>
  
    <li><a href="/tags/structure/">structure</a><small>1</small></li>
  
    <li><a href="/tags/subscription/">subscription</a><small>1</small></li>
  
    <li><a href="/tags/success/">success</a><small>1</small></li>
  
    <li><a href="/tags/sudo/">sudo</a><small>1</small></li>
  
    <li><a href="/tags/sunset-limited/">sunset-limited</a><small>1</small></li>
  
    <li><a href="/tags/supertest/">supertest</a><small>1</small></li>
  
    <li><a href="/tags/symbolic-link/">symbolic-link</a><small>1</small></li>
  
    <li><a href="/tags/symlink/">symlink</a><small>1</small></li>
  
    <li><a href="/tags/sync/">sync</a><small>1</small></li>
  
    <li><a href="/tags/synchronous/">synchronous</a><small>2</small></li>
  
    <li><a href="/tags/systemd/">systemd</a><small>1</small></li>
  
    <li><a href="/tags/taipei/">taipei</a><small>1</small></li>
  
    <li><a href="/tags/taiwan/">taiwan</a><small>1</small></li>
  
    <li><a href="/tags/task/">task</a><small>1</small></li>
  
    <li><a href="/tags/tcdisrupt/">tcdisrupt</a><small>1</small></li>
  
    <li><a href="/tags/teardown/">teardown</a><small>1</small></li>
  
    <li><a href="/tags/techcrunch/">techcrunch</a><small>1</small></li>
  
    <li><a href="/tags/template/">template</a><small>2</small></li>
  
    <li><a href="/tags/terminal/">terminal</a><small>1</small></li>
  
    <li><a href="/tags/test/">test</a><small>1</small></li>
  
    <li><a href="/tags/testing/">testing</a><small>1</small></li>
  
    <li><a href="/tags/texting/">texting</a><small>1</small></li>
  
    <li><a href="/tags/this/">this</a><small>1</small></li>
  
    <li><a href="/tags/time-zone/">time-zone</a><small>1</small></li>
  
    <li><a href="/tags/tmux/">tmux</a><small>1</small></li>
  
    <li><a href="/tags/todo/">todo</a><small>1</small></li>
  
    <li><a href="/tags/topic/">topic</a><small>2</small></li>
  
    <li><a href="/tags/train/">train</a><small>2</small></li>
  
    <li><a href="/tags/transfer-encoding/">transfer-encoding</a><small>1</small></li>
  
    <li><a href="/tags/travel/">travel</a><small>0</small></li>
  
    <li><a href="/tags/trello/">trello</a><small>1</small></li>
  
    <li><a href="/tags/trigger/">trigger</a><small>1</small></li>
  
    <li><a href="/tags/trusty/">trusty</a><small>1</small></li>
  
    <li><a href="/tags/tumblr/">tumblr</a><small>1</small></li>
  
    <li><a href="/tags/twitter/">twitter</a><small>1</small></li>
  
    <li><a href="/tags/ubuntu/">ubuntu</a><small>5</small></li>
  
    <li><a href="/tags/uglifyjs/">uglifyjs</a><small>1</small></li>
  
    <li><a href="/tags/ulimit/">ulimit</a><small>1</small></li>
  
    <li><a href="/tags/underscore/">underscore</a><small>1</small></li>
  
    <li><a href="/tags/unicode/">unicode</a><small>1</small></li>
  
    <li><a href="/tags/unique-visitor/">unique-visitor</a><small>4</small></li>
  
    <li><a href="/tags/united-states/">united-states</a><small>1</small></li>
  
    <li><a href="/tags/unix/">unix</a><small>1</small></li>
  
    <li><a href="/tags/unix-philosophy/">unix-philosophy</a><small>1</small></li>
  
    <li><a href="/tags/update/">update</a><small>2</small></li>
  
    <li><a href="/tags/upgrade/">upgrade</a><small>2</small></li>
  
    <li><a href="/tags/upload/">upload</a><small>1</small></li>
  
    <li><a href="/tags/upstart/">upstart</a><small>1</small></li>
  
    <li><a href="/tags/upwork/">upwork</a><small>1</small></li>
  
    <li><a href="/tags/url/">url</a><small>1</small></li>
  
    <li><a href="/tags/username/">username</a><small>1</small></li>
  
    <li><a href="/tags/vagrant/">vagrant</a><small>8</small></li>
  
    <li><a href="/tags/vagrant-box/">vagrant-box</a><small>1</small></li>
  
    <li><a href="/tags/vagrant-google/">vagrant-google</a><small>1</small></li>
  
    <li><a href="/tags/vagrant-plugin/">vagrant-plugin</a><small>1</small></li>
  
    <li><a href="/tags/validation/">validation</a><small>1</small></li>
  
    <li><a href="/tags/version/">version</a><small>6</small></li>
  
    <li><a href="/tags/version-sort/">version-sort</a><small>1</small></li>
  
    <li><a href="/tags/video/">video</a><small>1</small></li>
  
    <li><a href="/tags/vim/">vim</a><small>3</small></li>
  
    <li><a href="/tags/vimdiff/">vimdiff</a><small>1</small></li>
  
    <li><a href="/tags/vimeo/">vimeo</a><small>1</small></li>
  
    <li><a href="/tags/virtualbox/">virtualbox</a><small>1</small></li>
  
    <li><a href="/tags/visit/">visit</a><small>4</small></li>
  
    <li><a href="/tags/vivid/">vivid</a><small>1</small></li>
  
    <li><a href="/tags/vpn/">vpn</a><small>1</small></li>
  
    <li><a href="/tags/vulnerability/">vulnerability</a><small>1</small></li>
  
    <li><a href="/tags/web-framework/">web-framework</a><small>1</small></li>
  
    <li><a href="/tags/web-server/">web-server</a><small>2</small></li>
  
    <li><a href="/tags/webhook/">webhook</a><small>1</small></li>
  
    <li><a href="/tags/windows/">windows</a><small>2</small></li>
  
    <li><a href="/tags/workflow/">workflow</a><small>1</small></li>
  
    <li><a href="/tags/x-content-type-options/">x-content-type-options</a><small>1</small></li>
  
    <li><a href="/tags/xargs/">xargs</a><small>2</small></li>
  
    <li><a href="/tags/xiaomi/">xiaomi</a><small>1</small></li>
  
    <li><a href="/tags/yaml/">yaml</a><small>1</small></li>
  
    <li><a href="/tags/yeoman/">yeoman</a><small>1</small></li>
  
    <li><a href="/tags/yield/">yield</a><small>1</small></li>
  
    <li><a href="/tags/zone-apex/">zone-apex</a><small>1</small></li>
  
    <li><a href="/tags/中華電信/">中華電信</a><small>1</small></li>
  
    <li><a href="/tags/小米/">小米</a><small>1</small></li>
  
    <li><a href="/tags/小米手机/">小米手机</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2018 Chao Huang
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'realguess';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>