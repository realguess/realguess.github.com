<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives: 2014/5 | realguess</title>
  <meta name="author" content="Chao Huang">
  
  <meta name="description" content="Just a blog about every detail encountered.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="realguess"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="realguess" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-45698182-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">realguess</a></h1>
  <h2><a href="/">Don&#39;t afraid to try!</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title">2014/5</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-24T22:17:41.000Z"><a href="/2014/05/24/amazon-s3-delimiter-and-prefix/">May 24, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/24/amazon-s3-delimiter-and-prefix/">Amazon S3 Delimiter and Prefix</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="http://aws.amazon.com/s3/" target="_blank" rel="external">Amazon S3</a> is an inexpensive online file storage service, and there is the <a href="http://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/S3.html" target="_blank" rel="external">JavaScript SDK</a> to use. There are things puzzling me when using the SDK were:</p>
<ol>
<li>How to use parameters <code>Delimiter</code> and <code>Prefix</code>?</li>
<li>What is the difference between <code>CommonPrefixes</code> and <code>Contents</code>?</li>
<li>How to create a folder/directory with JavaScript SDK?</li>
</ol>
<p>To retrieve objects in an Amazon S3 bucket, the operation is <code>listObjects</code>. The <code>listObjects</code> does not return the content of the object, but the key and meta data such as size and owner of the object.</p>
<p>To make a call to get a list of objects in a bucket:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">s3.listObjects(params, <span class="function"><span class="keyword">function</span> <span class="params">(err, data)</span> </span>{</div><div class="line">  <span class="comment">// ...</span></div><div class="line">});</div></pre></td></tr></table></figure>

<p>Where the <code>params</code> can be configured with the following parameters:</p>
<ul>
<li>Bucket</li>
<li>Delimiter</li>
<li>EncodingType</li>
<li>Marker</li>
<li>MaxKeys</li>
<li>Prefix</li>
</ul>
<p>But what are <code>Delimiter</code> and <code>Prefix</code>? And how to use them?</p>
<p>Let’s start by creating some objects in an Amazon S3 bucket similar to the following file structure. This can be easily done by using the AWS Console.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">├── <span class="built_in">directory</span></div><div class="line">│   ├── <span class="built_in">directory</span></div><div class="line">│   │   └── <span class="built_in">file</span></div><div class="line">│   └── <span class="built_in">file</span></div><div class="line">└── <span class="built_in">file</span></div><div class="line"></div><div class="line"><span class="number">2</span> <span class="built_in">directories</span>, <span class="number">3</span> <span class="built_in">files</span></div></pre></td></tr></table></figure>

<p>In Amazon S3, the objects are:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>One thing to keep in mind is that Amazon S3 is not a file system. There is not really the concept of file and directory/folder. From the console, it might look like there are 2 directories and 3 files. But they are all objects. And objects are listed alphabetically by their keys. </p>
<p>To make it a little bit more clear, let’s invoke the <code>listObjects</code> method. Since the operation has only <code>Bucket</code> parameter is required:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">params = {</div><div class="line">  Bucket: <span class="string">'example'</span></div><div class="line">};</div></pre></td></tr></table></figure>

<p>The response <code>data</code> contains in the callback function:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/file'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> },</div><div class="line">     { Key: <span class="string">'file'</span>,</div><div class="line">       LastModified: <span class="keyword">...</span>,</div><div class="line">       ETag: <span class="string">'"d41d8cd98f00b204e9800998ecf8427e"'</span>,</div><div class="line">       Size: <span class="number">0</span>,</div><div class="line">       Owner: [Object],</div><div class="line">       StorageClass: <span class="string">'STANDARD'</span> } ],</div><div class="line">  CommonPrefixes: [],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  Marker: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  IsTruncated: false }</div></pre></td></tr></table></figure>

<p>If this is a file structure, you might expect:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>But it is not, because a bucket does not work like a folder or a directory, where the immediate files inside the directory is shown.  The objects inside the bucket are laid out flat and alphabetically.</p>
<p>In UNIX, a directory is a file, but in Amazon S3, everything is an object, and can be identified by key.</p>
<p>So, how to make Amazon S3 behave more like a folder or a directory? Or how to just list the content of first level right inside the bucket?</p>
<p>In order to make it work like directory you have to use <code>Delimiter</code> and <code>Prefix</code>. <code>Delimiter</code> is what you use to group keys. It does have to be a <em>single character</em>, it can be a string of characters. And <code>Prefix</code> limits the response to keys that begin with the specified prefix.</p>
<h2 id="Delimiter">Delimiter</h2>
<p>Let’s start by adding the following delimiter:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">params = {</div><div class="line">  Bucket: <span class="string">'example'</span>,</div><div class="line">  Delimiter: <span class="string">'/'</span></div><div class="line">};</div></pre></td></tr></table></figure>

<p>You will get something more like a listing of a directory:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'file'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory/'</span> } ],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  Delimiter: <span class="string">'/'</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>There are a directory <code>directory/</code> and a file <code>file</code>. What happened was that the following objects except <code>file</code> are grouped by the delimiter <code>/</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>So, result in:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>This feels more like a listing of a directory or folder. But if we change <code>Delimiter</code> to <code>i</code>, then, you get no <code>Contents</code> and just the prefixes:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">{ Contents: [],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'di'</span> }, { Prefix: <span class="string">'fi'</span> } ],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  Delimiter: <span class="string">'i'</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>All keys can be grouped into two prefixes: <code>di</code> and <code>fi</code>. Therefore, Amazon S3 is not a file system, but might act like one if using the right parameters.</p>
<p>As I have mentioned that <code>Delimiter</code> does not need to be a single character:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span> },</div><div class="line">     { Key: <span class="string">'file'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory/directory'</span> } ],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  Delimiter: <span class="string">'/directory'</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>If recall the bucket structure:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>Both <code>directory/directory/</code> and <code>directory/directory/file</code> are grouped into a common prefix: <code>directory/directory</code>, due to the common grouping string <code>/directory</code>.</p>
<p>Let’s try another one with <code>Delimiter: &#39;directory&#39;</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'file'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory'</span> } ],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">''</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  Delimiter: <span class="string">'directory'</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>Okay, one more. Let’s try <code>ry/fi</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/'</span> },</div><div class="line">     { Key: <span class="string">'file'</span> } ],</div><div class="line">  CommonPrefixes: </div><div class="line">   [ { Prefix: <span class="string">'directory/directory/fi'</span> },</div><div class="line">     { Prefix: <span class="string">'directory/fi'</span> } ],</div><div class="line">  Name: <span class="string">'example,</span></div><div class="line">  Prefix: '<span class="string">',</span></div><div class="line">  MaxKeys: 1000,</div><div class="line">  Delimiter: 'ry/<span class="keyword">fi</span><span class="string">',</span></div><div class="line">  IsTruncated: false }</div></pre></td></tr></table></figure>

<p>So, remember that <code>Delimiter</code> is just providing a grouping functionality for keys. If you want it to behave like a file system, use <code>Delimiter: &#39;/&#39;</code>.</p>
<h2 id="Prefix">Prefix</h2>
<p><code>Prefix</code> is much easier to understand, it is a filter that limits keys to be prefixed by the one specified.</p>
<p>With the same structure:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>Let’s set the <code>Prefix</code> parameter to <code>directory</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/file'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span> } ],</div><div class="line">  CommonPrefixes: [],</div><div class="line">  Name: <span class="string">'example'</span>,</div><div class="line">  Prefix: <span class="string">'directory'</span>,</div><div class="line">  MaxKeys: <span class="number">1000</span>,</div><div class="line">  IsTruncated: <span class="literal">false</span> }</div></pre></td></tr></table></figure>

<p>How about <code>directory/</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/file'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span> } ],</div><div class="line">  CommonPrefixes: [],</div><div class="line">  Prefix: <span class="string">'directory/'</span> }</div></pre></td></tr></table></figure>

<p>Both <code>directory</code> and <code>directory/</code> prefixes are the same.</p>
<p>If we try something slightly different, <code>Prefix: &#39;directory/d&#39;</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/directory/file'</span> } ],</div><div class="line">  CommonPrefixes: [],</div><div class="line">  Prefix: <span class="string">'directory/d'</span> }</div></pre></td></tr></table></figure>

<p>Putting all together with both <code>Delimiter: &#39;directory&#39;</code> and <code>Prefix: &#39;directory&#39;</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> },</div><div class="line">     { Key: <span class="string">'directory/file'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory/directory'</span> } ],</div><div class="line">  Prefix: <span class="string">'directory'</span>,</div><div class="line">  Delimiter: <span class="string">'directory'</span> }</div></pre></td></tr></table></figure>

<p>First, list the keys prefixed by <code>directory</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>Group them by the delimiter <code>directory</code> <strong>with prefix <code>directory</code></strong>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span></div></pre></td></tr></table></figure>

<p>The result <code>Contents</code> are:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>and <code>CommonPrefixes</code> are:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span></div></pre></td></tr></table></figure>

<p>Maybe changing <code>Delimiter</code> to <code>i</code> could give a better perspective:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">{ Contents: </div><div class="line">   [ { Key: <span class="string">'directory/'</span> } ],</div><div class="line">  CommonPrefixes: [ { Prefix: <span class="string">'directory/di'</span> }, { Prefix: <span class="string">'directory/fi'</span> } ],</div><div class="line">  Prefix: <span class="string">'directory'</span>,</div><div class="line">  Delimiter: <span class="string">'i'</span> }</div></pre></td></tr></table></figure>

<p>as:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/               <span class="comment"># key to show</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/     <span class="comment"># group to 'directory/di'</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">directory</span>/<span class="built_in">file</span> <span class="comment"># group to 'directory/di'</span></div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span>           <span class="comment"># Group to 'directory/fi'</span></div><div class="line"><span class="built_in">file</span>                     <span class="comment"># ignored due to prefix</span></div></pre></td></tr></table></figure>

<p>One advantage of using Amazon S3 over listing a directory is that you don’t need to concern about nested directories, everything is being flattened. So, you can loop it through just by specifying the <code>Prefix</code> property.</p>
<h2 id="Directory/Folder">Directory/Folder</h2>
<p>If you’re using the Amazon AWS console to “Create Folder”, you can create a directory/folder and upload a file to inside the directory/folder. In effect, you are actually creating two objects with the following keys:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">directory</span>/</div><div class="line"><span class="built_in">directory</span>/<span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>If you use the following command to upload a file, the directory is not created:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ aws s3 cp <span class="built_in">file</span> s3://example/<span class="built_in">directory</span>/<span class="built_in">file</span></div></pre></td></tr></table></figure>

<p>Because, Amazon S3 is not a file system, but a key/value store. If you use <code>listObjects</code> method, you will just see one object. That is the same reason that you cannot copy a local directory:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ aws s3 cp directory s3://example/directory</div><div class="line">upload failed: aws/ to s3://example/directory [Errno <span class="number">21</span>] Is a directory: <span class="string">u'/home/chao/tmp/directory/'</span></div></pre></td></tr></table></figure>

<p>But we can use the JavaScript SDK to create a directory/folder:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">s3.putObject({ Bucket: <span class="string">'example'</span>, Key: <span class="string">'directory/'</span> }, <span class="function"><span class="keyword">function</span> <span class="params">(err, data)</span> </span>{</div><div class="line">  <span class="keyword">if</span> (err) { <span class="keyword">return</span> <span class="built_in">console</span>.error(err); }</div><div class="line"></div><div class="line">  <span class="built_in">console</span>.log(data);</div><div class="line">});</div></pre></td></tr></table></figure>

<p>Note that you must use <code>directory/</code> with trailing slash instead the one without. Otherwise, it is just a regular file not a directory.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-20T13:49:37.000Z"><a href="/2014/05/20/node-version-manager/">May 20, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/20/node-version-manager/">Node Version Manager</a></h1>
  

    </header>
    <div class="entry">
      
        <p><a href="https://github.com/creationix/nvm" target="_blank" rel="external">Node Version Manager</a> is a simple bash script to manage multiple active <a href="http://nodejs.org/" target="_blank" rel="external">Node</a> versions. <em>Why do you want to use it?</em> If you like me, you want to try out the latest unstable version of the Node, but you still need to use the older and stable versions to develop and maintain your projects, then you should use <a href="https://github.com/creationix/nvm" target="_blank" rel="external">NVM</a>.</p>
<p>You can find out more information on <a href="https://github.com/creationix/nvm" target="_blank" rel="external">NVM GitHub page</a>, below are just my take on installing and using it.</p>
<h2 id="Install">Install</h2>
<p>You can install NVM via the install script, but always do it the hard way by installing it manually:</p>
<pre><code><span class="variable">$ </span>git clone <span class="symbol">https:</span>/<span class="regexp">/github.com/creationix</span><span class="regexp">/nvm.git ~/</span>.nvm
</code></pre><p>Check out the latest version:</p>
<pre><code>$ <span class="built_in">cd</span> ~/.nvm &amp;&amp; git checkout v0.<span class="number">7.0</span>
</code></pre><p>Enable NVM:</p>
<pre><code>$ <span class="keyword">source</span> ~/.nvm/nvm.<span class="keyword">sh</span>
</code></pre><p>Add this to <code>~/.bashrc</code> to make it available upon login:</p>
<pre><code>$ <span class="built_in">echo</span> <span class="string">"\n# Enable NVM"</span>           &gt;&gt; ~/.bashrc
$ <span class="built_in">echo</span> <span class="string">'source $HOME/.nvm/nvm.sh'</span> &gt;&gt; ~/.bashrc
</code></pre><p>Enable Bash completion:</p>
<pre><code>$ <span class="built_in">echo</span> <span class="string">'source $HOME/.nvm/bash_completion'</span> &gt;&gt; ~/.bashrc
</code></pre><p>Try it by opening a new terminal:</p>
<pre><code><span class="variable">$ </span>nvm
</code></pre><h2 id="Usage">Usage</h2>
<p>Get help:</p>
<pre><code>$ nvm <span class="built_in">help</span>
</code></pre><p>Show current NVM version:</p>
<pre><code>$ nvm --<span class="keyword">version</span>
</code></pre><p>Display the currently active Node version:</p>
<pre><code>$ nvm <span class="literal">current</span>
</code></pre><p>Install Node v0.10.28:</p>
<pre><code><span class="variable">$ </span>nvm install <span class="number">0</span>.<span class="number">10.28</span>
</code></pre><p>The installed Node version will reside in <code>~/.nvm/v0.10.28</code>.</p>
<p>List installed versions:</p>
<pre><code>$ nvm <span class="keyword">ls</span>
    .nvm
v0.<span class="number">10.28</span>
</code></pre><p>Use a specific Node version:</p>
<pre><code><span class="variable">$ </span>which node
/usr/local/bin/node
<span class="variable">$ </span>node -v
v<span class="number">0</span>.<span class="number">11.13</span>
<span class="variable">$ </span>nvm <span class="keyword">use</span> <span class="number">0</span>.<span class="number">10.28</span>
<span class="constant">Now </span>using node v<span class="number">0</span>.<span class="number">10.28</span>
<span class="variable">$ </span>node -v
v<span class="number">0</span>.<span class="number">10.28</span>
<span class="variable">$ </span>which node
/home/chao/.nvm/v<span class="number">0</span>.<span class="number">10.28</span>/bin/node
</code></pre><p>Basically, NVM modified the search path.</p>
<pre><code>$ <span class="built_in">echo</span> <span class="variable">$PATH</span>
/home/chao/.nvm/v0.<span class="number">10.28</span>/bin
</code></pre><p>To roll back:</p>
<pre><code><span class="char">$ </span>nvm deactivate
/home/chao/.nvm/*/bin removed from <span class="char">$P</span>ATH
/home/chao/.nvm/*/share/man removed from <span class="char">$M</span>ANPATH
/home/chao/.nvm/*/lib/node_modules removed from <span class="char">$N</span>ODE_PATH
</code></pre><p>List Node versions available to install:</p>
<pre><code>$ nvm <span class="keyword">ls</span>-remote
</code></pre><p>Use <code>.nvmrc</code> file:</p>
<pre><code><span class="input"><span class="prompt">$ echo '0.10.28' &gt;&gt;</span> .nvmrc</span>
<span class="variable">$ </span>nvm use
<span class="constant">Found</span> <span class="string">'/home/chao/.nvmrc'</span> with version &lt;<span class="number">0</span>.<span class="number">10.28</span>&gt;
<span class="constant">Now</span> using node v<span class="number">0</span>.<span class="number">10.28</span>
<span class="variable">$ </span>node -v
v<span class="number">0</span>.<span class="number">10.28</span>
</code></pre>
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-18T22:05:34.000Z"><a href="/2014/05/18/split-a-large-json-file-into-smaller-pieces/">May 18, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/18/split-a-large-json-file-into-smaller-pieces/">Split a Large JSON file into Smaller Pieces</a></h1>
  

    </header>
    <div class="entry">
      
        <p>In the <a href="/2013/12/19/split-json-file-into-multiple-parts/">previous post</a>, I have written about how to split a large JSON file into multiple parts, but that was limited to the default behavior of <code>mongoexport</code>, where each line in the output file represents a JSON string. If you have to deal with a large JSON file, such as the one generated with <code>--jsonArray</code> option in <code>mongoexport</code>, you can to parse the file incrementally or streaming.</p>
<p>I have downloaded a large JOSN <a href="https://health.data.ny.gov/api/views/vafa-pf2s/rows.json?accessType=DOWNLOAD" target="_blank" rel="external">data set</a> (about 144MB) from <a href="http://catalog.data.gov/dataset/genealogical-research-death-index-beginning-1957" target="_blank" rel="external">Data.gov</a>. If you try to read the entire data set into memory:</p>
<pre><code>&gt; <span class="keyword">var</span> json = <span class="built_in">require</span>(<span class="string">'./data.json'</span>)
Killed
</code></pre><p>The process is not able to handle it. Use streaming is necessary. And luckily, our <a href="/2014/05/18/command-line-json-processing/">command line JSON processing</a> tool, <a href="http://stedolan.github.io/jq/" target="_blank" rel="external">jq</a>, supports streaming.</p>
<p>The parts we are interested are encapsulated in an array under <code>data</code> property of the data set. We are going to split each element of the array into its own file.</p>
<p>Don’t try to use <code>-f</code> option in <em>jq</em> to read file from the command line, it will read everything into a memory. Instead, do <code>cat data.json | jq</code>.</p>
<pre><code>$ <span class="built_in">mkdir</span> parts
$ <span class="keyword">cat</span> data.json | jq -<span class="keyword">c</span> -M <span class="string">'.data[]'</span> | \
  <span class="keyword">while</span> <span class="keyword">read</span> <span class="built_in">line</span>; <span class="keyword">do</span> <span class="keyword">echo</span> $<span class="built_in">line</span> &gt; parts/$(date +%<span class="keyword">s</span>%<span class="keyword">N</span>).json; done
</code></pre><p>The entire data set is piped into <em>jq</em> to filter and compress each array element. Each element is printed in one line, and each line is saved into its own JSON file by using UNIX timestamp plus nanosecond as the filename. All pieces are saved into <code>parts/</code> directory.</p>
<p>But there is one problem with embedded JSON string, which has to do with <code>echo</code>, due to backslash. For example, if echoing the following string:</p>
<pre><code>{<span class="string">"name"</span>:<span class="string">"{\"first\":\"Foo\",\"last\":\"Foo\"}"</span>,<span class="string">"username"</span>:<span class="string">"foo"</span>,<span class="string">"id"</span>:<span class="number">1</span>}
</code></pre><p>It will be printed as an invalid JSON:</p>
<pre><code>{<span class="string">"name"</span><span class="symbol">:<span class="string">"{"</span>first<span class="string">":"</span>Foo<span class="string">","</span>last<span class="string">":"</span>Foo<span class="string">"}"</span></span>,<span class="string">"username"</span><span class="symbol">:<span class="string">"foo"</span></span>,<span class="string">"id"</span><span class="symbol">:</span><span class="number">1</span>}
</code></pre><p>Backslashes are stripped. To fix this problem, we can simply double backslash:</p>
<pre><code>$ <span class="keyword">cat</span> data.json | jq -<span class="keyword">c</span> -M <span class="string">'.data[]'</span> | sed <span class="string">'s/\\"/\\\\"/g'</span> | \
  <span class="keyword">while</span> <span class="keyword">read</span> <span class="built_in">line</span>; <span class="keyword">do</span> <span class="keyword">echo</span> $<span class="built_in">line</span> &gt; parts/$(date +%<span class="keyword">s</span>%<span class="keyword">N</span>).json; done
</code></pre><p>You can even try <code>curl</code> the remote JSON file instead using <code>cat</code> from the downloaded file. But you might want to try with a smaller file first, because, with my slow machine, it took me nearly an hour to finish splitting into 678,733 parts:</p>
<pre><code>real    <span class="number">49</span>m35.<span class="number">780</span>s
<span class="literal">user</span>    <span class="number">2</span>m42.<span class="number">888</span>s
sys     <span class="number">6</span>m48.<span class="number">048</span>s
</code></pre><p>To take it a little bit further, the next step is to decide how many lines or array elements to write into a single file.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-18T14:49:04.000Z"><a href="/2014/05/18/command-line-json-processing/">May 18, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/18/command-line-json-processing/">Command Line JSON Processing</a></h1>
  

    </header>
    <div class="entry">
      
        <p>What is the best command line tool to process JSON?</p>
<p>Hmm… Okay, let’s try different command line JSON processing tools with the following use case to decide which one is the best to use.</p>
<p>Here is the use case: <code>JSON | filter | shell</code>. A program outputs JSON data, pipes into a JSON command line processing tool to filter data, and then send to a shell command to do more work.</p>
<p>Here is a snippet of sample JSON data:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  {</div><div class="line">    "<span class="attribute">id</span>": <span class="value"><span class="number">1</span></span>,</div><div class="line">    "<span class="attribute">username</span>": <span class="value"><span class="string">"foo"</span></span>,</div><div class="line">    "<span class="attribute">name</span>": <span class="value"><span class="string">"Foo Foo"</span></span></div><div class="line">  },</div><div class="line">  {</div><div class="line">    "<span class="attribute">id</span>": <span class="value"><span class="number">2</span></span>,</div><div class="line">    "<span class="attribute">username</span>": <span class="value"><span class="string">"bar"</span></span>,</div><div class="line">    "<span class="attribute">name</span>": <span class="value"><span class="string">"Bar Bar"</span></span></div><div class="line">  }</div><div class="line">]</div></pre></td></tr></table></figure>

<p>Or in one-liner <code>data.json</code>:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[{"<span class="attribute">id</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">username</span>":<span class="value"><span class="string">"foo"</span></span>,"<span class="attribute">name</span>":<span class="value"><span class="string">"Foo Foo"</span></span>},{"<span class="attribute">id</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">username</span>":<span class="value"><span class="string">"bar"</span></span>,"<span class="attribute">name</span>":<span class="value"><span class="string">"Bar Bar"</span></span>}]</div></pre></td></tr></table></figure>

<p>The command line JSON processor should filter each element of the array and convert it into its own line:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">{"<span class="attribute">name</span>":<span class="value"><span class="string">"Foo Foo"</span></span>}</div><div class="line">{"<span class="attribute">name</span>":<span class="value"><span class="string">"Bar Bar"</span></span>}</div></pre></td></tr></table></figure>

<p>The result will be piped as the input line by line into a shell script <code>echo.bash</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/usr/bin/env bash</span></div><div class="line"></div><div class="line"><span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span></div><div class="line">  <span class="built_in">echo</span> <span class="string">"ECHO: '"</span><span class="variable">$line</span><span class="string">"'"</span></div><div class="line"><span class="keyword">done</span></div></pre></td></tr></table></figure>

<p>The final output should be:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ECHO: <span class="string">'{"</span>name<span class="string">":"</span>Foo Foo<span class="string">"}'</span></div><div class="line">ECHO: <span class="string">'{"</span>name<span class="string">":"</span>Bar Bar<span class="string">"}'</span></div></pre></td></tr></table></figure>

<h2 id="Custom_Solution">Custom Solution</h2>
<p>Before start looking for existing tools, let’s see how difficult it is to write a custom solution.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Filter and convert array element into its own line.</span></div><div class="line"><span class="keyword">var</span> rl = <span class="built_in">require</span>(<span class="string">'readline'</span>).createInterface({</div><div class="line">  input : process.stdin,</div><div class="line">  output: process.stdout,</div><div class="line">});</div><div class="line"></div><div class="line">rl.on(<span class="string">'line'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(line)</span> </span>{</div><div class="line">  <span class="built_in">JSON</span>.parse(line).forEach(<span class="function"><span class="keyword">function</span> <span class="params">(item)</span> </span>{</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'{"name":"'</span> + item.name + <span class="string">'"}'</span>);</div><div class="line">  });</div><div class="line">}).on(<span class="string">'close'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>{</div><div class="line">  <span class="comment">// Shh...</span></div><div class="line">});</div></pre></td></tr></table></figure>

<p>Perform a test run:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ cat <span class="typedef"><span class="keyword">data</span>.json | node filter.js  | bash echo.bash </span></div><div class="line"><span class="type">ECHO</span>: '{<span class="string">"name"</span>:<span class="string">"Foo Foo"</span>}'</div><div class="line"><span class="type">ECHO</span>: '{<span class="string">"name"</span>:<span class="string">"Bar Bar"</span>}'</div></pre></td></tr></table></figure>

<p>Well, it works. In essence, we are writing a simple JSON parser. Unless you want to keep the footprint small, you don’t want to write another JSON parser. And why bother to reinvent the wheel? Let’s start look at the existing solutions.</p>
<h2 id="Node_Modules">Node Modules</h2>
<p>Let’s start with the tools from NPM registry:</p>
<pre><code>$ npm <span class="built_in">search</span> json <span class="keyword">command</span>
</code></pre><p>Here are a few candidates that appears to be matching from the description:</p>
<ul>
<li><a href="https://github.com/bjorne/jku" target="_blank" rel="external">jku</a> - Jku is a command-line tool to filter and/or modifiy a JSON stream. It is heavily inspired by jq. (2 stars and not active, last update 8 months ago).</li>
<li><a href="https://github.com/zpoley/json-command" target="_blank" rel="external">json</a> or <a href="https://github.com/zpoley/json-command" target="_blank" rel="external">json-command</a> - JSON command line procesing toolkit. (122 stars and 14 forks, last update 9 months ago)</li>
<li><a href="https://github.com/misterfifths/jutil" target="_blank" rel="external">jutil</a> - Command-line utilities for manipulating JSON. (88 stars and 2 forks, last update more than 2 years ago)</li>
</ul>
<p>Not a lot of choice, and modules are not active. This might be that because there is already a really good solution, <a href="https://github.com/stedolan/jq" target="_blank" rel="external">jq</a>, which has 2493 stars and 145 forks, and the last update was 6 days ago.</p>
<h2 id="jq">jq</h2>
<blockquote>
<p>jq is like <code>sed</code> for JSON data - you can use it to slice and filter and map and transform structured data with the same ease that <code>sed</code>, <code>awk</code>, <code>grep</code> and friends let you play with text. - <a href="https://github.com/stedolan/jq" target="_blank" rel="external">jq</a></p>
</blockquote>
<p>Instead of NPM install, do:</p>
<pre><code>$ <span class="built_in">sudo</span> apt-get -y install jq
</code></pre><p>Since we don’t need color or prettified, just line by line. So, here is the command chain:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ cat <span class="typedef"><span class="keyword">data</span>.json | jq -c -<span class="type">M</span> '.[] | <span class="container">{<span class="title">name</span>}</span>'  | bash echo.bash</span></div><div class="line"><span class="type">ECHO</span>: '{<span class="string">"name"</span>:<span class="string">"Foo Foo"</span>}'</div><div class="line"><span class="type">ECHO</span>: '{<span class="string">"name"</span>:<span class="string">"Bar Bar"</span>}'</div></pre></td></tr></table></figure>

<p><a href="https://github.com/stedolan/jq" target="_blank" rel="external">jq</a> can do much more than just the example just shown. It has zero runtime dependencies, and flexible to deal with not just array but object as well.</p>
<h2 id="Conclusion">Conclusion</h2>
<p><a href="https://github.com/stedolan/jq" target="_blank" rel="external">jq</a> is clearly the winner here, with the least dependency, the most functionality and more popularity, as well as a comprehensive documentation.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-11T14:11:43.000Z"><a href="/2014/05/11/sharpening-the-ax-before-chopping-down-a-tree/">May 11, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/11/sharpening-the-ax-before-chopping-down-a-tree/">Sharpening the Ax Before Chopping Down a Tree</a></h1>
  

    </header>
    <div class="entry">
      
        <p>I was helping to examine a server that was impacted by <a href="http://heartbleed.com/" target="_blank" rel="external">Heartbleed</a>. According to the developer who was patching the server, he had updated the <a href="http://www.openssl.org/" target="_blank" rel="external">OpenSSL</a> library to the following:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$ openssl version -a</div><div class="line">OpenSSL 1.0.1g 7 Apr 2014</div><div class="line">built on: Fri Apr 18 11:04:34 EDT 2014</div><div class="line">platform: linux-x86_64</div><div class="line">options: bn(64,64) rc4(16x,int) des(idx,cisc,16,int) idea(int) </div><div class="line">blowfish(idx) </div><div class="line">compiler: gcc -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H </div><div class="line">-<span class="ruby"><span class="constant">Wa</span>,--noexecstack -m64 -<span class="constant">DL_ENDIAN</span> -<span class="constant">DTERMIO</span> -<span class="constant">O3</span> -<span class="constant">Wall</span> -<span class="constant">DOPENSSL_IA32_SSE2</span></span></div><div class="line"> -<span class="ruby"><span class="constant">DOPENSSL_BN_ASM_MONT</span> -<span class="constant">DOPENSSL_BN_ASM_MONT5</span> -<span class="constant">DOPENSSL_BN_ASM_GF2m</span> </span></div><div class="line">-<span class="ruby"><span class="constant">DSHA1_ASM</span> -<span class="constant">DSHA256_ASM</span> -<span class="constant">DSHA512_ASM</span> -<span class="constant">DMD5_ASM</span> -<span class="constant">DAES_ASM</span> -<span class="constant">DVPAES_ASM</span> </span></div><div class="line">-<span class="ruby"><span class="constant">DBSAES_ASM</span> -<span class="constant">DWHIRLPOOL_ASM</span> -<span class="constant">DGHASH_ASM</span></span></div><div class="line">OPENSSLDIR: "/usr/ssl"</div></pre></td></tr></table></figure>

<p>And the developer claimed: “According to <a href="http://heartbleed.com/" target="_blank" rel="external">http://heartbleed.com/</a>. OpenSSL 1.0.1g is NOT vulnerable. Also I have restarted all services on this server.”</p>
<p>So, OpenSSL has been updated and the all services have been restarted, but why does the problem still persist?</p>
<p>I took a look at the command history he ran:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">wget http://www.openssl.org/<span class="built_in">source</span>/openssl-<span class="number">1.0</span>.<span class="number">1</span>g.tar.gz</div><div class="line">ls</div><div class="line">tar xvzf openssl-<span class="number">1.0</span>.<span class="number">1</span>g.tar.gz</div><div class="line"><span class="built_in">cd</span> openssl-<span class="number">1.0</span>.<span class="number">1</span>g/</div><div class="line"><span class="built_in">sudo</span> ./config --prefix=/usr</div><div class="line"><span class="built_in">sudo</span> make</div><div class="line"><span class="built_in">sudo</span> make install</div><div class="line"><span class="keyword">exit</span></div><div class="line">openssl version <span class="operator">-a</span></div><div class="line"><span class="built_in">sudo</span> reboot</div></pre></td></tr></table></figure>

<p>The OpenSSL library has been built from the source, which is fine, but the problem is that the Nginx server was still using the old library distributed by Ubuntu:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ ldd `which nginx` | <span class="keyword">grep</span> ssl</div><div class="line">        libssl.<span class="keyword">so</span>.<span class="number">1.0</span>.<span class="number">0</span> =&gt; /lib/x86_64-linux-gnu/libssl.<span class="keyword">so</span>.<span class="number">1.0</span>.<span class="number">0</span> (<span class="number">0</span>x00007fafe82a3000)</div><div class="line">$ strings /lib/x86_64-linux-gnu/libssl.<span class="keyword">so</span>.<span class="number">1.0</span>.<span class="number">0</span> | <span class="keyword">grep</span> <span class="string">'^OpenSSL '</span></div><div class="line">OpenSSL <span class="number">1.0</span>.<span class="number">1</span><span class="keyword">c</span> <span class="number">10</span> May <span class="number">2012</span></div></pre></td></tr></table></figure>

<p>In effect, there were two versions of OpenSSL library installed in the system, one was built from the source, and another one was managed by <code>dpkg</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ dpkg -l openssl</div><div class="line"><span class="header">||/ Name                          Version             Architecture</span></div><div class="line">+++-=============================-===================-===================</div><div class="line">ii  openssl                       1.0.1c-4ubuntu8.2   amd64</div></pre></td></tr></table></figure>

<p>However, the bigger problem is the version of the operating system:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ lsb_release -a</div><div class="line">No LSB modules are available.</div><div class="line">Distributor ID: Ubuntu</div><div class="line"><span class="label">Description:</span>    Ubuntu <span class="number">13.04</span></div><div class="line"><span class="label">Release:</span>        <span class="number">13.04</span></div><div class="line"><span class="label">Codename:</span>       raring</div></pre></td></tr></table></figure>

<p>Ubuntu 13.04 is not supported anymore according to <a href="https://wiki.ubuntu.com/Releases" target="_blank" rel="external">https://wiki.ubuntu.com/Releases</a>. The developer probably issued <code>apt-get upgrade</code>, but nothing to be updated, because Ubuntu stopped supporting the release. Therefore, no security update. And Ubuntu 13.04 is not listed in <a href="http://www.ubuntu.com/usn/usn-2165-1/" target="_blank" rel="external">Ubuntu Security Notice USN-2165-1</a>. So, the developer opted for building the library from the source. After installation from the source, the binary <code>openssl</code> was overridden by the source build, and the command <code>openssl version</code> showed the latest and patched version <code>1.0.1g</code>.</p>
<p>To fix the problem, we need to reinstall the package first:</p>
<pre><code>$ sudo apt-get <span class="operator"><span class="keyword">install</span> <span class="comment">--reinstall openssl</span></span>
</code></pre><p>Now, this will revert control back to <code>apt-get</code> and overwrite the binary <code>/usr/bin/openssl</code>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ openssl version -a</div><div class="line">OpenSSL <span class="number">1.0</span>.<span class="number">1</span>c <span class="number">10</span> May <span class="number">2012</span></div><div class="line">built on: Wed Jan  <span class="number">8</span> <span class="number">20</span>:<span class="number">51</span>:<span class="number">55</span> UTC <span class="number">2014</span></div><div class="line">platform: debian-amd64</div><div class="line">options:  bn(<span class="number">64</span>,<span class="number">64</span>) rc4(<span class="number">16</span>x,int) des(idx,cisc,<span class="number">16</span>,int) blowfish(idx) </div><div class="line">compiler: cc -fPIC -DOPENSSL_PIC -DZLIB -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -m64 -DL_ENDIAN -DTERMIO -g -O2 -fstack-protector <span class="variable">--param=</span><span class="variable">ssp-buffer-size=</span><span class="number">4</span> -Wformat <span class="variable">-Werror=</span>format-security <span class="variable">-D_FORTIFY_SOURCE=</span><span class="number">2</span> -Wl,-Bsymbolic-functions -Wl,-z,relro -Wa,--noexecstack -Wall -DOPENSSL_NO_TLS1_2_CLIENT <span class="variable">-DOPENSSL_MAX_TLS1_2_CIPHER_LENGTH=</span><span class="number">50</span> <span class="variable">-DMD32_REG_T=</span>int -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DAES_ASM -DVPAES_ASM -DBSAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM</div><div class="line">OPENSSLDIR: <span class="string">"/usr/lib/ssl"</span></div></pre></td></tr></table></figure>

<p>And then we must perform the distribution upgrade to the latest long term support version, in order to continue receiving updates.</p>
<p>The lesson I have learned from this is that if you are going the wrong direction, no matter how hard you work, you are not going to make it. Make sure to take the initial investment, and really understand the true cause of the problem before attempting to resolve the issue. And don’t blindly follow the procedure. Understand it first, and adapt to your specific situation. As Abraham Lincoln once said:</p>
<blockquote>
<p>“If I have nine hours to chop down a tree, I’d spend the first six sharpening my ax.”</p>
</blockquote>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-10T21:37:20.000Z"><a href="/2014/05/10/anonymous-like/">May 10, 2014</a></time>
      
      
  
    <h1 class="title"><a href="/2014/05/10/anonymous-like/">Anonymous Like</a></h1>
  

    </header>
    <div class="entry">
      
        <p><img src="/img/2014-05-10/anonymous-login.png" alt="Log in Anonymously"></p>
<p>Facebook announced a new product called “<a href="https://developers.facebook.com/products/anonymous-login" target="_blank" rel="external">Anonymous Login</a>“ during <a href="https://fbf8.com/" target="_blank" rel="external">F8 Conference</a> on April 30, 2014. The concept is great, it allows you to try out an app without releasing your personal information. We believe that we can take it a step further with <a href="http://anonymouslike.net/" target="_blank" rel="external">Anonymous Like</a>.</p>
<p><img src="/img/2014-05-10/anonymous-like-button.png" alt="Anonymous Like Button"></p>
<p>So, during the <a href="http://techcrunch.com/events/disrupt-ny-hackathon-2014/" target="_blank" rel="external">TechCrunch Disrupt 2014 Hackathon</a> in New York, we hacked together an <a href="http://disruptnyhackathon.challengepost.com/submissions/23602-anonymous-like" target="_blank" rel="external">Anonymous Like Button</a> to allow users to <em>Like it Anonymously</em>, similar to <a href="https://developers.facebook.com/docs/plugins/like-button/" target="_blank" rel="external">Facebook Like Button</a>. However, the underlying principle is vastly different.</p>
<p>We want to create something that is simply to use and has privacy in its core. People no longer need to sign in to a platform or a service in order express their opinions. We believe that the willness of people who will click the <em>Anonymous Like Button</em> will be much higher than the <em>Facebook Like Button</em>. Therefore, it represents a better metric on user opinions.</p>
<p>Check back later, as we slowly make improvement. In the meantime, feel free to click or press the <em>Anonymous Like</em> button on <a href="http://anonymouslike.net" target="_blank" rel="external">http://anonymouslike.net</a>.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:realguess.net">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/cloud/">Cloud</a><small>11</small></li>
  
    <li><a href="/categories/coding/">Coding</a><small>5</small></li>
  
    <li><a href="/categories/communication/">Communication</a><small>1</small></li>
  
    <li><a href="/categories/devops/">DevOps</a><small>9</small></li>
  
    <li><a href="/categories/javascript/">JavaScript</a><small>14</small></li>
  
    <li><a href="/categories/linux/">Linux</a><small>3</small></li>
  
    <li><a href="/categories/node-js-and-io-js/">Node.js and io.js</a><small>0</small></li>
  
    <li><a href="/categories/pathfinder/">Pathfinder</a><small>1</small></li>
  
    <li><a href="/categories/productivity/">Productivity</a><small>1</small></li>
  
    <li><a href="/categories/programming/">Programming</a><small>0</small></li>
  
    <li><a href="/categories/security/">Security</a><small>1</small></li>
  
    <li><a href="/categories/starters/">Starters</a><small>0</small></li>
  
    <li><a href="/categories/statistics/">Statistics</a><small>5</small></li>
  
    <li><a href="/categories/test/">Test</a><small>2</small></li>
  
    <li><a href="/categories/tools/">Tools</a><small>19</small></li>
  
    <li><a href="/categories/travel/">Travel</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/2013/">2013</a><small>1</small></li>
  
    <li><a href="/tags/2014/">2014</a><small>3</small></li>
  
    <li><a href="/tags/2015/">2015</a><small>1</small></li>
  
    <li><a href="/tags/abraham-lincoln/">abraham-lincoln</a><small>1</small></li>
  
    <li><a href="/tags/absolute-path/">absolute-path</a><small>1</small></li>
  
    <li><a href="/tags/accessor-property/">accessor-property</a><small>1</small></li>
  
    <li><a href="/tags/aftereach/">aftereach</a><small>1</small></li>
  
    <li><a href="/tags/agenda/">agenda</a><small>1</small></li>
  
    <li><a href="/tags/alexa/">alexa</a><small>3</small></li>
  
    <li><a href="/tags/alias/">alias</a><small>1</small></li>
  
    <li><a href="/tags/amazon/">amazon</a><small>6</small></li>
  
    <li><a href="/tags/amazon-s3/">amazon-s3</a><small>2</small></li>
  
    <li><a href="/tags/amazon-s3api/">amazon-s3api</a><small>1</small></li>
  
    <li><a href="/tags/amazon-sqs/">amazon-sqs</a><small>1</small></li>
  
    <li><a href="/tags/amtrak/">amtrak</a><small>1</small></li>
  
    <li><a href="/tags/android/">android</a><small>1</small></li>
  
    <li><a href="/tags/android-4-3/">android-4.3</a><small>1</small></li>
  
    <li><a href="/tags/anonymous/">anonymous</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-function/">anonymous-function</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-like/">anonymous-like</a><small>1</small></li>
  
    <li><a href="/tags/anonymous-login/">anonymous-login</a><small>1</small></li>
  
    <li><a href="/tags/ansible/">ansible</a><small>1</small></li>
  
    <li><a href="/tags/app-engine/">app-engine</a><small>2</small></li>
  
    <li><a href="/tags/apple/">apple</a><small>1</small></li>
  
    <li><a href="/tags/apt-get/">apt-get</a><small>2</small></li>
  
    <li><a href="/tags/array/">array</a><small>3</small></li>
  
    <li><a href="/tags/async/">async</a><small>1</small></li>
  
    <li><a href="/tags/asynchronous/">asynchronous</a><small>2</small></li>
  
    <li><a href="/tags/automated-build/">automated-build</a><small>1</small></li>
  
    <li><a href="/tags/automatic-link/">automatic-link</a><small>1</small></li>
  
    <li><a href="/tags/automation/">automation</a><small>2</small></li>
  
    <li><a href="/tags/awk/">awk</a><small>1</small></li>
  
    <li><a href="/tags/aws/">aws</a><small>8</small></li>
  
    <li><a href="/tags/aws-cli/">aws-cli</a><small>4</small></li>
  
    <li><a href="/tags/aws-sdk/">aws-sdk</a><small>1</small></li>
  
    <li><a href="/tags/bash/">bash</a><small>3</small></li>
  
    <li><a href="/tags/beforeeach/">beforeeach</a><small>1</small></li>
  
    <li><a href="/tags/best-practice/">best-practice</a><small>2</small></li>
  
    <li><a href="/tags/big-apple/">big-apple</a><small>1</small></li>
  
    <li><a href="/tags/big-easy/">big-easy</a><small>1</small></li>
  
    <li><a href="/tags/big-number/">big-number</a><small>1</small></li>
  
    <li><a href="/tags/binding/">binding</a><small>1</small></li>
  
    <li><a href="/tags/bintray/">bintray</a><small>1</small></li>
  
    <li><a href="/tags/bitbucket/">bitbucket</a><small>2</small></li>
  
    <li><a href="/tags/blog/">blog</a><small>4</small></li>
  
    <li><a href="/tags/boss/">boss</a><small>1</small></li>
  
    <li><a href="/tags/brace-expansion/">brace-expansion</a><small>1</small></li>
  
    <li><a href="/tags/bret-victor/">bret-victor</a><small>1</small></li>
  
    <li><a href="/tags/browser/">browser</a><small>1</small></li>
  
    <li><a href="/tags/browser-sync/">browser-sync</a><small>1</small></li>
  
    <li><a href="/tags/buffer/">buffer</a><small>1</small></li>
  
    <li><a href="/tags/busybox/">busybox</a><small>1</small></li>
  
    <li><a href="/tags/byobu/">byobu</a><small>1</small></li>
  
    <li><a href="/tags/cat/">cat</a><small>1</small></li>
  
    <li><a href="/tags/chai/">chai</a><small>1</small></li>
  
    <li><a href="/tags/changelog/">changelog</a><small>1</small></li>
  
    <li><a href="/tags/chat/">chat</a><small>1</small></li>
  
    <li><a href="/tags/chrome/">chrome</a><small>1</small></li>
  
    <li><a href="/tags/chunghwa-telecom/">chunghwa-telecom</a><small>1</small></li>
  
    <li><a href="/tags/cli/">cli</a><small>10</small></li>
  
    <li><a href="/tags/cloud-storage/">cloud-storage</a><small>1</small></li>
  
    <li><a href="/tags/cloud9/">cloud9</a><small>1</small></li>
  
    <li><a href="/tags/cm/">cm</a><small>1</small></li>
  
    <li><a href="/tags/cname/">cname</a><small>1</small></li>
  
    <li><a href="/tags/cocoon/">cocoon</a><small>1</small></li>
  
    <li><a href="/tags/coding-style/">coding-style</a><small>4</small></li>
  
    <li><a href="/tags/coffeelint/">coffeelint</a><small>1</small></li>
  
    <li><a href="/tags/coffeescript/">coffeescript</a><small>7</small></li>
  
    <li><a href="/tags/color/">color</a><small>1</small></li>
  
    <li><a href="/tags/comcast/">comcast</a><small>1</small></li>
  
    <li><a href="/tags/command-history/">command-history</a><small>1</small></li>
  
    <li><a href="/tags/command-line/">command-line</a><small>10</small></li>
  
    <li><a href="/tags/command-line-interface/">command-line-interface</a><small>0</small></li>
  
    <li><a href="/tags/compare/">compare</a><small>1</small></li>
  
    <li><a href="/tags/compose/">compose</a><small>1</small></li>
  
    <li><a href="/tags/configuration/">configuration</a><small>1</small></li>
  
    <li><a href="/tags/configuration-management/">configuration-management</a><small>1</small></li>
  
    <li><a href="/tags/console/">console</a><small>1</small></li>
  
    <li><a href="/tags/container/">container</a><small>1</small></li>
  
    <li><a href="/tags/content-type/">content-type</a><small>1</small></li>
  
    <li><a href="/tags/context/">context</a><small>1</small></li>
  
    <li><a href="/tags/control-character/">control-character</a><small>1</small></li>
  
    <li><a href="/tags/coreutils/">coreutils</a><small>1</small></li>
  
    <li><a href="/tags/cors/">cors</a><small>1</small></li>
  
    <li><a href="/tags/create-indexes/">create-indexes</a><small>1</small></li>
  
    <li><a href="/tags/crescent/">crescent</a><small>1</small></li>
  
    <li><a href="/tags/crlf/">crlf</a><small>1</small></li>
  
    <li><a href="/tags/cron/">cron</a><small>2</small></li>
  
    <li><a href="/tags/crontab/">crontab</a><small>1</small></li>
  
    <li><a href="/tags/crypto/">crypto</a><small>2</small></li>
  
    <li><a href="/tags/cryptography/">cryptography</a><small>1</small></li>
  
    <li><a href="/tags/curl/">curl</a><small>1</small></li>
  
    <li><a href="/tags/custom-domain/">custom-domain</a><small>2</small></li>
  
    <li><a href="/tags/custom-generator/">custom-generator</a><small>1</small></li>
  
    <li><a href="/tags/cut/">cut</a><small>1</small></li>
  
    <li><a href="/tags/cwd/">cwd</a><small>1</small></li>
  
    <li><a href="/tags/data-volume/">data-volume</a><small>1</small></li>
  
    <li><a href="/tags/database/">database</a><small>1</small></li>
  
    <li><a href="/tags/datagram/">datagram</a><small>1</small></li>
  
    <li><a href="/tags/dataset/">dataset</a><small>1</small></li>
  
    <li><a href="/tags/datastore/">datastore</a><small>1</small></li>
  
    <li><a href="/tags/date/">date</a><small>1</small></li>
  
    <li><a href="/tags/db/">db</a><small>1</small></li>
  
    <li><a href="/tags/debian/">debian</a><small>1</small></li>
  
    <li><a href="/tags/december/">december</a><small>1</small></li>
  
    <li><a href="/tags/delimiter/">delimiter</a><small>1</small></li>
  
    <li><a href="/tags/dependency/">dependency</a><small>2</small></li>
  
    <li><a href="/tags/development/">development</a><small>1</small></li>
  
    <li><a href="/tags/development-environment/">development-environment</a><small>1</small></li>
  
    <li><a href="/tags/diff/">diff</a><small>2</small></li>
  
    <li><a href="/tags/digest/">digest</a><small>1</small></li>
  
    <li><a href="/tags/directives-end-marker/">directives-end-marker</a><small>1</small></li>
  
    <li><a href="/tags/directory/">directory</a><small>1</small></li>
  
    <li><a href="/tags/dirname/">dirname</a><small>1</small></li>
  
    <li><a href="/tags/dispatch/">dispatch</a><small>1</small></li>
  
    <li><a href="/tags/distributed/">distributed</a><small>1</small></li>
  
    <li><a href="/tags/distributed-team/">distributed-team</a><small>1</small></li>
  
    <li><a href="/tags/dns/">dns</a><small>2</small></li>
  
    <li><a href="/tags/docco/">docco</a><small>1</small></li>
  
    <li><a href="/tags/docker/">docker</a><small>8</small></li>
  
    <li><a href="/tags/dockerfile/">dockerfile</a><small>1</small></li>
  
    <li><a href="/tags/domain/">domain</a><small>1</small></li>
  
    <li><a href="/tags/duplication/">duplication</a><small>1</small></li>
  
    <li><a href="/tags/ec2/">ec2</a><small>3</small></li>
  
    <li><a href="/tags/echo/">echo</a><small>2</small></li>
  
    <li><a href="/tags/ecmascript-harmony/">ecmascript-harmony</a><small>1</small></li>
  
    <li><a href="/tags/encryption/">encryption</a><small>1</small></li>
  
    <li><a href="/tags/environment/">environment</a><small>3</small></li>
  
    <li><a href="/tags/environment-variable/">environment-variable</a><small>2</small></li>
  
    <li><a href="/tags/eol/">eol</a><small>1</small></li>
  
    <li><a href="/tags/ephemeral/">ephemeral</a><small>1</small></li>
  
    <li><a href="/tags/explicit-document/">explicit-document</a><small>1</small></li>
  
    <li><a href="/tags/express/">express</a><small>3</small></li>
  
    <li><a href="/tags/extended-pattern-matching/">extended-pattern-matching</a><small>1</small></li>
  
    <li><a href="/tags/extglob/">extglob</a><small>1</small></li>
  
    <li><a href="/tags/facebook/">facebook</a><small>1</small></li>
  
    <li><a href="/tags/field/">field</a><small>1</small></li>
  
    <li><a href="/tags/file-system/">file-system</a><small>1</small></li>
  
    <li><a href="/tags/filename/">filename</a><small>1</small></li>
  
    <li><a href="/tags/firewall/">firewall</a><small>1</small></li>
  
    <li><a href="/tags/folder/">folder</a><small>1</small></li>
  
    <li><a href="/tags/fs/">fs</a><small>1</small></li>
  
    <li><a href="/tags/function/">function</a><small>4</small></li>
  
    <li><a href="/tags/function-declaration/">function-declaration</a><small>2</small></li>
  
    <li><a href="/tags/function-expression/">function-expression</a><small>3</small></li>
  
    <li><a href="/tags/function-innovation/">function-innovation</a><small>1</small></li>
  
    <li><a href="/tags/gae/">gae</a><small>1</small></li>
  
    <li><a href="/tags/gce/">gce</a><small>2</small></li>
  
    <li><a href="/tags/gcloud/">gcloud</a><small>4</small></li>
  
    <li><a href="/tags/generator/">generator</a><small>1</small></li>
  
    <li><a href="/tags/get/">get</a><small>1</small></li>
  
    <li><a href="/tags/getter/">getter</a><small>2</small></li>
  
    <li><a href="/tags/ghost/">ghost</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>3</small></li>
  
    <li><a href="/tags/git-branch/">git-branch</a><small>1</small></li>
  
    <li><a href="/tags/github/">github</a><small>4</small></li>
  
    <li><a href="/tags/github-pages/">github-pages</a><small>1</small></li>
  
    <li><a href="/tags/glob/">glob</a><small>1</small></li>
  
    <li><a href="/tags/gnome/">gnome</a><small>1</small></li>
  
    <li><a href="/tags/gnu/">gnu</a><small>1</small></li>
  
    <li><a href="/tags/goal/">goal</a><small>1</small></li>
  
    <li><a href="/tags/google-analytics/">google-analytics</a><small>4</small></li>
  
    <li><a href="/tags/google-cloud-datastore/">google-cloud-datastore</a><small>3</small></li>
  
    <li><a href="/tags/google-cloud-platform/">google-cloud-platform</a><small>2</small></li>
  
    <li><a href="/tags/google-cloud-pubsub/">google-cloud-pubsub</a><small>1</small></li>
  
    <li><a href="/tags/google-compute-engine/">google-compute-engine</a><small>3</small></li>
  
    <li><a href="/tags/google-keep/">google-keep</a><small>1</small></li>
  
    <li><a href="/tags/google-trends/">google-trends</a><small>1</small></li>
  
    <li><a href="/tags/groupthink/">groupthink</a><small>1</small></li>
  
    <li><a href="/tags/grunt/">grunt</a><small>1</small></li>
  
    <li><a href="/tags/grunt-contrib-jshint/">grunt-contrib-jshint</a><small>1</small></li>
  
    <li><a href="/tags/grunt-contrib-watch/">grunt-contrib-watch</a><small>1</small></li>
  
    <li><a href="/tags/guard/">guard</a><small>1</small></li>
  
    <li><a href="/tags/gulp/">gulp</a><small>2</small></li>
  
    <li><a href="/tags/hackathon/">hackathon</a><small>1</small></li>
  
    <li><a href="/tags/head/">head</a><small>2</small></li>
  
    <li><a href="/tags/heartbleed/">heartbleed</a><small>1</small></li>
  
    <li><a href="/tags/hexo/">hexo</a><small>1</small></li>
  
    <li><a href="/tags/hipchat/">hipchat</a><small>1</small></li>
  
    <li><a href="/tags/hong-kong/">hong-kong</a><small>1</small></li>
  
    <li><a href="/tags/host/">host</a><small>1</small></li>
  
    <li><a href="/tags/hosted-zone/">hosted-zone</a><small>1</small></li>
  
    <li><a href="/tags/hotlinking/">hotlinking</a><small>1</small></li>
  
    <li><a href="/tags/http/">http</a><small>4</small></li>
  
    <li><a href="/tags/http-server/">http-server</a><small>1</small></li>
  
    <li><a href="/tags/id/">id</a><small>1</small></li>
  
    <li><a href="/tags/ide/">ide</a><small>1</small></li>
  
    <li><a href="/tags/identifier/">identifier</a><small>1</small></li>
  
    <li><a href="/tags/iife/">iife</a><small>2</small></li>
  
    <li><a href="/tags/imessage/">imessage</a><small>1</small></li>
  
    <li><a href="/tags/immediately-invoked-function-expression/">immediately-invoked-function-expression</a><small>2</small></li>
  
    <li><a href="/tags/index/">index</a><small>1</small></li>
  
    <li><a href="/tags/inheritance/">inheritance</a><small>1</small></li>
  
    <li><a href="/tags/install/">install</a><small>7</small></li>
  
    <li><a href="/tags/instance/">instance</a><small>1</small></li>
  
    <li><a href="/tags/interactive/">interactive</a><small>2</small></li>
  
    <li><a href="/tags/internet-speed/">internet-speed</a><small>1</small></li>
  
    <li><a href="/tags/interpreter/">interpreter</a><small>1</small></li>
  
    <li><a href="/tags/iojs/">iojs</a><small>3</small></li>
  
    <li><a href="/tags/ip-address/">ip-address</a><small>3</small></li>
  
    <li><a href="/tags/january/">january</a><small>1</small></li>
  
    <li><a href="/tags/jasmine/">jasmine</a><small>1</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>12</small></li>
  
    <li><a href="/tags/jelly-bean/">jelly-bean</a><small>1</small></li>
  
    <li><a href="/tags/join/">join</a><small>1</small></li>
  
    <li><a href="/tags/jq/">jq</a><small>4</small></li>
  
    <li><a href="/tags/jshint/">jshint</a><small>1</small></li>
  
    <li><a href="/tags/json/">json</a><small>4</small></li>
  
    <li><a href="/tags/koa/">koa</a><small>5</small></li>
  
    <li><a href="/tags/koa-compose/">koa-compose</a><small>1</small></li>
  
    <li><a href="/tags/koa-router/">koa-router</a><small>1</small></li>
  
    <li><a href="/tags/lean/">lean</a><small>1</small></li>
  
    <li><a href="/tags/lean-coffee/">lean-coffee</a><small>1</small></li>
  
    <li><a href="/tags/lean-startup/">lean-startup</a><small>1</small></li>
  
    <li><a href="/tags/left-to-right-mark/">left-to-right-mark</a><small>1</small></li>
  
    <li><a href="/tags/lf/">lf</a><small>1</small></li>
  
    <li><a href="/tags/libssl/">libssl</a><small>1</small></li>
  
    <li><a href="/tags/license/">license</a><small>1</small></li>
  
    <li><a href="/tags/like-button/">like-button</a><small>1</small></li>
  
    <li><a href="/tags/line-divider/">line-divider</a><small>1</small></li>
  
    <li><a href="/tags/line-ending/">line-ending</a><small>1</small></li>
  
    <li><a href="/tags/linux/">linux</a><small>3</small></li>
  
    <li><a href="/tags/listobjects/">listobjects</a><small>1</small></li>
  
    <li><a href="/tags/livereload/">livereload</a><small>2</small></li>
  
    <li><a href="/tags/load/">load</a><small>1</small></li>
  
    <li><a href="/tags/lock/">lock</a><small>1</small></li>
  
    <li><a href="/tags/lodash/">lodash</a><small>1</small></li>
  
    <li><a href="/tags/log/">log</a><small>1</small></li>
  
    <li><a href="/tags/lorem-ipsum/">lorem-ipsum</a><small>1</small></li>
  
    <li><a href="/tags/m101/">m101</a><small>1</small></li>
  
    <li><a href="/tags/managed-vms/">managed-vms</a><small>2</small></li>
  
    <li><a href="/tags/markdown/">markdown</a><small>2</small></li>
  
    <li><a href="/tags/md5/">md5</a><small>1</small></li>
  
    <li><a href="/tags/meeting/">meeting</a><small>1</small></li>
  
    <li><a href="/tags/messaging/">messaging</a><small>1</small></li>
  
    <li><a href="/tags/metric/">metric</a><small>4</small></li>
  
    <li><a href="/tags/mi3/">mi3</a><small>1</small></li>
  
    <li><a href="/tags/middleware/">middleware</a><small>1</small></li>
  
    <li><a href="/tags/minimatch/">minimatch</a><small>1</small></li>
  
    <li><a href="/tags/mocha/">mocha</a><small>3</small></li>
  
    <li><a href="/tags/module/">module</a><small>2</small></li>
  
    <li><a href="/tags/module-caching/">module-caching</a><small>1</small></li>
  
    <li><a href="/tags/mongodb/">mongodb</a><small>1</small></li>
  
    <li><a href="/tags/mongoexport/">mongoexport</a><small>1</small></li>
  
    <li><a href="/tags/msiexec/">msiexec</a><small>1</small></li>
  
    <li><a href="/tags/multi-parts/">multi-parts</a><small>1</small></li>
  
    <li><a href="/tags/multiple/">multiple</a><small>2</small></li>
  
    <li><a href="/tags/named-function/">named-function</a><small>1</small></li>
  
    <li><a href="/tags/nb/">nb</a><small>1</small></li>
  
    <li><a href="/tags/network/">network</a><small>1</small></li>
  
    <li><a href="/tags/new-orleans/">new-orleans</a><small>1</small></li>
  
    <li><a href="/tags/new-york/">new-york</a><small>1</small></li>
  
    <li><a href="/tags/nginx/">nginx</a><small>2</small></li>
  
    <li><a href="/tags/node/">node</a><small>24</small></li>
  
    <li><a href="/tags/node-version-manager/">node-version-manager</a><small>1</small></li>
  
    <li><a href="/tags/nodemon/">nodemon</a><small>1</small></li>
  
    <li><a href="/tags/normalization/">normalization</a><small>1</small></li>
  
    <li><a href="/tags/nota-bene/">nota-bene</a><small>1</small></li>
  
    <li><a href="/tags/note-well/">note-well</a><small>1</small></li>
  
    <li><a href="/tags/november/">november</a><small>1</small></li>
  
    <li><a href="/tags/npm/">npm</a><small>3</small></li>
  
    <li><a href="/tags/npm-module/">npm-module</a><small>1</small></li>
  
    <li><a href="/tags/null/">null</a><small>1</small></li>
  
    <li><a href="/tags/nvm/">nvm</a><small>1</small></li>
  
    <li><a href="/tags/object/">object</a><small>3</small></li>
  
    <li><a href="/tags/object-attributes/">object-attributes</a><small>1</small></li>
  
    <li><a href="/tags/one-liner/">one-liner</a><small>1</small></li>
  
    <li><a href="/tags/openssl/">openssl</a><small>2</small></li>
  
    <li><a href="/tags/order/">order</a><small>1</small></li>
  
    <li><a href="/tags/outdated/">outdated</a><small>1</small></li>
  
    <li><a href="/tags/package/">package</a><small>1</small></li>
  
    <li><a href="/tags/package-json/">package.json</a><small>1</small></li>
  
    <li><a href="/tags/pageview/">pageview</a><small>4</small></li>
  
    <li><a href="/tags/parseint/">parseint</a><small>1</small></li>
  
    <li><a href="/tags/part/">part</a><small>1</small></li>
  
    <li><a href="/tags/path/">path</a><small>4</small></li>
  
    <li><a href="/tags/pattern-matching/">pattern-matching</a><small>1</small></li>
  
    <li><a href="/tags/ping/">ping</a><small>1</small></li>
  
    <li><a href="/tags/pipe/">pipe</a><small>1</small></li>
  
    <li><a href="/tags/pm2/">pm2</a><small>1</small></li>
  
    <li><a href="/tags/port/">port</a><small>3</small></li>
  
    <li><a href="/tags/port-forwarding/">port-forwarding</a><small>1</small></li>
  
    <li><a href="/tags/prefix/">prefix</a><small>1</small></li>
  
    <li><a href="/tags/preinstall/">preinstall</a><small>1</small></li>
  
    <li><a href="/tags/principle/">principle</a><small>1</small></li>
  
    <li><a href="/tags/process/">process</a><small>1</small></li>
  
    <li><a href="/tags/profile/">profile</a><small>1</small></li>
  
    <li><a href="/tags/programming-style/">programming-style</a><small>0</small></li>
  
    <li><a href="/tags/protocol/">protocol</a><small>1</small></li>
  
    <li><a href="/tags/provision/">provision</a><small>1</small></li>
  
    <li><a href="/tags/proxy/">proxy</a><small>1</small></li>
  
    <li><a href="/tags/python/">python</a><small>1</small></li>
  
    <li><a href="/tags/query-parameter/">query-parameter</a><small>1</small></li>
  
    <li><a href="/tags/queue/">queue</a><small>1</small></li>
  
    <li><a href="/tags/random/">random</a><small>2</small></li>
  
    <li><a href="/tags/rawgit/">rawgit</a><small>1</small></li>
  
    <li><a href="/tags/read/">read</a><small>1</small></li>
  
    <li><a href="/tags/reboot/">reboot</a><small>2</small></li>
  
    <li><a href="/tags/record-set/">record-set</a><small>1</small></li>
  
    <li><a href="/tags/redis/">redis</a><small>1</small></li>
  
    <li><a href="/tags/relative-path/">relative-path</a><small>1</small></li>
  
    <li><a href="/tags/release/">release</a><small>1</small></li>
  
    <li><a href="/tags/remote-working/">remote-working</a><small>1</small></li>
  
    <li><a href="/tags/repl/">repl</a><small>1</small></li>
  
    <li><a href="/tags/require/">require</a><small>2</small></li>
  
    <li><a href="/tags/responsibility/">responsibility</a><small>1</small></li>
  
    <li><a href="/tags/restart/">restart</a><small>1</small></li>
  
    <li><a href="/tags/rlwrap/">rlwrap</a><small>1</small></li>
  
    <li><a href="/tags/route-53/">route-53</a><small>2</small></li>
  
    <li><a href="/tags/routing/">routing</a><small>1</small></li>
  
    <li><a href="/tags/ruby/">ruby</a><small>1</small></li>
  
    <li><a href="/tags/san-francisco/">san-francisco</a><small>1</small></li>
  
    <li><a href="/tags/save/">save</a><small>1</small></li>
  
    <li><a href="/tags/scaffolding/">scaffolding</a><small>1</small></li>
  
    <li><a href="/tags/script/">script</a><small>1</small></li>
  
    <li><a href="/tags/search/">search</a><small>1</small></li>
  
    <li><a href="/tags/search-term/">search-term</a><small>1</small></li>
  
    <li><a href="/tags/section/">section</a><small>1</small></li>
  
    <li><a href="/tags/security/">security</a><small>1</small></li>
  
    <li><a href="/tags/security-group/">security-group</a><small>2</small></li>
  
    <li><a href="/tags/sed/">sed</a><small>1</small></li>
  
    <li><a href="/tags/semantics/">semantics</a><small>1</small></li>
  
    <li><a href="/tags/semver/">semver</a><small>2</small></li>
  
    <li><a href="/tags/seq/">seq</a><small>1</small></li>
  
    <li><a href="/tags/serialization/">serialization</a><small>1</small></li>
  
    <li><a href="/tags/server/">server</a><small>2</small></li>
  
    <li><a href="/tags/setter/">setter</a><small>2</small></li>
  
    <li><a href="/tags/settings/">settings</a><small>1</small></li>
  
    <li><a href="/tags/setup/">setup</a><small>2</small></li>
  
    <li><a href="/tags/sha256/">sha256</a><small>1</small></li>
  
    <li><a href="/tags/shabang/">shabang</a><small>1</small></li>
  
    <li><a href="/tags/sharing/">sharing</a><small>1</small></li>
  
    <li><a href="/tags/shebang/">shebang</a><small>1</small></li>
  
    <li><a href="/tags/shell/">shell</a><small>3</small></li>
  
    <li><a href="/tags/shell-expansion/">shell-expansion</a><small>1</small></li>
  
    <li><a href="/tags/shell-script/">shell-script</a><small>1</small></li>
  
    <li><a href="/tags/shellshock/">shellshock</a><small>1</small></li>
  
    <li><a href="/tags/shopt/">shopt</a><small>1</small></li>
  
    <li><a href="/tags/socket-io/">socket-io</a><small>1</small></li>
  
    <li><a href="/tags/source-maps/">source-maps</a><small>1</small></li>
  
    <li><a href="/tags/speed-test/">speed-test</a><small>1</small></li>
  
    <li><a href="/tags/split/">split</a><small>2</small></li>
  
    <li><a href="/tags/ssh/">ssh</a><small>4</small></li>
  
    <li><a href="/tags/ssh-copy-id/">ssh-copy-id</a><small>1</small></li>
  
    <li><a href="/tags/sshuttle/">sshuttle</a><small>1</small></li>
  
    <li><a href="/tags/starter/">starter</a><small>5</small></li>
  
    <li><a href="/tags/startup/">startup</a><small>2</small></li>
  
    <li><a href="/tags/stats/">stats</a><small>5</small></li>
  
    <li><a href="/tags/stdin/">stdin</a><small>1</small></li>
  
    <li><a href="/tags/stream/">stream</a><small>1</small></li>
  
    <li><a href="/tags/string/">string</a><small>1</small></li>
  
    <li><a href="/tags/stringify/">stringify</a><small>1</small></li>
  
    <li><a href="/tags/structure/">structure</a><small>1</small></li>
  
    <li><a href="/tags/subscription/">subscription</a><small>1</small></li>
  
    <li><a href="/tags/success/">success</a><small>1</small></li>
  
    <li><a href="/tags/sudo/">sudo</a><small>1</small></li>
  
    <li><a href="/tags/supertest/">supertest</a><small>1</small></li>
  
    <li><a href="/tags/symbolic-link/">symbolic-link</a><small>1</small></li>
  
    <li><a href="/tags/symlink/">symlink</a><small>1</small></li>
  
    <li><a href="/tags/sync/">sync</a><small>1</small></li>
  
    <li><a href="/tags/synchronous/">synchronous</a><small>2</small></li>
  
    <li><a href="/tags/systemd/">systemd</a><small>1</small></li>
  
    <li><a href="/tags/taipei/">taipei</a><small>1</small></li>
  
    <li><a href="/tags/taiwan/">taiwan</a><small>1</small></li>
  
    <li><a href="/tags/task/">task</a><small>1</small></li>
  
    <li><a href="/tags/tcdisrupt/">tcdisrupt</a><small>1</small></li>
  
    <li><a href="/tags/teardown/">teardown</a><small>1</small></li>
  
    <li><a href="/tags/techcrunch/">techcrunch</a><small>1</small></li>
  
    <li><a href="/tags/template/">template</a><small>2</small></li>
  
    <li><a href="/tags/terminal/">terminal</a><small>1</small></li>
  
    <li><a href="/tags/test/">test</a><small>1</small></li>
  
    <li><a href="/tags/testing/">testing</a><small>1</small></li>
  
    <li><a href="/tags/texting/">texting</a><small>1</small></li>
  
    <li><a href="/tags/this/">this</a><small>1</small></li>
  
    <li><a href="/tags/time-zone/">time-zone</a><small>1</small></li>
  
    <li><a href="/tags/tmux/">tmux</a><small>1</small></li>
  
    <li><a href="/tags/todo/">todo</a><small>1</small></li>
  
    <li><a href="/tags/topic/">topic</a><small>2</small></li>
  
    <li><a href="/tags/train/">train</a><small>1</small></li>
  
    <li><a href="/tags/travel/">travel</a><small>1</small></li>
  
    <li><a href="/tags/trello/">trello</a><small>1</small></li>
  
    <li><a href="/tags/trigger/">trigger</a><small>1</small></li>
  
    <li><a href="/tags/trusty/">trusty</a><small>1</small></li>
  
    <li><a href="/tags/tumblr/">tumblr</a><small>1</small></li>
  
    <li><a href="/tags/twitter/">twitter</a><small>1</small></li>
  
    <li><a href="/tags/ubuntu/">ubuntu</a><small>5</small></li>
  
    <li><a href="/tags/uglifyjs/">uglifyjs</a><small>1</small></li>
  
    <li><a href="/tags/underscore/">underscore</a><small>1</small></li>
  
    <li><a href="/tags/unicode/">unicode</a><small>1</small></li>
  
    <li><a href="/tags/unique-visitor/">unique-visitor</a><small>4</small></li>
  
    <li><a href="/tags/united-states/">united-states</a><small>1</small></li>
  
    <li><a href="/tags/unix/">unix</a><small>1</small></li>
  
    <li><a href="/tags/unix-philosophy/">unix-philosophy</a><small>1</small></li>
  
    <li><a href="/tags/update/">update</a><small>2</small></li>
  
    <li><a href="/tags/upgrade/">upgrade</a><small>2</small></li>
  
    <li><a href="/tags/upload/">upload</a><small>1</small></li>
  
    <li><a href="/tags/upstart/">upstart</a><small>1</small></li>
  
    <li><a href="/tags/url/">url</a><small>1</small></li>
  
    <li><a href="/tags/username/">username</a><small>1</small></li>
  
    <li><a href="/tags/vagrant/">vagrant</a><small>8</small></li>
  
    <li><a href="/tags/vagrant-box/">vagrant-box</a><small>1</small></li>
  
    <li><a href="/tags/vagrant-google/">vagrant-google</a><small>1</small></li>
  
    <li><a href="/tags/vagrant-plugin/">vagrant-plugin</a><small>1</small></li>
  
    <li><a href="/tags/validation/">validation</a><small>1</small></li>
  
    <li><a href="/tags/version/">version</a><small>3</small></li>
  
    <li><a href="/tags/video/">video</a><small>1</small></li>
  
    <li><a href="/tags/vim/">vim</a><small>3</small></li>
  
    <li><a href="/tags/vimdiff/">vimdiff</a><small>1</small></li>
  
    <li><a href="/tags/vimeo/">vimeo</a><small>1</small></li>
  
    <li><a href="/tags/virtualbox/">virtualbox</a><small>1</small></li>
  
    <li><a href="/tags/visit/">visit</a><small>4</small></li>
  
    <li><a href="/tags/vivid/">vivid</a><small>1</small></li>
  
    <li><a href="/tags/vpn/">vpn</a><small>1</small></li>
  
    <li><a href="/tags/vulnerability/">vulnerability</a><small>1</small></li>
  
    <li><a href="/tags/web-framework/">web-framework</a><small>1</small></li>
  
    <li><a href="/tags/web-server/">web-server</a><small>1</small></li>
  
    <li><a href="/tags/webhook/">webhook</a><small>1</small></li>
  
    <li><a href="/tags/windows/">windows</a><small>2</small></li>
  
    <li><a href="/tags/workflow/">workflow</a><small>1</small></li>
  
    <li><a href="/tags/xiaomi/">xiaomi</a><small>1</small></li>
  
    <li><a href="/tags/yaml/">yaml</a><small>1</small></li>
  
    <li><a href="/tags/yeoman/">yeoman</a><small>1</small></li>
  
    <li><a href="/tags/yield/">yield</a><small>1</small></li>
  
    <li><a href="/tags/zone-apex/">zone-apex</a><small>1</small></li>
  
    <li><a href="/tags/中華電信/">中華電信</a><small>1</small></li>
  
    <li><a href="/tags/小米/">小米</a><small>1</small></li>
  
    <li><a href="/tags/小米手机/">小米手机</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Chao Huang
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'realguess';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>